(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1033:function(e,t,a){},1387:function(e,t,a){},1392:function(e,t,a){"use strict";a.r(t);a(653);var n=a(13),r=a(0),l=a.n(r),i=a(10),s=a.n(i),o=a(21),c=a(22),u=a(24),d=a(23),m=a(25),h=(a(285),a(1401)),p=a(1403),f=a(1400),g=(a(47),a(32)),b=a(8),y=a(1402),E=(a(91),a(44)),v=(a(668),a(820)),S=(a(92),a(15)),k=(a(339),a(632)),C=(a(243),a(114)),I=(a(128),a(11)),D=(a(244),a(53)),O=(a(67),a(3)),x=(a(75),a(31)),w=a(1399),j={topMenus:[{menuTitle:"\u6211\u7684",icon:"user",subMenus:[{title:"\u4fee\u6539\u5bc6\u7801",route:"/admin/permission/password"},{title:"\u9000\u51fa",route:"/admin/logout"}]}],sideMenus:[{menuTitle:"\u4e91\u8d44\u6e90",icon:"cloud-server",subMenus:[{title:"\u670d\u52a1\u5668",route:"/admin/cloud_resource/cloud_server"},{title:"\u6570\u636e\u5e93",route:"/admin/cloud_resource/cloud_rds"},{title:"KV-Store",route:"/admin/cloud_resource/cloud_kv"},{title:"\u8d1f\u8f7d\u5747\u8861",route:"/admin/cloud_resource/cloud_slb"},{title:"\u5176\u5b83\u8d44\u6e90",route:"/admin/cloud_resource/cloud_other"},{title:"\u4e91\u8d26\u53f7",route:"/admin/cloud_resource/cloud_account"}]},{menuTitle:"\u5de5\u4f5c\u534f\u52a9",icon:"team",subMenus:[{title:"\u63d0\u4ea4\u5de5\u5355",route:"/admin/task/deploy_project"},{title:"\u5de5\u5355\u5217\u8868",route:"/admin/task/jobs"}]},{menuTitle:"CI & CD",icon:"gitlab",subMenus:[]},{menuTitle:"Kubernetes",icon:"ant-cloud",subMenus:[{title:"\u96c6\u7fa4\u7ba1\u7406",route:"/admin/k8s_cluster/info"}]},{menuTitle:"\u6570\u636e\u7ba1\u7406",icon:"database",subMenus:[{title:"\u963f\u91cc\u4e91",route:"/admin/data/syncAliyun"}]},{menuTitle:"\u6743\u9650\u7ba1\u7406",icon:"eye",subMenus:[{title:"\u7528\u6237\u7ba1\u7406",route:"/admin/permission/users"},{title:"\u89d2\u8272\u7ba1\u7406",route:"/admin/permission/roles"},{title:"\u6743\u9650\u94fe\u63a5",route:"/admin/permission/permissions"}]},{menuTitle:"\u7cfb\u7edf\u7ba1\u7406",icon:"radius-setting",subMenus:[{title:"\u7528\u6237\u53cd\u9988",route:"/admin/system/user_feedback"}]}],noAuthMenus:["/admin/task/deploy_project","/admin/task/jobs"]},T=a(215),_=a.n(T);_.a.interceptors.request.use(function(e){return e}),_.a.interceptors.response.use(function(e){return e});var M="http://localhost:19999/",L="ws://localhost:19999/";_.a.defaults.headers.post["Content-Type"]="application/json";var A=_.a.create({baseURL:M,timeout:7e3,withCredentials:!1});function N(){return localStorage.getItem("ops_token")}A.interceptors.request.use(function(e){return e.headers.Authorization=N(),e.headers.ClusterId=localStorage.getItem("clusterId"),e},function(e){return Promise.reject(e)}),A.interceptors.response.use(function(e){return e.data},function(e){var t=e.response.status;switch(console.log(e),t){case 400:O.a.error("[400]\u5ba2\u6237\u7aef\u8bf7\u6c42\u53c2\u6570\u9519\u8bef");break;case 401:window.location.href="/login?code=401";break;case 403:window.location.href="/login?code=403";break;case 500:O.a.error("[500]\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u5904\u7406"),this.props.history.push("/exception500");break;default:O.a.error("\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u5904\u7406")}return Promise.reject(e)});var R=function(e,t,a){return new Promise(function(n,r){A({method:"get",url:e,params:t,timeout:a}).then(function(e){n(e)}).catch(function(e){O.a.error(e.toLocaleString()),console.log(e,"\u5f02\u5e38")})})},P=function(e,t,a){return new Promise(function(n,r){A({method:"post",url:e,data:t,timeout:a}).then(function(e){n(e)}).catch(function(e){O.a.error(e.toString()),console.log(e,"\u5f02\u5e38")})})},z=function(e,t,a){return new Promise(function(n,r){A({method:"put",url:e,data:t,timeout:a}).then(function(e){n(e)}).catch(function(e){O.a.error(e.toLocaleString()),console.log(e,"\u5f02\u5e38")})})},V=function(e,t,a){return new Promise(function(n,r){A({method:"delete",url:e,data:t,timeout:a}).then(function(e){n(e)}).catch(function(e){O.a.error(e.toLocaleString()),console.log(e,"\u5f02\u5e38")})})},B=function(e,t){return R("user/list",{page:e,size:t})},F=function(e){return P("user/updatePassword",e)},Y=g.a.Header,q=x.a.TextArea,K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).showFeedbackModal=a.showFeedbackModal.bind(Object(b.a)(a)),a.handleOk=a.handleOk.bind(Object(b.a)(a)),a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.state={feedbackModalVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showFeedbackModal",value:function(){this.setState({feedbackModalVisible:!0})}},{key:"handleOk",value:function(){var e=this;this.props.form.validateFields(function(t,a){var n;t||(n=a,P("user/feedback",n)).then(function(t){0===t.code?(e.setState({feedbackModalVisible:!1}),O.a.success("\u5df2\u7ecf\u6536\u5230\u60a8\u7684\u53cd\u9988\uff01")):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleCancel",value:function(){this.setState({feedbackModalVisible:!1})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:5},wrapperCol:{span:17}},a=l.a.createElement(D.a,null,j.topMenus.map(function(e){return e.subMenus.map(function(e){return l.a.createElement(D.a.Item,{key:e.title},l.a.createElement(w.a,{to:e.hasOwnProperty("route")?e.route:""},e.title))})}));return l.a.createElement(Y,{style:{background:"#fff",padding:0}},l.a.createElement("div",{style:{background:"#001529"}},l.a.createElement("span",{style:{color:"#fff",paddingLeft:"2%",fontSize:"1.4em"}},l.a.createElement(I.a,{className:"trigger",type:this.props.menuCollapsed?"menu-unfold":"menu-fold",onClick:this.props.handleSiderMenu,style:{cursor:"pointer"}})),l.a.createElement("span",{className:"introStep1",style:{color:"#fff",fontSize:"1.4em",float:"right",cursor:"pointer",width:"30px",textAlign:"center",marginLeft:"20px",marginRight:"30px"}},l.a.createElement(C.a,{overlay:a,overlayStyle:{width:"150px"}},l.a.createElement(I.a,{type:"user"}))),l.a.createElement("span",{className:"introStep2",style:{color:"#fff",fontSize:"1.4em",float:"right",cursor:"pointer",width:"30px",textAlign:"center"},onClick:this.showFeedbackModal},l.a.createElement(k.a,{content:"\u63d0\u4ea4\u9700\u6c42\u53cd\u9988"},l.a.createElement(I.a,{type:"message"}))),l.a.createElement(E.a,{title:"\u300cBug & \u9700\u6c42\u300d\u53cd\u9988",destroyOnClose:!0,visible:this.state.feedbackModalVisible,onOk:this.handleOk,onCancel:this.handleCancel,width:700},l.a.createElement(S.a,t,l.a.createElement(S.a.Item,{label:"\u53cd\u9988\u5185\u5bb9"},e("advice",{rules:[{required:!0,message:"\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"}]})(l.a.createElement(q,{rows:4})))),l.a.createElement(S.a,t,l.a.createElement(S.a.Item,{label:"\u5f53\u524d\u7248\u672c\u6ee1\u610f\u5ea6"},e("score",{rules:[{required:!0,message:"\u8bf7\u5bf9\u5f53\u524d\u7248\u672c\u8fdb\u884c\u6253\u5206"}]})(l.a.createElement(v.a,{tooltips:["\u96be\u7528","\u4e0d\u597d\u7528","\u4f53\u9a8c\u4e00\u822c","\u4f53\u9a8c\u826f\u597d","\u975e\u5e38\u68d2"]})))))))}}]),t}(r.Component);K=S.a.create({name:"OpsHeader"})(K);var H=Object(y.a)(K),J=g.a.Sider,U=D.a.SubMenu,G=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={authList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this;R("user/permissions").then(function(t){if(0===t.code){var a=t.data,n=[];a.map(function(e){return n.push(e.urlPath)}),e.setState({authList:n})}else O.a.error("\u83b7\u53d6\u7528\u6237\u83dc\u5355\u6743\u9650\u5f02\u5e38")}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"hasSubMenusAllowed",value:function(e){var t=this,a=!1;return e.map(function(e){return t.state.authList.indexOf(e.route)>-1||j.noAuthMenus.indexOf(e.route)>-1?a=!0:null}),a}},{key:"hasMenuAllowed",value:function(e){return this.state.authList.indexOf(e)>-1||j.noAuthMenus.indexOf(e)>-1}},{key:"render",value:function(){var e=this;return l.a.createElement(J,{collapsed:this.props.menuCollapsed,style:{textAlign:"center"}},l.a.createElement("span",{className:"logo",style:(this.props.menuCollapsed,{backgroundSize:"80%"})}),l.a.createElement("span",{className:"logo-text",style:this.props.menuCollapsed?{display:"none"}:{}},"\u8fd0\u7ef4\u5e73\u53f0"),l.a.createElement(D.a,{theme:"dark",mode:"inline",className:"introStep4",style:{textAlign:"left"}},j.sideMenus.map(function(t){return t.subMenus.length&&e.hasSubMenusAllowed(t.subMenus)?l.a.createElement(U,{key:t.menuTitle,title:l.a.createElement("span",null,l.a.createElement(I.a,{type:t.icon}),l.a.createElement("span",null,t.menuTitle))},t.subMenus.map(function(t){return e.hasMenuAllowed(t.route)?l.a.createElement(D.a.Item,{key:t.title},l.a.createElement(w.a,{to:t.route},t.title)):null})):null})))}}]),t}(r.Component),Q=g.a.Footer,W=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement(Q,{style:{textAlign:"center",padding:"15px 50px"}},"\xa92019 Created by KevinYang")}}]),t}(r.Component),X=(a(172),a(84)),Z=(a(58),a(14)),$=(a(463),a(371)),ee=(a(70),a(29)),te=(a(78),a(16)),ae=g.a.Content,ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).showIntroduceVersion=a.showIntroduceVersion.bind(Object(b.a)(a)),a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.slidePrev=a.slidePrev.bind(Object(b.a)(a)),a.slideNext=a.slideNext.bind(Object(b.a)(a)),a.state={modalVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showIntroduceVersion",value:function(){this.setState({modalVisible:!0})}},{key:"handleCancel",value:function(){this.setState({modalVisible:!1})}},{key:"slidePrev",value:function(){this.carousel.prev()}},{key:"slideNext",value:function(){this.carousel.next()}},{key:"getVersionIntroduceContent",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:1,style:{paddingTop:"25%"}}),l.a.createElement(te.a,{span:22},l.a.createElement($.a,{ref:function(t){return e.carousel=t},autoplay:!0,arrows:!1,style:{height:"600px"}},l.a.createElement("div",{className:"intro"},l.a.createElement(ee.a,{style:{paddingTop:"90px"}},l.a.createElement(te.a,{span:12,style:{height:"330px",paddingLeft:"20px"}},l.a.createElement("div",{className:"intro_img_common"})),l.a.createElement(te.a,{span:8,className:"intro_desc"},"1\u3001\u652f\u6301\u963f\u91cc\u4e91\u8d26\u53f7\u4e0b\u4e91\u8d44\u6e90\u7684\u96c6\u6210\uff1b",l.a.createElement("br",null),l.a.createElement("br",null),"2\u3001\u652f\u6301\u7b80\u7248\u5de5\u5355\u7684\u534f\u4f5c\uff1b",l.a.createElement("br",null),l.a.createElement("br",null),"3\u3001\u91c7\u7528 RBAC \u8fdb\u884c\u7528\u6237\u83dc\u5355\u6743\u9650\u548c\u8d44\u6e90\u53ef\u89c1\u6743\u9650\u7684\u63a7\u5236\uff1b",l.a.createElement("br",null),l.a.createElement("br",null),"4\u3001\u652f\u6301\u63a5\u5165 Kubernetes \u5bf9\u5176\u8fdb\u884c\u7ba1\u7406\uff1b"))))),l.a.createElement(te.a,{span:1,style:{paddingTop:"25%"}})))}},{key:"render",value:function(){var e=l.a.createElement(r.Fragment,null,l.a.createElement(Z.a,{type:"link",onClick:this.showIntroduceVersion},l.a.createElement(I.a,{type:"notification"})," \u70b9\u51fb\u67e5\u770b\u5f53\u524d\u7248\u672c\u300cVersion: 1.0.0\u300d\u66f4\u65b0\u5185\u5bb9"));return l.a.createElement(ae,{style:{padding:"5px 10px",margin:0,height:"10%"}},l.a.createElement(X.a,{type:"success",message:e,closable:!0}),l.a.createElement(E.a,{visible:this.state.modalVisible,destroyOnClose:!0,centered:!0,width:"70%",closable:!0,onCancel:this.handleCancel,footer:null},this.getVersionIntroduceContent()))}}]),t}(r.Component),re=g.a.Content,le=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement(re,{style:{height:"100%"}},l.a.createElement(ne,null),l.a.createElement("div",{className:"base_png"}))}}]),t}(r.Component),ie=(a(108),a(56)),se=(a(173),a(100)),oe=(a(109),a(12)),ce=(a(131),a(50)),ue=(a(191),a(33)),de=(a(154),a(89)),me=(a(120),a(52)),he=(a(257),a(115)),pe=(a(117),a(60)),fe=a(35),ge=(a(181),a(73)),be=(a(258),a(113)),ye=(a(138),a(46)),Ee=(a(122),a(61)),ve=(a(139),a(66)),Se=(a(875),a(461)),ke=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement(Se.a,{style:{margin:"5px 0px 10px 0px"}},this.props.pathData.map(function(e){return l.a.createElement(Se.a.Item,{key:e},e)}))}}]),t}(r.Component);ke.defaultProps={pathData:[]};var Ce=ke,Ie=a(64),De=a.n(Ie),Oe=(a(937),a(957),a(968),a(18)),xe=a.n(Oe),we=function(e){return R("cloud/servers",e)},je=function(e){return R("cloud/servers/"+e)},Te=function(e,t){return R("cloud/accounts",{page:e,size:t})},_e=function(e){return P("cloud/accounts",e)},Me=function(e){return z("cloud/accounts",e)},Le=function(e){return V("cloud/accounts",e)},Ae=function(e,t,a){return R("cloud/monitor/ecs",{instanceId:e,timeDimension:t,metricDimension:a})},Ne=function(e,t,a){return R("cloud/monitor/rds",{instanceId:e,timeDimension:t,metricDimension:a})},Re=function(e,t,a){return R("cloud/monitor/kv",{instanceId:e,timeDimension:t,metricDimension:a})},Pe=function(e,t,a){return R("cloud/monitor/slb",{instanceId:e,timeDimension:t,metricDimension:a})},ze=function(e){return R("cloud/rds",e)},Ve=function(e){return R("cloud/kv",e)},Be=function(e){return R("cloud/slb",e)},Fe=function(e){return R("cloud/rds/"+e)},Ye=function(e){return R("cloud/kv/"+e)},qe=function(e){return R("cloud/slb/"+e)},Ke=function(e){return R("cloud/other",e)};a(520);xe.a.locale("zh-cn");var He=[{label:"\u6765\u6e90",key:"resForm",type:"input",disabled:!0},{label:"\u5b9e\u4f8bId",key:"instanceId",type:"input"},{label:"\u5b9e\u4f8b\u540d\u79f0",key:"instanceName",type:"input"},{label:"\u5185\u7f51ip",key:"innerIpAddress",type:"input"},{label:"\u5916\u7f51ip",key:"publicIpAddress",type:"input"},{label:"\u79c1\u6709ip",key:"privateIpAddress",type:"input"},{label:"CPU",key:"cpu",type:"input"},{label:"\u5185\u5b58(G)",key:"memory",type:"input"},{label:"\u8fc7\u671f\u65f6\u95f4",key:"expiredTime",type:"date_input"}],Je=[{label:"\u6765\u6e90",key:"resForm",type:"input",disabled:!0},{label:"\u5b9e\u4f8b\u540d\u79f0",key:"dbInstanceDescription",type:"input"},{label:"\u5185\u5b58(G)",key:"dbMemory",type:"input"},{label:"\u78c1\u76d8(G)",key:"dbInstanceStorage",type:"input"},{label:"\u8fc7\u671f\u65f6\u95f4",key:"dbExpiredTime",type:"date_input"}],Ue=[{label:"\u6765\u6e90",key:"resForm",type:"input",disabled:!0},{label:"\u5b9e\u4f8b\u540d\u79f0",key:"kvInstanceName",type:"input"},{label:"\u5e26\u5bbd",key:"kvBandwidth",type:"input"},{label:"\u5bb9\u91cf(G)",key:"kvCapacity",type:"input"},{label:"\u8fc7\u671f\u65f6\u95f4",key:"kvExpiredTime",type:"date_input"}],Ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleOk=a.handleOk.bind(Object(b.a)(a)),a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.switchChange=a.switchChange.bind(Object(b.a)(a)),a.state={usersData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.generateBaseInfoForm()}},{key:"switchChange",value:function(e){this.setState({renewSwitch:e})}},{key:"handleOk",value:function(){var e=this;this.props.form.validateFields(function(t,a){t||("expiredTime"in a&&(a.expiredTime=xe()(a.expiredTime).format("YYYY-MM-DD 00:00:00")),"dbExpiredTime"in a&&(a.dbExpiredTime=xe()(a.dbExpiredTime).format("YYYY-MM-DD 00:00:00")),"kvExpiredTime"in a&&(a.kvExpiredTime=xe()(a.kvExpiredTime).format("YYYY-MM-DD 00:00:00")),e.props.handleOk(a))})}},{key:"handleCancel",value:function(){this.props.form.resetFields(),this.props.handleCancel()}},{key:"getInputItem",value:function(e,t){var a=l.a.createElement(x.a,null);switch(e.type){case"input":a=l.a.createElement(x.a,{disabled:e.disabled||t});break;case"date_input":a=l.a.createElement(ge.a,{format:"YYYY-MM-DD",disabled:e.disabled||t})}return a}},{key:"generateBaseInfoForm",value:function(){var e=this;if("single"!==this.props.updateMode)return"";var t=this.props.resType,a=[],n=this.props.form.getFieldDecorator,r={labelCol:{span:7},wrapperCol:{span:17}},i=[];switch(t){case"ecs":i=He;break;case"rds":i=Je;break;case"kv":i=Ue}var s=i.map(function(t,a){var i=a%2===0?0:1;return l.a.createElement(te.a,{span:11,offset:i,key:t.key},l.a.createElement(S.a.Item,Object.assign({},r,{label:t.label}),n(t.key,{rules:[{required:t.required,message:"\u8be5\u503c\u4e3a\u5fc5\u586b\u9879\uff01"}]})(e.getInputItem(t,!1))))});return a.push(s),l.a.createElement("div",null,l.a.createElement(me.a,{orientation:"left",style:{marginTop:"0px",color:"rgb(255, 80, 23)"}},"\u57fa\u672c\u4fe1\u606f"),l.a.createElement(ee.a,{gutter:12},a))}},{key:"render",value:function(){return l.a.createElement(E.a,{visible:this.props.visible,destroyOnClose:!0,title:"\u5b8c\u5584\u8d44\u6e90\u4fe1\u606f",onOk:this.handleOk,onCancel:this.handleCancel,centered:!0,width:700},l.a.createElement(S.a,{labelCol:{span:7},wrapperCol:{span:14}},this.generateBaseInfoForm()))}}]),t}(r.Component),Qe=Ge=S.a.create({name:"ExtraInfoModal"})(Ge),We=function(){return l.a.createElement("svg",{width:"15px",height:"15px",t:"1562667653974",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2507"},l.a.createElement("path",{d:"M486.4 134.4L960 64v422.4H486.4V134.4z",fill:"#90C300","p-id":"2508"}),l.a.createElement("path",{d:"M64 198.4l358.4-51.2v345.6H64V198.4z",fill:"#F8672C","p-id":"2509"}),l.a.createElement("path",{d:"M486.4 889.6L960 960V550.4H486.4v339.2z",fill:"#FFC400","p-id":"2510"}),l.a.createElement("path",{d:"M64 825.6l358.4 51.2V550.4H64v275.2z",fill:"#00B4F2","p-id":"2511"}))},Xe=function(){return l.a.createElement("svg",{t:"1562667694279",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3672",width:"15px",height:"15px"},l.a.createElement("path",{d:"M839.73005 769.44c9.3-20 13.6-48 13.6-86.78 0-138.52-63.82-218.44-115.08-282.66-31.04-38.9-55.58-69.62-55.58-101.34v-10c0.32-58.88 1.02-181.48-64-246.94C591.05005 14 555.19005 0 511.99005 0c-89.62 0-149.32 43.54-149.32 256 0 58.48-24.62 106.38-50.66 157.08-11.4 22.24-23.22 45.24-33.12 69.54C259.19005 531.08 213.33005 649.68 213.33005 704a21.4 21.4 0 0 0 2.44 10l151 288a21.4 21.4 0 0 0 16.38 11.1 21.4 21.4 0 0 0 18.64-7.06c9.48-10.56 72.32-24.56 110.2-24.56h144.74a21.4 21.4 0 0 0 14.88-6l175.26-170.68a21.34 21.34 0 0 0-7.14-35.18z",fill:"#1A1A1A","p-id":"3673"}),l.a.createElement("path",{d:"M688.19005 717.3c-0.52-103.88-14.64-220.72-96.72-388.52C550.85005 356.26 476.29005 378 467.33005 378c-16.16 0-51.42-11.54-77.34-34.4-10.64 31.42-25.38 60.52-40 89-11 21.4-22.36 43.54-31.54 66.12C292.65005 562 263.19005 645.46 257.33005 689.78c18 12 30.64 38 44.54 67.14 14.4 30.12 30.7 64.26 51.72 78.92 38.48 26.78 58.42 64.98 63.64 99.68 14.64 1.46 33.1 2.72 54 2.72 52 0 122.6-10.56 174.82-42.24 2.9-56.44 12.82-146.96 42.14-178.7z",fill:"#FFFFFF","p-id":"3674"}),l.a.createElement("path",{d:"M892.85005 813.84c-8.84-5.8-18-11.8-24.44-18.26-3.76-3.76-2-21.2-1.12-30.58 1.76-18 3.6-36.58-8.5-50-4.56-5.04-12.94-11.06-26.8-11.06-11.4 0-19.74 9.04-20.24 20.44 0 0.3 0.12 0.58 0.12 0.9H725.33005A21.32 21.32 0 0 0 703.99005 704c-63.26 0-64 232.32-64.24 237.4-1.2 12.72-4 42.58 15.12 63.54 11.52 12.64 28 19.06 49.12 19.06 55.38 0 82.24-28.54 108.2-56.12 4.36-4.68 8.84-9.42 13.56-14.12 10.8-10.82 32-18.54 50.62-25.34 30.62-11.2 62.3-22.76 62.3-53.76s-25.34-47.44-45.82-60.82zM353.51005 835.84c-21.02-14.66-37.32-48.8-51.72-78.92-19.04-39.84-35.5-74.26-67.12-74.26-40 0-48.66 35.88-53.32 55.16-1.3 5.3-3.24 13.3-3.44 14.24-3.16 2-15.08 4.32-22.96 5.88C128.91005 763.1 85.33005 771.72 85.33005 810.66a162.48 162.48 0 0 0 3.54 30.98C92.17005 859.4 95.33005 876.14 86.01005 912a20.8 20.8 0 0 0-0.68 5.34c0 51.28 79.66 58 127.28 61.88 8 0.68 14.5 1.18 18.72 1.84 6.56 1.04 20.32 7.38 33.6 13.5C293.33005 1007.68 328.77005 1024 362.67005 1024c24.36 0 43.86-15.76 52.16-42.12 12.9-41.1-4.18-106.28-61.32-146.04z",fill:"#FDB515","p-id":"3675"}),l.a.createElement("path",{d:"M831.99005 661.34a20.64 20.64 0 0 0-10.92 3.44l-142.46-233.1a1140 1140 0 0 0-62.32-142.78 21.32 21.32 0 1 0-38 19.54c96.32 187.16 104.3 304 104.34 415.7-0.26 4.48-1.78 44.44 21.2 68.76a57.3 57.3 0 0 0 42.76 17.76h14.78c21.7 0 45.16-1.66 63.5-19.86 19.72-19.36 28.46-52.8 28.46-108.14a21.32 21.32 0 0 0-21.34-21.32z",fill:"#1A1A1A","p-id":"3676"}),l.a.createElement("path",{d:"M554.67005 129.78c-24.74 0-42.68 26.54-42.68 63.12s18 63.1 42.68 63.1S597.33005 229.46 597.33005 192.9s-18-63.12-42.66-63.12z",fill:"#FFFFFF","p-id":"3677"}),l.a.createElement("path",{d:"M535.31005 208.56a37.9 19.36 90 1 0 38.72 0 37.9 19.36 90 1 0-38.72 0Z","p-id":"3678"}),l.a.createElement("path",{d:"M426.67005 129.78c-24.74 0-42.68 26.54-42.68 63.12s18 63.1 42.68 63.1S469.33005 229.46 469.33005 192.9s-18-63.12-42.66-63.12z",fill:"#FFFFFF","p-id":"3679"}),l.a.createElement("path",{d:"M407.71005 207.82a37.14 18.96 90 1 0 37.92 0 37.14 18.96 90 1 0-37.92 0Z","p-id":"3680"}),l.a.createElement("path",{d:"M494.85005 213.76a21.16 21.16 0 0 0-4.18-0.42c-45.88 0-128 43.02-128 85.32 0 40 80.68 85.34 106.66 85.34 12.6 0 149.34-47.48 149.34-85.34 0-55.8-94.78-79.1-123.82-84.9z",fill:"#FDB515","p-id":"3681"}))},Ze=function(){return l.a.createElement("svg",{t:"1570523496603",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1158",width:"20",height:"20"},l.a.createElement("path",{d:"M512 34.133333a486.4 486.4 0 1 0 486.4 486.4A486.4 486.4 0 0 0 512 34.133333z m288.580267 332.552534l-324.266667 347.426133a45.866667 45.866667 0 0 1-64.9216 2.6112 20.334933 20.334933 0 0 1-1.518933-1.518933l-185.258667-185.233067a46.344533 46.344533 0 0 1 65.3568-65.3568l152.541867 151.3472 290.423466-312.2432a46.293333 46.293333 0 1 1 71.68 58.632533 37.0944 37.0944 0 0 1-4.0192 4.343467z m0 0","p-id":"1159",fill:"#1296db"}))},$e=function(){return l.a.createElement("svg",{t:"1570523553927",className:"icon",viewBox:"0 0 1160 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1721",width:"20",height:"20"},l.a.createElement("path",{d:"M610.84444476 70.65600031a454.39999969 454.39999969 0 1 1-0.70400062 908.79999938c-140.60800031-3.19999969-261.76000031-62.91199969-361.59999938-177.66399938a31.99999969 31.99999969 0 0 1 48.25599938-41.98400062c88.32 101.50399969 192.64000031 152.89600031 314.04800062 155.64800062a390.40000031 390.40000031 0 1 0-388.992-423.80800031l73.344-73.27999969a31.99999969 31.99999969 0 0 1 48.89599969 40.83199969l-3.648 4.48000031L231.83644476 572.16000031a31.99999969 31.99999969 0 0 1-40.83200062 3.71199938l-4.47999938-3.71199938-108.60800062-108.60800062a31.99999969 31.99999969 0 0 1 40.83200062-48.96l4.47999938 3.71200031 38.33600062 38.4A454.52800031 454.52800031 0 0 1 610.84444476 70.65600031z m0 224.19199969a31.99999969 31.99999969 0 0 1 31.99999969 31.99999969v178.81600031l162.36799969 156.35200031a31.99999969 31.99999969 0 0 1-44.41599938 46.08l-172.16000062-165.76000031a31.99999969 31.99999969 0 0 1-9.792-23.04V326.78400031a31.99999969 31.99999969 0 0 1 32.00000062-32.00000062z",fill:"#d81e06","p-id":"1722"}))},et=function(){return l.a.createElement("svg",{t:"1569723850164",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"657",width:"30",height:"30"},l.a.createElement("path",{d:"M205.653333 737.066667c-29.184 0-55.637333-23.893333-55.637333-52.906667s23.893333-53.034667 55.68-53.034667c31.914667 0 55.893333 23.893333 55.893333 52.992s-26.538667 52.906667-55.68 52.906667z m683.178667-288.554667c-5.76-42.325333-32-76.8-66.56-103.253333l-13.44-10.666667-10.837333 13.226667c-21.077333 23.893333-29.44 66.261333-26.88 97.92 2.56 23.978667 10.24 47.786667 23.637333 66.304-10.837333 5.546667-24.234667 10.666667-34.56 16.085333a225.706667 225.706667 0 0 1-71.68 10.666667H4.138667l-2.56 15.786666a297.813333 297.813333 0 0 0 23.978666 151.04l10.410667 18.56v2.56c64 105.941333 177.92 153.6 301.994667 153.6 238.677333 0 434.432-103.253333 527.232-325.674666 60.8 2.645333 122.197333-13.226667 151.04-71.509334l7.68-13.226666-12.8-7.978667c-34.56-21.077333-81.92-23.893333-121.6-13.226667l-0.768 0.085334z m-341.674667-42.325333h-103.594666v103.253333h103.68V406.101333l-0.085334 0.128z m0-129.834667h-103.594666v103.253333h103.68V276.48l-0.085334-0.128z m0-132.437333h-103.594666v103.253333h103.68v-103.253333h-0.085334z m126.72 262.272H570.88v103.253333h103.253333V406.101333l-0.298666 0.128z m-383.914666 0H187.008v103.253333h103.338667V406.101333l-0.426667 0.128z m129.28 0h-102.4v103.253333H419.84V406.101333l-0.64 0.128z m-257.28 0H59.733333v103.253333h103.594667V406.101333l-1.28 0.128z m257.28-129.834667h-102.4v103.253333H419.84V276.48l-0.64-0.128z m-129.92 0H187.178667v103.253333H290.133333V276.48l-0.682666-0.128z",fill:"#1296db","p-id":"658"}))};xe.a.locale("zh-cn");var tt=ve.a.TabPane,at=Ee.a.Text,nt=Ee.a.Paragraph,rt=ye.a.Option,lt=g.a.Content,it=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={cloudAccountList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e,t=this.props.form.getFieldDecorator,a={labelCol:{span:7},wrapperCol:{span:14}};return e=this.state.cloudAccountList.map(function(e){return l.a.createElement(rt,{key:e.id,value:e.id},e.accountName)}),l.a.createElement(E.a,{title:"\u670d\u52a1\u5668\u4fe1\u606f",destroyOnClose:!0,visible:this.props.server_info_modal_visible,onOk:this.props.handlePostServerInfoSubmit,onCancel:this.props.handlePostServerInfoCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",centered:!0,width:600},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7"},a),t("cloudAccountId",{rules:[{required:!0,message:"\u4e91\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ye.a,null,e))),l.a.createElement(S.a.Item,Object.assign({label:"\u4e3b\u673a\u540d"},a),t("hostName",{rules:[{}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8bId"},a),t("instanceId",{rules:[{}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8b\u540d\u79f0"},a),t("instanceName",{rules:[{required:!0,message:"\u5b9e\u4f8b\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8b\u63cf\u8ff0"},a),t("description",{rules:[{}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5185\u7f51IP"},a),t("innerIpAddress",{rules:[{}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5916\u7f51IP"},a),t("publicIpAddress",{rules:[{}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u7cfb\u7edf\u7c7b\u578b"},a),t("osType",{initialValue:"linux",rules:[{required:!0,message:"\u7cfb\u7edf\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ye.a,null,l.a.createElement(rt,{value:"linux"},"Linux"),l.a.createElement(rt,{value:"windows"},"Windows")))),l.a.createElement(S.a.Item,Object.assign({label:"CPU\u6838\u6570(\u4e2a)"},a),t("cpu",{rules:[{type:"integer",required:!0,message:"\u8bf7\u8f93\u5165\u6570\u503c\u578b\u6570\u636e\uff01"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5185\u5b58(G)"},a),t("memory",{rules:[{type:"integer",required:!0,message:"\u8bf7\u8f93\u5165\u6570\u503c\u578b\u6570\u636e\uff01"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u78c1\u76d8(G)"},a),t("disk",{rules:[{type:"integer"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u521b\u5efa\u65f6\u95f4"},a),t("createTime",{rules:[{required:!0,message:"\u521b\u5efa\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ge.a,{format:"YYYY-MM-DD"}))),l.a.createElement(S.a.Item,Object.assign({label:"\u8fc7\u671f\u65f6\u95f4"},a),t("expiredTime",{})(l.a.createElement(ge.a,{format:"YYYY-MM-DD"})))))}}]),t}(r.Component);it=S.a.create({name:"ServerInfoModal"})(it);var st=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).refreshTableData=function(){a.setState({tableLoading:!0});var e={page:a.state.pagination.page,size:a.state.pagination.pageSize,queryExpiredTime:null===a.state.queryExpiredTime?null:a.state.queryExpiredTime.format("YYYY-MM-DD HH:mm:ss"),queryKeyword:a.state.queryKeyword,queryCloudAccount:a.state.queryCloudAccount};we(e).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:Object(fe.a)({},t)});for(var n=e.data.servers,r=[],l=0;l<n.length;l++)r.push({key:n[l].ID,ID:n[l].ID,Memory:n[l].Memory/1024,Cpu:n[l].Cpu,HostName:n[l].HostName,InstanceId:n[l].InstanceId,InnerIpAddress:n[l].InnerIpAddress,PublicIpAddress:n[l].PublicIpAddress,PrivateIpAddress:n[l].PrivateIpAddress,InternetMaxBandwidthIn:n[l].InternetMaxBandwidthIn,InternetMaxBandwidthOut:n[l].InternetMaxBandwidthOut,InternetChargeType:n[l].InternetChargeType,InstanceName:n[l].InstanceName,OSType:n[l].OSType,ZoneId:n[l].ZoneId,OSName:n[l].OSName,ExpiredTime:xe()(n[l].ExpiredTime).format("YYYY-MM-DD"),Status:n[l].Status,CloudAccountName:n[l].CloudAccountName,DataStatus:n[l].DataStatus});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){O.a.error(e)})},a.showChart=function(){var e=De.a.init(document.getElementById("ecsMonitorChart")),t={tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#623485"}}},xAxis:[{type:"category",boundaryGap:!1,data:a.state.chartXData}],yAxis:[{type:"value",axisLabel:{margin:7,formatter:"{value} "+a.state.chartFormat,textStyle:{color:"#999",fontSize:"12px"}}}],series:[{type:"line",itemStyle:{normal:{color:"rgba(43, 182, 243, 0.65)",lineStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10},areaStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10}}},data:a.state.chartYData}]};e.setOption(t)},a.openMonitorDrawer=function(e){a.setState({drawerVisible:!0,instanceId:e.InstanceId,currentServerDetail:e},function(){a.refreshMonitorData(e.InstanceId,a.state.timeTagValue,a.state.metricTagValue),a.refreshSeverDetail()})},a.refreshMonitorData=function(e,t,n){a.setState({chartLoading:!0}),Ae(e,t,n).then(function(e){if(0!==e.code)return O.a.error(e.msg),void a.setState({chartLoading:!1});if(""===e.data.Datapoints)return O.a.warn("\u672a\u83b7\u53d6\u5230\u76d1\u63a7\u6570\u636e\uff0c\u53ef\u80fd\u662f\u975e\u963f\u91cc\u4e91\u673a\u5668\u6216\u5176\u5b83\u539f\u56e0\uff01"),void a.setState({chartLoading:!1});for(var t=JSON.parse(e.data.Datapoints),n=[],r=[],l=0;l<t.length;l++)n.push(xe()(t[l].timestamp).format("DD\u65e5HH:mm")),r.push(t[l].Average);a.setState({chartXData:n,chartYData:r},function(){a.setState({chartLoading:!1}),a.showChart()})}).catch(function(e){O.a.error(e.toLocaleString())})},a.refreshSeverDetail=function(e){a.setState({serverDetailLoading:!0}),je(a.state.currentServerDetail.ID).then(function(e){0!==e.code&&O.a.error(e.msg),a.setState({currentServerDetail:e.data},function(){a.setState({serverDetailLoading:!1})})}).catch(function(e){O.a.error(e.toLocaleString())})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.onCloseDrawer=function(){a.setState({drawerVisible:!1})},a.handleTimeTagChange=function(e){a.setState({timeTagValue:e.target.value}),a.refreshMonitorData(a.state.instanceId,e.target.value,a.state.metricTagValue)},a.handleMetricTagChange=function(e){switch(a.setState({metricTagValue:e.target.value}),e.target.value){case"CPUUtilization":case"memory_usedutilization":case"diskusage_utilization":case"cpu_total":a.setState({chartFormat:"%"});break;default:a.setState({chartFormat:""})}a.refreshMonitorData(a.state.instanceId,a.state.timeTagValue,e.target.value)},a.onExpiredDateChange=function(e){null==e?a.setState({queryExpiredTime:null}):a.setState({queryExpiredTime:e})},a.keywordOnChange=function(e){a.setState({queryKeyword:e.target.value})},a.handleCloudAccountChange=function(e){a.setState({queryCloudAccount:e})},a.handleUserDefineGroupChange=function(e){a.setState({queryDefineGroup:e})},a.handleManageUserChange=function(e){a.setState({queryManageUser:e})},a.handleAdd=function(){a.setState({server_info_modal_visible:!0,ecsId:0})},a.handleQuery=function(){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:1,current:1})},function(){a.refreshTableData()})},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.handlePostServerInfoSubmit=a.handlePostServerInfoSubmit.bind(Object(b.a)(a)),a.handlePostServerInfoCancel=a.handlePostServerInfoCancel.bind(Object(b.a)(a)),a.handleExtraInfoOk=a.handleExtraInfoOk.bind(Object(b.a)(a)),a.handleExtraInfoCancel=a.handleExtraInfoCancel.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a));var n=a.props.isSuperAdmin?220:100;return a.state={columns:[{title:"Id",dataIndex:"ID",key:"ID",className:"small_font",render:function(e){return l.a.createElement(at,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8bid",width:230,dataIndex:"InstanceId",key:"InstanceId",className:"small_font"},{title:"\u5b9e\u4f8b\u540d\u79f0",dataIndex:"InstanceName",key:"InstanceName",className:"small_font",width:200,textWrap:"word-break",render:function(e){return l.a.createElement(pe.a,{title:e},l.a.createElement(at,{ellipsis:!0,style:{width:"200px"}},e))}},{title:"ip",dataIndex:"ip",key:"ip",className:"small_font",render:function(e,t){var a="",n="",r="";return t.InnerIpAddress&&(a=l.a.createElement("div",null,l.a.createElement(nt,{style:{marginBottom:0,display:"inline"},copyable:""!==t.InnerIpAddress},t.InnerIpAddress),"(\u5185\u7f51)")),t.PrivateIpAddress&&(n=l.a.createElement("div",null,l.a.createElement(nt,{style:{marginBottom:0,display:"inline"},copyable:""!==t.PrivateIpAddress},t.PrivateIpAddress),"(\u79c1\u6709)")),t.PublicIpAddress&&(r=l.a.createElement("div",null,l.a.createElement(nt,{style:{marginBottom:0,display:"inline"},copyable:""!==t.PublicIpAddress},t.PublicIpAddress),"(\u5916\u7f51)")),l.a.createElement("div",{className:"ip_column"},a,n,r)}},{title:"\u914d\u7f6e",dataIndex:"\u914d\u7f6e",key:"\u914d\u7f6e",className:"small_font",render:function(e,t){var a=l.a.createElement(nt,{style:{marginBottom:0,display:"inline"}},t.Cpu,"\u6838"),n=l.a.createElement(nt,{style:{marginBottom:0,display:"inline"}},t.Memory,"G"),r="";"PayByTraffic"===t.InternetChargeType&&(r="\u6d41\u91cf"),"PayByBandwidth"===t.InternetChargeType&&(r="\u5e26\u5bbd");var i=l.a.createElement("div",null,l.a.createElement(nt,{style:{marginBottom:0,display:"inline"}},t.InternetMaxBandwidthOut,"Mbps(",r,")"));return l.a.createElement("div",{className:"ip_column"},a," \xa0",n,i)}},{title:"\u7cfb\u7edf\u7c7b\u578b",dataIndex:"OSType",key:"OSType",align:"center",className:"small_font",render:function(e,t){var a="error";return"Running"===t.Status&&(a="processing"),"windows"===e?l.a.createElement("div",null,l.a.createElement(We,null),l.a.createElement(he.a,{status:a,style:{marginLeft:"5px",position:"relative",top:"-10px"}})):"linux"===e?l.a.createElement("div",null,l.a.createElement(Xe,null),l.a.createElement(he.a,{status:a,style:{marginLeft:"5px",position:"relative",top:"-10px"}})):l.a.createElement(at,{ellipsis:!0},e)}},{title:"\u533a\u57df",dataIndex:"ZoneId",key:"ZoneId",className:"small_font",render:function(e){return l.a.createElement(at,{ellipsis:!0},e)}},{title:"\u8fc7\u671f\u65f6\u95f4",dataIndex:"ExpiredTime",key:"ExpiredTime",className:"small_font",render:function(e){return l.a.createElement(at,{ellipsis:!0},e)}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:{operWidth:n},align:"center",className:"small_font action_column",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.openMonitorDrawer.bind(Object(b.a)(a),t)},"\u76d1\u63a7"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"info",size:"small",onClick:a.serverEdit.bind(Object(b.a)(a),t)},"\u7f16\u8f91"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9?",onConfirm:a.serverDelete.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664")))}}],tableLoading:!1,webSocketReady:!1,tableData:[],chartXData:[],chartYData:[],pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},drawerVisible:!1,drawerPlacement:"left",instanceId:"",timeTagValue:"1h",metricTagValue:"CPUUtilization",chartFormat:"%",currentServerDetail:{},msgContent:"",server_info_modal_visible:!1,queryExpiredTime:null,queryKeyword:"",queryCloudAccount:"0",queryManageUser:"0",queryDefineGroup:"",cloudAccountList:[],selectedRowKeys:[],idsList:[],updateMode:"single"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData(),this.loadCloudAccountsData()}},{key:"loadCloudAccountsData",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"serverEdit",value:function(e){var t=this;this.setState({extraInfoModalVisible:!0,ecsId:e.ID,updateMode:"single",resFrom:1===e.DataStatus?"\u963f\u91cc\u4e91":"\u624b\u52a8\u6dfb\u52a0"},function(){je(e.ID).then(function(e){0!==e.code?O.a.error(e.msg):t.extraInfoFormRef.props.form.setFieldsValue({instanceId:e.data.InstanceId,innerIpAddress:e.data.InnerIpAddress,publicIpAddress:e.data.PublicIpAddress,privateIpAddress:e.data.PrivateIpAddress,instanceName:e.data.InstanceName,cpu:e.data.Cpu,memory:(e.data.Memory/1024).toString(),expiredTime:""!==e.data.ExpiredTime?xe()(e.data.ExpiredTime):"",resForm:1===e.data.DataStatus?"\u963f\u91cc\u4e91":"\u624b\u52a8\u6dfb\u52a0"})}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleExtraInfoOk",value:function(e){var t=this,a="";a="single"===this.state.updateMode?String(this.state.ecsId):this.state.idsList.join(","),function(e){return z("cloud/servers",e)}(Object(fe.a)({},e,{id:a})).then(function(e){0===e.code?(O.a.success("\u4fee\u6539\u6210\u529f"),t.setState({extraInfoModalVisible:!1,selectedRowKeys:[]}),t.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleExtraInfoCancel",value:function(e){this.setState({extraInfoModalVisible:!1})}},{key:"serverDelete",value:function(e){var t,a=this;(t=e.ID,V("cloud/servers",{id:t})).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handlePostServerInfoSubmit",value:function(){var e=this;this.serverInfoFormRef.props.form.validateFields(function(t,a){var n;t||(n=Object(fe.a)({},a,{createTime:a.createTime.format("YYYY-MM-DD HH:mm:ss"),expiredTime:void 0===a.expiredTime?void 0:a.expiredTime.format("YYYY-MM-DD HH:mm:ss")}),P("cloud/servers",n)).then(function(t){0===t.code?(O.a.success("\u6dfb\u52a0\u6210\u529f\uff0c\u8bf7\u5230\u6743\u9650\u7ba1\u7406\u4e2d\u589e\u52a0\u8bbf\u95ee\u6743\u9650\uff01"),e.setState({server_info_modal_visible:!1}),e.refreshTableData()):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handlePostServerInfoCancel",value:function(){this.setState({server_info_modal_visible:!1})}},{key:"render",value:function(){var e,t=this;e=this.state.cloudAccountList.map(function(e){return l.a.createElement(rt,{key:e.id,value:e.id},e.accountName)});var a={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return l.a.createElement(lt,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u4e91\u8d44\u6e90","\u4e91\u670d\u52a1\u5668","\u670d\u52a1\u5668\u5217\u8868"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ge.a,{style:{width:"100%"},defaultValue:this.state.queryExpiredTime,placeholder:"\u5230\u671f\u622a\u6b62\u65f6\u95f4",onChange:this.onExpiredDateChange})),l.a.createElement(te.a,{span:5,className:"col-span"},l.a.createElement(x.a,{placeholder:"\u8f93\u5165\u5b9e\u4f8bid\\ip\\\u5b9e\u4f8b\u540d\u79f0\u67e5\u8be2",value:this.state.queryKeyword,onChange:this.keywordOnChange})),l.a.createElement(te.a,{span:4,className:"col-span"},l.a.createElement(ye.a,{defaultValue:this.state.queryCloudAccount,style:{width:"100%"},onChange:this.handleCloudAccountChange},l.a.createElement(rt,{value:"0"},"\u6240\u6709\u4e91\u8d26\u53f7"),e)),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},type:"primary",icon:"search",onClick:this.handleQuery},"\u67e5 \u8be2")),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},icon:"plus-circle",onClick:this.handleAdd},"\u65b0 \u589e"))),l.a.createElement(it,{wrappedComponentRef:function(e){return t.serverInfoFormRef=e},server_info_modal_visible:this.state.server_info_modal_visible,handlePostServerInfoSubmit:this.handlePostServerInfoSubmit,handlePostServerInfoCancel:this.handlePostServerInfoCancel}),l.a.createElement(Qe,{wrappedComponentRef:function(e){return t.extraInfoFormRef=e},resType:"ecs",updateMode:this.state.updateMode,resFrom:this.state.resFrom,visible:this.state.extraInfoModalVisible,handleOk:this.handleExtraInfoOk,handleCancel:this.handleExtraInfoCancel}),l.a.createElement(se.a,{title:"\u670d\u52a1\u5668\u8be6\u60c5\u53ca\u76d1\u63a7\u6570\u636e",placement:this.state.drawerPlacement,closable:!0,destroyOnClose:!0,onClose:this.onCloseDrawer,visible:this.state.drawerVisible,width:950},l.a.createElement(ve.a,{defaultActiveKey:"1",tabPosition:"left",style:{marginLeft:-30}},l.a.createElement(tt,{tab:"\u76d1\u63a7\u8be6\u60c5",key:"1"},l.a.createElement(ce.a,{tip:"\u56fe\u8868\u751f\u6210\u4e2d...",spinning:this.state.chartLoading},l.a.createElement(ee.a,{style:{marginBottom:"10px"}},l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u65f6\u95f4\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:15},l.a.createElement(ue.a.Group,{value:this.state.timeTagValue,onChange:this.handleTimeTagChange},l.a.createElement(ue.a.Button,{value:"1h"},"1\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"6h"},"6\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"12h"},"12\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"1d"},"1 \u5929"),l.a.createElement(ue.a.Button,{value:"3d"},"3 \u5929"),l.a.createElement(ue.a.Button,{value:"7d"},"7 \u5929"),l.a.createElement(ue.a.Button,{value:"14d"},"14 \u5929")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u76d1\u63a7\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:16},l.a.createElement(ue.a.Group,{value:this.state.metricTagValue,onChange:this.handleMetricTagChange},l.a.createElement(ue.a.Button,{value:"CPUUtilization"},"cpu\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"memory_usedutilization"},"\u5185\u5b58\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"diskusage_utilization"},"\u78c1\u76d8\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"cpu_total"},"\u5e73\u5747\u8d1f\u8f7d")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,null,l.a.createElement("div",{id:"ecsMonitorChart",style:{height:500}}))))),l.a.createElement(tt,{tab:"\u4fe1\u606f\u8be6\u60c5",key:"2"},l.a.createElement(ce.a,{tip:"\u6570\u636e\u83b7\u53d6\u4e2d...",spinning:this.state.serverDetailLoading},l.a.createElement(oe.a,{title:"\u57fa\u672c\u4fe1\u606f",bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u4e3b\u673a\u540d"},this.state.currentServerDetail.HostName),l.a.createElement(oe.a.Item,{label:"\u673a\u5668\u63cf\u8ff0"},this.state.currentServerDetail.Description),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8bID"},this.state.currentServerDetail.InstanceId),l.a.createElement(oe.a.Item,{label:"\u5185\u7f51IP"},this.state.currentServerDetail.InnerIpAddress),l.a.createElement(oe.a.Item,{label:"\u5916\u7f51IP"},this.state.currentServerDetail.PublicIpAddress),l.a.createElement(oe.a.Item,{label:"\u79c1\u6709IP"},this.state.currentServerDetail.PrivateIpAddress),l.a.createElement(oe.a.Item,{label:"Cpu"},this.state.currentServerDetail.Cpu,"\u6838"),l.a.createElement(oe.a.Item,{label:"\u5185\u5b58"},this.state.currentServerDetail.Memory/1024,"G"),l.a.createElement(oe.a.Item,{label:"\u516c\u7f51\u5165\u5e26\u5bbd"},this.state.currentServerDetail.InternetMaxBandwidthIn,"Mbps"),l.a.createElement(oe.a.Item,{label:"\u516c\u7f51\u51fa\u5e26\u5bbd"},this.state.currentServerDetail.InternetMaxBandwidthOut,"Mbps"),l.a.createElement(oe.a.Item,{label:"\u7f51\u7edc\u8ba1\u8d39"},this.state.currentServerDetail.InternetChargeType),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.currentServerDetail.CreationTime),l.a.createElement(oe.a.Item,{label:"\u8fc7\u671f\u65f6\u95f4"},this.state.currentServerDetail.ExpiredTime),l.a.createElement(oe.a.Item,{label:"\u955c\u50cfID"},this.state.currentServerDetail.ImageId),l.a.createElement(oe.a.Item,{label:"\u4ed8\u8d39\u7c7b\u578b"},this.state.currentServerDetail.InstanceChargeType),l.a.createElement(oe.a.Item,{label:"\u7f51\u7edc\u7c7b\u578b"},this.state.currentServerDetail.InstanceNetworkType),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u7c7b\u578b"},this.state.currentServerDetail.InstanceType),l.a.createElement(oe.a.Item,{label:"\u7cfb\u7edf\u540d\u79f0"},this.state.currentServerDetail.OSName)))))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small",rowSelection:a}))}}]),t}(r.Component),ot=Ee.a.Text,ct=Ee.a.Paragraph,ut=ye.a.Option,dt=g.a.Content,mt=ve.a.TabPane,ht=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={cloudAccountList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e,t=this.props.form.getFieldDecorator,a={labelCol:{span:7},wrapperCol:{span:14}};return e=this.state.cloudAccountList.map(function(e){return l.a.createElement(ut,{key:e.id,value:e.id},e.accountName)}),l.a.createElement(E.a,{title:"\u6570\u636e\u5e93\u4fe1\u606f",destroyOnClose:!0,visible:this.props.rds_info_modal_visible,onOk:this.props.handlePostRdsInfoSubmit,onCancel:this.props.handlePostRdsInfoCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",width:600},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7"},a),t("cloudAccountId",{rules:[{required:!0,message:"\u4e91\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ye.a,null,e))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8bId"},a),t("dbInstanceId",{rules:[{required:!0,message:"\u5b9e\u4f8bId\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8b\u63cf\u8ff0"},a),t("dbInstanceDescription",{rules:[{required:!0,message:"\u5b9e\u4f8b\u63cf\u8ff0\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u6570\u636e\u5e93\u7c7b\u578b"},a),t("engine",{initialValue:"Mysql",rules:[{required:!0,message:"\u6570\u636e\u5e93\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ye.a,null,l.a.createElement(ut,{value:"Mysql"},"Mysql"),l.a.createElement(ut,{value:"SqlServer"},"SqlServer")))),l.a.createElement(S.a.Item,Object.assign({label:"\u8fde\u63a5\u4e32"},a),t("connectionString",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8fde\u63a5\u4e32\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u7aef\u53e3"},a),t("port",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7aef\u53e3\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5185\u5b58(G)"},a),t("dbInstanceMemory",{rules:[{type:"integer",required:!0,message:"\u8bf7\u8f93\u5165\u6570\u503c\u578b\u6570\u636e\uff01"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u78c1\u76d8(G)"},a),t("dbInstanceStorage",{rules:[{type:"integer",required:!0,message:"\u8bf7\u8f93\u5165\u6570\u503c\u578b\u6570\u636e\uff01"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u521b\u5efa\u65f6\u95f4"},a),t("createTime",{rules:[{required:!0,message:"\u521b\u5efa\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ge.a,{format:"YYYY-MM-DD"}))),l.a.createElement(S.a.Item,Object.assign({label:"\u8fc7\u671f\u65f6\u95f4"},a),t("expireTime",{})(l.a.createElement(ge.a,{format:"YYYY-MM-DD"})))))}}]),t}(r.Component);ht=S.a.create({name:"RdsInfoModal"})(ht);var pt=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).refreshTableData=function(){a.setState({tableLoading:!0});var e={page:a.state.pagination.page,size:a.state.pagination.pageSize,queryExpiredTime:null===a.state.queryExpiredTime?null:a.state.queryExpiredTime.format("YYYY-MM-DD HH:mm:ss"),queryKeyword:a.state.queryKeyword,queryCloudAccount:a.state.queryCloudAccount};ze(e).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.rds,r=[],l=0;l<n.length;l++)r.push({key:n[l].ID,ID:n[l].ID,DBInstanceId:n[l].DBInstanceId,DBInstanceDescription:n[l].DBInstanceDescription,DBInstanceType:n[l].DBInstanceType,Engine:n[l].Engine,ExpireTime:xe()(n[l].ExpireTime).format("YYYY-MM-DD"),DBInstanceStatus:n[l].DBInstanceStatus,ConnectionString:n[l].ConnectionString,Port:n[l].Port,DBInstanceMemory:n[l].DBInstanceMemory,DBInstanceStorage:n[l].DBInstanceStorage,CloudAccountName:n[l].CloudAccountName,DataStatus:n[l].DataStatus});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.showChart=function(){var e=De.a.init(document.getElementById("rdsMonitorChart")),t={tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#623485"}}},xAxis:[{type:"category",boundaryGap:!1,data:a.state.chartXData}],yAxis:[{type:"value",axisLabel:{margin:7,formatter:"{value} "+a.state.chartFormat,textStyle:{color:"#999",fontSize:"12px"}}}],series:[{type:"line",itemStyle:{normal:{color:"rgba(43, 182, 243, 0.65)",lineStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10},areaStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10}}},data:a.state.chartYData}]};e.setOption(t)},a.openMonitorDrawer=function(e){a.setState({drawerVisible:!0,instanceId:e.DBInstanceId,currentServerDetail:e},function(){a.refreshMonitorData(e.DBInstanceId,a.state.timeTagValue,a.state.metricTagValue),a.refreshSeverDetail()})},a.refreshMonitorData=function(e,t,n){a.setState({chartLoading:!0}),Ne(e,t,n).then(function(e){if(0!==e.code)return O.a.error(e.msg),void a.setState({chartLoading:!1});if(""===e.data.Datapoints)return O.a.warn("\u672a\u83b7\u53d6\u5230\u76d1\u63a7\u6570\u636e\uff0c\u53ef\u80fd\u662f\u975e\u963f\u91cc\u4e91\u673a\u5668\u6216\u5176\u5b83\u539f\u56e0\uff01"),void a.setState({chartLoading:!1});for(var t=JSON.parse(e.data.Datapoints),n=[],r=[],l=0;l<t.length;l++)n.push(xe()(t[l].timestamp).format("DD\u65e5HH:mm")),r.push(t[l].Average);a.setState({chartXData:n,chartYData:r},function(){a.setState({chartLoading:!1}),a.showChart()})}).catch(function(e){console.log(e.toLocaleString())})},a.refreshSeverDetail=function(e){a.setState({serverDetailLoading:!0}),Fe(a.state.currentServerDetail.ID).then(function(e){0!==e.code&&O.a.error(e.msg),a.setState({currentServerDetail:e.data},function(){a.setState({serverDetailLoading:!1})})}).catch(function(e){console.log(e)})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.onExpiredDateChange=function(e){null==e?(console.log("date change: clear"),a.setState({queryExpiredTime:null})):(console.log("date change: ",e.format("YYYY-MM-DD")),a.setState({queryExpiredTime:e}))},a.keywordOnChange=function(e){a.setState({queryKeyword:e.target.value})},a.handleCloudAccountChange=function(e){a.setState({queryCloudAccount:e})},a.handleQuery=function(){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:1,current:1})},function(){a.refreshTableData()})},a.onCloseDrawer=function(){a.setState({drawerVisible:!1})},a.handleTimeTagChange=function(e){a.setState({timeTagValue:e.target.value}),a.refreshMonitorData(a.state.instanceId,e.target.value,a.state.metricTagValue)},a.handleMetricTagChange=function(e){switch(a.setState({metricTagValue:e.target.value}),e.target.value){case"CpuUsage":case"MemoryUsage":case"ConnectionUsage":case"DiskUsage":case"IOPSUsage":a.setState({chartFormat:"%"});break;case"DataDelay":a.setState({chartFormat:"Count"});break;default:a.setState({chartFormat:"\u79d2"})}a.refreshMonitorData(a.state.instanceId,a.state.timeTagValue,e.target.value)},a.handleAdd=function(){a.setState({rds_info_modal_visible:!0,rdsId:0})},a.handleBatchUpdate=function(){var e=a.state.selectedRowKeys;0!==e.length?a.setState({extraInfoModalVisible:!0,updateMode:"batch",idsList:e}):O.a.warn("\u8bf7\u5148\u9009\u62e9\u6570\u636e")},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.handlePostRdsInfoSubmit=a.handlePostRdsInfoSubmit.bind(Object(b.a)(a)),a.handlePostRdsInfoCancel=a.handlePostRdsInfoCancel.bind(Object(b.a)(a)),a.handleExtraInfoOk=a.handleExtraInfoOk.bind(Object(b.a)(a)),a.handleExtraInfoCancel=a.handleExtraInfoCancel.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a));var n=a.props.isSuperAdmin?200:100;return a.state={columns:[{title:"Id",dataIndex:"ID",key:"ID",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8bid",dataIndex:"DBInstanceId",key:"DBInstanceId",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u63cf\u8ff0",dataIndex:"DBInstanceDescription",key:"DBInstanceDescription",className:"small_font",width:200,render:function(e,t){return l.a.createElement(pe.a,{title:e},l.a.createElement(ot,{ellipsis:!0,style:{width:"200px"}},e))}},{title:"\u4e91\u8d26\u53f7",dataIndex:"CloudAccountName",key:"CloudAccountName",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u6570\u636e\u5e93\u7c7b\u578b",dataIndex:"Engine",key:"Engine",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u7c7b\u578b",dataIndex:"DBInstanceType",key:"DBInstanceType",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u8fde\u63a5\u4e32",dataIndex:"ConnectionString",key:"ConnectionString",className:"small_font",render:function(e){return l.a.createElement(ct,{style:{marginBottom:0},copyable:!0},e)}},{title:"\u7aef\u53e3",dataIndex:"Port",key:"Port",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u914d\u7f6e",dataIndex:"\u914d\u7f6e",key:"\u914d\u7f6e",className:"small_font",render:function(e,t){var a=l.a.createElement(ct,{style:{marginBottom:0,display:"inline"}},"\u5185\u5b58: ",t.DBInstanceMemory/1024,"G, "),n=l.a.createElement(ct,{style:{marginBottom:0,display:"inline"}},"\u78c1\u76d8: ",t.DBInstanceStorage,"G");return l.a.createElement("div",{className:"ip_column"},a,n)}},{title:"\u8fc7\u671f\u65f6\u95f4",dataIndex:"ExpireTime",key:"ExpireTime",className:"small_font",render:function(e){return l.a.createElement(ot,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u72b6\u6001",dataIndex:"DBInstanceStatus",key:"DBInstanceStatus",align:"center",className:"small_font",render:function(e){return"Running"===e?l.a.createElement(he.a,{status:"processing"}):l.a.createElement(he.a,{status:"error"})}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:{operWidth:n},align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.openMonitorDrawer.bind(Object(b.a)(a),t)},"\u76d1\u63a7"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"info",size:"small",onClick:a.rdsEdit.bind(Object(b.a)(a),t)},"\u7f16\u8f91"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9?",onConfirm:a.rdsDelete.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664")))}}],extraInfoModalVisible:!1,tableLoading:!1,tableData:[],chartXData:[],chartYData:[],pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},drawerVisible:!1,drawerPlacement:"left",instanceId:"",timeTagValue:"1h",metricTagValue:"CpuUsage",chartFormat:"%",currentServerDetail:{},queryExpiredTime:null,queryKeyword:"",queryCloudAccount:"0",queryManageUser:"0",queryDefineGroup:"",cloudAccountList:[],selectedRowKeys:[],idsList:[],updateMode:"single"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData(),this.loadCloudAccountsData()}},{key:"loadCloudAccountsData",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"rdsEdit",value:function(e){var t=this;this.setState({extraInfoModalVisible:!0,rdsId:e.ID,updateMode:"single",resFrom:1===e.DataStatus?"\u963f\u91cc\u4e91":"\u624b\u52a8\u6dfb\u52a0"},function(){Fe(e.ID).then(function(e){0!==e.code?O.a.error(e.msg):t.extraInfoFormRef.props.form.setFieldsValue({dbInstanceDescription:e.data.DBInstanceDescription,dbMemory:(e.data.DBInstanceMemory/1024).toString(),dbInstanceStorage:e.data.DBInstanceStorage.toString(),dbExpiredTime:""!==e.data.ExpireTime?xe()(e.data.ExpireTime):"",resForm:1===e.data.DataStatus?"\u963f\u91cc\u4e91":"\u624b\u52a8\u6dfb\u52a0"})}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleExtraInfoOk",value:function(e){var t=this,a="";a="single"===this.state.updateMode?String(this.state.rdsId):this.state.idsList.join(","),function(e){return z("cloud/rds",e)}(Object(fe.a)({},e,{id:a})).then(function(e){0===e.code?(O.a.success("\u4fee\u6539\u6210\u529f"),t.setState({extraInfoModalVisible:!1,selectedRowKeys:[]}),t.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleExtraInfoCancel",value:function(e){this.setState({extraInfoModalVisible:!1})}},{key:"rdsDelete",value:function(e){var t,a=this;(t=e.ID,V("cloud/rds",{id:t})).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handlePostRdsInfoSubmit",value:function(){var e=this;this.rdsInfoFormRef.props.form.validateFields(function(t,a){var n;t||(n=Object(fe.a)({},a,{createTime:a.createTime.format("YYYY-MM-DD HH:mm:ss"),expireTime:void 0===a.expireTime?void 0:a.expireTime.format("YYYY-MM-DD HH:mm:ss")}),P("cloud/rds",n)).then(function(t){0===t.code?(O.a.success("\u6dfb\u52a0\u6210\u529f\uff0c\u8bf7\u5230\u6743\u9650\u7ba1\u7406\u4e2d\u589e\u52a0\u8bbf\u95ee\u6743\u9650\uff01"),e.setState({rds_info_modal_visible:!1}),e.refreshTableData()):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handlePostRdsInfoCancel",value:function(){this.setState({rds_info_modal_visible:!1})}},{key:"render",value:function(){var e,t=this;e=this.state.cloudAccountList.map(function(e){return l.a.createElement(ut,{key:e.id,value:e.id},e.accountName)});var a={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return l.a.createElement(dt,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u4e91\u8d44\u6e90","\u4e91\u6570\u636e\u5e93","\u6570\u636e\u5e93\u5217\u8868"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ge.a,{style:{width:"100%"},placeholder:"\u5230\u671f\u622a\u6b62\u65f6\u95f4",defaultValue:this.state.queryExpiredTime,onChange:this.onExpiredDateChange})),l.a.createElement(te.a,{span:5,className:"col-span"},l.a.createElement(x.a,{placeholder:"\u8f93\u5165\u5b9e\u4f8bid\\\u63cf\u8ff0\\\u8fde\u63a5\u4e32\u67e5\u8be2",value:this.state.queryKeyword,onChange:this.keywordOnChange})),l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ye.a,{defaultValue:this.state.queryCloudAccount,style:{width:"100%"},onChange:this.handleCloudAccountChange},l.a.createElement(ut,{value:"0"},"\u6240\u6709\u4e91\u8d26\u53f7"),e)),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},type:"primary",icon:"search",onClick:this.handleQuery},"\u67e5 \u8be2")),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},icon:"plus-circle",onClick:this.handleAdd},"\u65b0 \u589e"))),l.a.createElement(ht,{wrappedComponentRef:function(e){return t.rdsInfoFormRef=e},rds_info_modal_visible:this.state.rds_info_modal_visible,handlePostRdsInfoSubmit:this.handlePostRdsInfoSubmit,handlePostRdsInfoCancel:this.handlePostRdsInfoCancel}),l.a.createElement(Qe,{wrappedComponentRef:function(e){return t.extraInfoFormRef=e},resType:"rds",updateMode:this.state.updateMode,resFrom:this.state.resFrom,visible:this.state.extraInfoModalVisible,handleOk:this.handleExtraInfoOk,handleCancel:this.handleExtraInfoCancel}),l.a.createElement("div",null,l.a.createElement(se.a,{title:"\u6570\u636e\u5e93\u8be6\u60c5\u53ca\u76d1\u63a7\u6570\u636e",placement:this.state.drawerPlacement,closable:!0,destroyOnClose:!0,onClose:this.onCloseDrawer,visible:this.state.drawerVisible,width:950},l.a.createElement(ve.a,{defaultActiveKey:"1",tabPosition:"left",style:{marginLeft:-30}},l.a.createElement(mt,{tab:"\u76d1\u63a7\u8be6\u60c5",key:"1"},l.a.createElement(ce.a,{tip:"\u56fe\u8868\u751f\u6210\u4e2d...",spinning:this.state.chartLoading},l.a.createElement(ee.a,{style:{marginBottom:"10px"}},l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u65f6\u95f4\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:15},l.a.createElement(ue.a.Group,{value:this.state.timeTagValue,onChange:this.handleTimeTagChange},l.a.createElement(ue.a.Button,{value:"1h"},"1\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"6h"},"6\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"12h"},"12\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"1d"},"1 \u5929"),l.a.createElement(ue.a.Button,{value:"3d"},"3 \u5929"),l.a.createElement(ue.a.Button,{value:"7d"},"7 \u5929"),l.a.createElement(ue.a.Button,{value:"14d"},"14 \u5929")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u76d1\u63a7\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:16},l.a.createElement(ue.a.Group,{value:this.state.metricTagValue,onChange:this.handleMetricTagChange},l.a.createElement(ue.a.Button,{value:"CpuUsage"},"cpu\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"MemoryUsage"},"\u5185\u5b58\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"ConnectionUsage"},"\u8fde\u63a5\u6570\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"DiskUsage"},"\u78c1\u76d8\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"IOPSUsage"},"IOPS\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"DataDelay"},"\u53ea\u8bfb\u5b9e\u4f8b\u5ef6\u8fdf")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,null,l.a.createElement("div",{id:"rdsMonitorChart",style:{height:500}}))))),l.a.createElement(mt,{tab:"\u4fe1\u606f\u8be6\u60c5",key:"2"},l.a.createElement(ce.a,{tip:"\u6570\u636e\u83b7\u53d6\u4e2d...",spinning:this.state.serverDetailLoading},l.a.createElement(oe.a,{title:"\u57fa\u672c\u4fe1\u606f",bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8bID"},this.state.currentServerDetail.DBInstanceId),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u63cf\u8ff0"},this.state.currentServerDetail.DBInstanceDescription),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u72b6\u6001"},this.state.currentServerDetail.DBInstanceStatus),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.currentServerDetail.CreateTime),l.a.createElement(oe.a.Item,{label:"\u8fc7\u671f\u65f6\u95f4"},this.state.currentServerDetail.ExpireTime),l.a.createElement(oe.a.Item,{label:"\u8fde\u63a5\u4e32"},this.state.currentServerDetail.ConnectionString),l.a.createElement(oe.a.Item,{label:"\u7aef\u53e3"},this.state.currentServerDetail.Port),l.a.createElement(oe.a.Item,{label:"\u6570\u636e\u5e93\u7c7b\u578b"},this.state.currentServerDetail.Engine),l.a.createElement(oe.a.Item,{label:"\u5185\u5b58"},this.state.currentServerDetail.DBInstanceMemory," M"),l.a.createElement(oe.a.Item,{label:"\u78c1\u76d8"},this.state.currentServerDetail.DBInstanceStorage," G"),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u7c7b\u578b"},this.state.currentServerDetail.DBInstanceType),l.a.createElement(oe.a.Item,{label:"\u6570\u636e\u5e93\u7248\u672c"},this.state.currentServerDetail.EngineVersion),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u7cfb\u5217"},this.state.currentServerDetail.Category)))))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small",rowSelection:a})))}}]),t}(r.Component),ft=Ee.a.Text,gt=Ee.a.Paragraph,bt=ye.a.Option,yt=g.a.Content,Et=ve.a.TabPane,vt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={cloudAccountList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e,t=this.props.form.getFieldDecorator,a={labelCol:{span:7},wrapperCol:{span:14}};return e=this.state.cloudAccountList.map(function(e){return l.a.createElement(bt,{key:e.id,value:e.id},e.accountName)}),l.a.createElement(E.a,{title:"Redis\u4fe1\u606f",destroyOnClose:!0,visible:this.props.kv_info_modal_visible,onOk:this.props.handlePostKvInfoSubmit,onCancel:this.props.handlePostKvInfoCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",width:600},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7"},a),t("cloudAccountId",{rules:[{required:!0,message:"\u4e91\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ye.a,null,e))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8bId"},a),t("instanceId",{rules:[{required:!0,message:"\u5b9e\u4f8bId\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8b\u540d\u79f0"},a),t("instanceName",{rules:[{required:!0,message:"\u5b9e\u4f8b\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8b\u7c7b\u578b"},a),t("instanceType",{initialValue:"Redis",rules:[{required:!0,message:"\u6570\u636e\u5e93\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ye.a,null,l.a.createElement(bt,{value:"Redis"},"Redis")))),l.a.createElement(S.a.Item,Object.assign({label:"\u8fde\u63a5\u4e32"},a),t("connectionString",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8fde\u63a5\u4e32\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u7aef\u53e3"},a),t("port",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7aef\u53e3\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5bb9\u91cf(G)"},a),t("capacity",{rules:[{type:"integer",required:!0,message:"\u8bf7\u8f93\u5165\u6570\u503c\u578b\u6570\u636e\uff01"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u5e26\u5bbd(M)"},a),t("bandwidth",{rules:[{type:"integer",required:!0,message:"\u8bf7\u8f93\u5165\u6570\u503c\u578b\u6570\u636e\uff01"}]})(l.a.createElement(be.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u521b\u5efa\u65f6\u95f4"},a),t("createTime",{rules:[{required:!0,message:"\u521b\u5efa\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(ge.a,{format:"YYYY-MM-DD"}))),l.a.createElement(S.a.Item,Object.assign({label:"\u8fc7\u671f\u65f6\u95f4"},a),t("endTime",{})(l.a.createElement(ge.a,{format:"YYYY-MM-DD"})))))}}]),t}(r.Component);vt=S.a.create({name:"KvInfoModal"})(vt);var St=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).refreshTableData=function(){a.setState({tableLoading:!0});var e={page:a.state.pagination.page,size:a.state.pagination.pageSize,queryExpiredTime:null===a.state.queryExpiredTime?null:a.state.queryExpiredTime.format("YYYY-YY-DD HH:mm:ss"),queryKeyword:a.state.queryKeyword,queryCloudAccount:a.state.queryCloudAccount};Ve(e).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.kv,r=[],l=0;l<n.length;l++)r.push({key:n[l].ID,ID:n[l].ID,InstanceId:n[l].InstanceId,InstanceName:n[l].InstanceName,InstanceType:n[l].InstanceType,ConnectionDomain:n[l].ConnectionDomain,EndTime:xe()(n[l].EndTime).format("YYYY-MM-DD"),InstanceStatus:n[l].InstanceStatus,Capacity:n[l].Capacity,QPS:n[l].QPS,Bandwidth:n[l].Bandwidth,Connections:n[l].Connections,CloudAccountName:n[l].CloudAccountName,DataStatus:n[l].DataStatus});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.showChart=function(){var e=De.a.init(document.getElementById("ecsMonitorChart")),t={tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#623485"}}},xAxis:[{type:"category",boundaryGap:!1,data:a.state.chartXData}],yAxis:[{type:"value",axisLabel:{margin:7,formatter:"{value} "+a.state.chartFormat,textStyle:{color:"#999",fontSize:"12px"}}}],series:[{type:"line",itemStyle:{normal:{color:"rgba(43, 182, 243, 0.65)",lineStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10},areaStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10}}},data:a.state.chartYData}]};e.setOption(t)},a.openMonitorDrawer=function(e){a.setState({drawerVisible:!0,instanceId:e.InstanceId,currentServerDetail:e},function(){a.refreshMonitorData(e.InstanceId,a.state.timeTagValue,a.state.metricTagValue),a.refreshSeverDetail()})},a.refreshMonitorData=function(e,t,n){a.setState({chartLoading:!0}),Re(e,t,n).then(function(e){if(0!==e.code)return O.a.error(e.msg),void a.setState({chartLoading:!1});if(""===e.data.Datapoints)return O.a.warn("\u672a\u83b7\u53d6\u5230\u76d1\u63a7\u6570\u636e\uff0c\u53ef\u80fd\u662f\u975e\u963f\u91cc\u4e91\u673a\u5668\u6216\u5176\u5b83\u539f\u56e0\uff01"),void a.setState({chartLoading:!1});for(var t=JSON.parse(e.data.Datapoints),n=[],r=[],l=0;l<t.length;l++)n.push(xe()(t[l].timestamp).format("DD\u65e5HH:mm")),r.push(t[l].Average);a.setState({chartXData:n,chartYData:r},function(){a.setState({chartLoading:!1}),a.showChart()})}).catch(function(e){O.a.error(e.toLocaleString())})},a.refreshSeverDetail=function(e){a.setState({serverDetailLoading:!0}),Ye(a.state.currentServerDetail.ID).then(function(e){0!==e.code&&O.a.error(e.msg),a.setState({currentServerDetail:e.data},function(){a.setState({serverDetailLoading:!1})})}).catch(function(e){console.log(e)})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.onExpiredDateChange=function(e){null==e?a.setState({queryExpiredTime:null}):a.setState({queryExpiredTime:e})},a.keywordOnChange=function(e){a.setState({queryKeyword:e.target.value})},a.handleCloudAccountChange=function(e){a.setState({queryCloudAccount:e})},a.handleQuery=function(){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:1,current:1})},function(){console.log(a.state.pagination.page),a.refreshTableData()})},a.onCloseDrawer=function(){a.setState({drawerVisible:!1})},a.handleTimeTagChange=function(e){a.setState({timeTagValue:e.target.value}),a.refreshMonitorData(a.state.instanceId,e.target.value,a.state.metricTagValue)},a.handleMetricTagChange=function(e){switch(a.setState({metricTagValue:e.target.value}),e.target.value){case"StandardConnectionUsage":case"StandardCpuUsage":a.setState({chartFormat:"%"});break;case"StandardAvgRt":a.setState({chartFormat:"us"});break;case"Standardappend":a.setState({chartFormat:"Count/Second"});break;default:a.setState({chartFormat:""})}a.refreshMonitorData(a.state.instanceId,a.state.timeTagValue,e.target.value)},a.handleAdd=function(){a.setState({kv_info_modal_visible:!0,kvId:0})},a.handleBatchUpdate=function(){var e=a.state.selectedRowKeys;0!==e.length?a.setState({extraInfoModalVisible:!0,updateMode:"batch",idsList:e}):O.a.warn("\u8bf7\u5148\u9009\u62e9\u6570\u636e")},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.handlePostKvInfoSubmit=a.handlePostKvInfoSubmit.bind(Object(b.a)(a)),a.handlePostKvInfoCancel=a.handlePostKvInfoCancel.bind(Object(b.a)(a)),a.handleExtraInfoOk=a.handleExtraInfoOk.bind(Object(b.a)(a)),a.handleExtraInfoCancel=a.handleExtraInfoCancel.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a));var n=a.props.isSuperAdmin?220:100;return a.state={columns:[{title:"Id",dataIndex:"ID",key:"ID",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8bid",dataIndex:"InstanceId",key:"InstanceId",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u540d\u79f0",dataIndex:"InstanceName",key:"InstanceName",className:"small_font",render:function(e,t){return l.a.createElement(pe.a,{title:e},l.a.createElement(ft,{ellipsis:!0,style:{width:"100%"}},e))}},{title:"\u4e91\u8d26\u53f7",dataIndex:"CloudAccountName",key:"CloudAccountName",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u7c7b\u578b",dataIndex:"InstanceType",key:"InstanceType",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u8fde\u63a5\u4e32",dataIndex:"ConnectionDomain",key:"ConnectionDomain",className:"small_font",render:function(e){return l.a.createElement(gt,{style:{marginBottom:0},copyable:!0},e)}},{title:"\u5e26\u5bbd",dataIndex:"Bandwidth",key:"Bandwidth",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e,"MB/s")}},{title:"\u8fde\u63a5\u6570",dataIndex:"Connections",key:"Connections",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u5bb9\u91cf",dataIndex:"Capacity",key:"Capacity",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e/1024,"G")}},{title:"QPS",dataIndex:"QPS",key:"QPS",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u8fc7\u671f\u65f6\u95f4",dataIndex:"EndTime",key:"EndTime",className:"small_font",render:function(e){return l.a.createElement(ft,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u72b6\u6001",dataIndex:"InstanceStatus",key:"InstanceStatus",align:"center",className:"small_font",render:function(e){return"Normal"===e?l.a.createElement(he.a,{status:"processing"}):l.a.createElement(he.a,{status:"error"})}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:{operWidth:n},align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.openMonitorDrawer.bind(Object(b.a)(a),t)},"\u76d1\u63a7"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"info",size:"small",onClick:a.kvEdit.bind(Object(b.a)(a),t)},"\u7f16\u8f91"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9?",onConfirm:a.kvDelete.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664")))}}],extraInfoModalVisible:!1,tableLoading:!1,tableData:[],chartXData:[],chartYData:[],pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},drawerVisible:!1,drawerPlacement:"left",instanceId:"",timeTagValue:"1h",metricTagValue:"StandardConnectionUsage",chartFormat:"%",currentServerDetail:{},queryExpiredTime:null,queryKeyword:"",queryCloudAccount:"0",queryManageUser:"0",queryDefineGroup:"",cloudAccountList:[],kv_info_modal_visible:!1,selectedRowKeys:[],idsList:[],updateMode:"single"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData(),this.loadCloudAccountsData()}},{key:"loadCloudAccountsData",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"kvEdit",value:function(e){var t=this;this.setState({extraInfoModalVisible:!0,kvId:e.ID,updateMode:"single",resFrom:1===e.DataStatus?"\u963f\u91cc\u4e91":"\u624b\u52a8\u6dfb\u52a0"},function(){Ye(e.ID).then(function(e){if(0!==e.code)O.a.error(e.msg);else{var a=!1;1===e.data.RenewStatus&&(a=!0),t.extraInfoFormRef.props.form.setFieldsValue({renewStatus:a,renewSiteId:parseInt(e.data.RenewSiteId)?parseInt(e.data.RenewSiteId):null,bankAccount:parseInt(e.data.BankAccount)?parseInt(e.data.BankAccount):null,manageUser:parseInt(e.data.ManageUser)?parseInt(e.data.ManageUser):null,cost:e.data.Cost?e.data.Cost:"0",costType:e.data.CostType?e.data.CostType:"\u5143/\u6708",kvInstanceName:e.data.InstanceName,kvBandwidth:e.data.Bandwidth.toString(),kvCapacity:(e.data.Capacity/1024).toString(),kvExpiredTime:""!==e.data.EndTime?xe()(e.data.EndTime):"",resForm:1===e.data.DataStatus?"\u963f\u91cc\u4e91":"\u624b\u52a8\u6dfb\u52a0"})}}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleExtraInfoOk",value:function(e){var t=this,a="";a="single"===this.state.updateMode?String(this.state.kvId):this.state.idsList.join(","),function(e){return z("cloud/kv",e)}(Object(fe.a)({},e,{id:a})).then(function(e){0===e.code?(O.a.success("\u4fee\u6539\u6210\u529f"),t.setState({extraInfoModalVisible:!1,selectedRowKeys:[]}),t.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleExtraInfoCancel",value:function(e){this.setState({extraInfoModalVisible:!1})}},{key:"kvDelete",value:function(e){var t,a=this;(t=e.ID,V("cloud/kv",{id:t})).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handlePostKvInfoSubmit",value:function(){var e=this;this.kvInfoFormRef.props.form.validateFields(function(t,a){var n;t||(n=Object(fe.a)({},a,{createTime:a.createTime.format("YYYY-MM-DD HH:mm:ss"),endTime:void 0===a.endTime?void 0:a.endTime.format("YYYY-MM-DD HH:mm:ss")}),P("cloud/kv",n)).then(function(t){0===t.code?(O.a.success("\u6dfb\u52a0\u6210\u529f\uff0c\u8bf7\u5230\u6743\u9650\u7ba1\u7406\u4e2d\u589e\u52a0\u8bbf\u95ee\u6743\u9650\uff01"),e.setState({kv_info_modal_visible:!1}),e.refreshTableData()):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handlePostKvInfoCancel",value:function(){this.setState({kv_info_modal_visible:!1})}},{key:"render",value:function(){var e,t=this;e=this.state.cloudAccountList.map(function(e){return l.a.createElement(bt,{key:e.id,value:e.id},e.accountName)});var a={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return l.a.createElement(yt,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(X.a,{type:"info",showIcon:!0,message:"\u66f4\u591a\u8d44\u6e90\u67e5\u770b\u6743\u9650\u53ef\u627e\u8fd0\u7ef4\u4e2d\u5fc3\u7533\u8bf7",banner:!0,closable:!0}),l.a.createElement(Ce,{pathData:["\u4e91\u8d44\u6e90","KV\u5b58\u50a8","KV\u5217\u8868"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ge.a,{style:{width:"100%"},placeholder:"\u5230\u671f\u622a\u6b62\u65f6\u95f4",defaultValue:this.state.queryExpiredTime,onChange:this.onExpiredDateChange})),l.a.createElement(te.a,{span:5,className:"col-span"},l.a.createElement(x.a,{placeholder:"\u8f93\u5165\u5b9e\u4f8bid\\\u540d\u79f0\\\u8fde\u63a5\u4e32\u67e5\u8be2",value:this.state.queryKeyword,onChange:this.keywordOnChange})),l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ye.a,{defaultValue:this.state.queryCloudAccount,style:{width:"100%"},onChange:this.handleCloudAccountChange},l.a.createElement(bt,{value:"0"},"\u6240\u6709\u4e91\u8d26\u53f7"),e)),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},type:"primary",icon:"search",onClick:this.handleQuery},"\u67e5 \u8be2")),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},icon:"plus-circle",onClick:this.handleAdd},"\u65b0 \u589e"))),l.a.createElement(vt,{wrappedComponentRef:function(e){return t.kvInfoFormRef=e},kv_info_modal_visible:this.state.kv_info_modal_visible,handlePostKvInfoSubmit:this.handlePostKvInfoSubmit,handlePostKvInfoCancel:this.handlePostKvInfoCancel}),l.a.createElement(Qe,{wrappedComponentRef:function(e){return t.extraInfoFormRef=e},resType:"kv",updateMode:this.state.updateMode,resFrom:this.state.resFrom,visible:this.state.extraInfoModalVisible,handleOk:this.handleExtraInfoOk,handleCancel:this.handleExtraInfoCancel}),l.a.createElement("div",null,l.a.createElement(se.a,{title:"\u5b9e\u4f8b\u8be6\u60c5\u53ca\u76d1\u63a7\u6570\u636e",placement:this.state.drawerPlacement,closable:!0,destroyOnClose:!0,onClose:this.onCloseDrawer,visible:this.state.drawerVisible,width:950},l.a.createElement(ve.a,{defaultActiveKey:"1",tabPosition:"left",style:{marginLeft:-30}},l.a.createElement(Et,{tab:"\u76d1\u63a7\u8be6\u60c5",key:"1"},l.a.createElement(ce.a,{tip:"\u56fe\u8868\u751f\u6210\u4e2d...",spinning:this.state.chartLoading},l.a.createElement(ee.a,{style:{marginBottom:"10px"}},l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u65f6\u95f4\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:15},l.a.createElement(ue.a.Group,{value:this.state.timeTagValue,onChange:this.handleTimeTagChange},l.a.createElement(ue.a.Button,{value:"1h"},"1\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"6h"},"6\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"12h"},"12\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"1d"},"1 \u5929"),l.a.createElement(ue.a.Button,{value:"3d"},"3 \u5929"),l.a.createElement(ue.a.Button,{value:"7d"},"7 \u5929"),l.a.createElement(ue.a.Button,{value:"14d"},"14 \u5929")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u76d1\u63a7\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:16},l.a.createElement(ue.a.Group,{value:this.state.metricTagValue,onChange:this.handleMetricTagChange},l.a.createElement(ue.a.Button,{value:"StandardConnectionUsage"},"\u8fde\u63a5\u6570\u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"StandardCpuUsage"},"CPU \u4f7f\u7528\u7387"),l.a.createElement(ue.a.Button,{value:"StandardAvgRt"},"\u5e73\u5747\u54cd\u5e94\u65f6\u95f4"),l.a.createElement(ue.a.Button,{value:"Standardappend"},"append \u547d\u4ee4\u7684\u6267\u884c\u9891\u7387")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,null,l.a.createElement("div",{id:"ecsMonitorChart",style:{height:500}}))))),l.a.createElement(Et,{tab:"\u4fe1\u606f\u8be6\u60c5",key:"2"},l.a.createElement(ce.a,{tip:"\u6570\u636e\u83b7\u53d6\u4e2d...",spinning:this.state.serverDetailLoading},l.a.createElement(oe.a,{title:"\u57fa\u672c\u4fe1\u606f",bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8bID"},this.state.currentServerDetail.InstanceId),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u540d\u79f0"},this.state.currentServerDetail.InstanceName),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u7c7b\u578b"},this.state.currentServerDetail.InstanceType),l.a.createElement(oe.a.Item,{label:"\u67b6\u6784\u7c7b\u578b"},this.state.currentServerDetail.ArchitectureType),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u5e26\u5bbd"},this.state.currentServerDetail.Bandwidth),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u5bb9\u91cf"},this.state.currentServerDetail.Capacity),l.a.createElement(oe.a.Item,{label:"\u5e26\u5bbd"},this.state.currentServerDetail.Bandwidth),l.a.createElement(oe.a.Item,{label:"\u8fde\u63a5\u5730\u5740"},this.state.currentServerDetail.ConnectionDomain),l.a.createElement(oe.a.Item,{label:"\u7aef\u53e3"},this.state.currentServerDetail.Port),l.a.createElement(oe.a.Item,{label:"\u79c1\u6709IP"},this.state.currentServerDetail.PrivateIp),l.a.createElement(oe.a.Item,{label:"\u8fde\u63a5\u6570\u9650\u5236"},this.state.currentServerDetail.Connections),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.currentServerDetail.CreateTime),l.a.createElement(oe.a.Item,{label:"\u8fc7\u671f\u65f6\u95f4"},this.state.currentServerDetail.EndTime),l.a.createElement(oe.a.Item,{label:"QPS"},this.state.currentServerDetail.QPS)))))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small",rowSelection:a})))}}]),t}(r.Component),kt=Ee.a.Text,Ct=Ee.a.Paragraph,It=g.a.Content,Dt=ye.a.Option,Ot=ve.a.TabPane,xt=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).refreshTableData=function(){a.setState({tableLoading:!0});var e={page:a.state.pagination.page,size:a.state.pagination.pageSize,queryKeyword:a.state.queryKeyword,queryCloudAccount:a.state.queryCloudAccount};Be(e).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.slb,r=[],l=0;l<n.length;l++)r.push({key:n[l].ID,ID:n[l].ID,LoadBalancerId:n[l].LoadBalancerId,LoadBalancerName:n[l].LoadBalancerName,Address:n[l].Address,InternetChargeType:n[l].InternetChargeType,CreateTime:xe()(n[l].CreateTime).format("YYYY-MM-DD"),LoadBalancerStatus:n[l].LoadBalancerStatus,CloudAccountName:n[l].CloudAccountName});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){O.a.error(e)})},a.showChart=function(){var e=De.a.init(document.getElementById("ecsMonitorChart")),t={tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#623485"}}},xAxis:[{type:"category",boundaryGap:!1,data:a.state.chartXData}],yAxis:[{type:"value",axisLabel:{margin:7,formatter:"{value} "+a.state.chartFormat,textStyle:{color:"#999",fontSize:"12px"}}}],series:[{type:"line",itemStyle:{normal:{color:"rgba(43, 182, 243, 0.65)",lineStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10},areaStyle:{color:"rgba(43, 182, 243, 0.65)",shadowColor:"rgba(43, 182, 243, 0.65)",shadowBlur:10}}},data:a.state.chartYData}]};e.setOption(t)},a.openMonitorDrawer=function(e){a.setState({drawerVisible:!0,instanceId:e.LoadBalancerId,currentServerDetail:e},function(){a.refreshMonitorData(e.LoadBalancerId,a.state.timeTagValue,a.state.metricTagValue),a.refreshSeverDetail()})},a.refreshMonitorData=function(e,t,n){a.setState({chartLoading:!0}),Pe(e,t,n).then(function(e){if(0!==e.code)return O.a.error(e.msg),void a.setState({chartLoading:!1});if(""===e.data.Datapoints)return O.a.warn("\u672a\u83b7\u53d6\u5230\u76d1\u63a7\u6570\u636e\uff0c\u53ef\u80fd\u662f\u975e\u963f\u91cc\u4e91\u673a\u5668\u6216\u5176\u5b83\u539f\u56e0\uff01"),void a.setState({chartLoading:!1});for(var t=JSON.parse(e.data.Datapoints),n=[],r=[],l=0;l<t.length;l++)n.push(xe()(t[l].timestamp).format("DD\u65e5HH:mm")),r.push(t[l].Average);a.setState({chartXData:n,chartYData:r},function(){a.setState({chartLoading:!1}),a.showChart()})}).catch(function(e){console.log(e)})},a.refreshSeverDetail=function(e){a.setState({serverDetailLoading:!0}),qe(a.state.currentServerDetail.ID).then(function(e){0!==e.code&&O.a.error(e.msg),a.setState({currentServerDetail:e.data},function(){a.setState({serverDetailLoading:!1})})}).catch(function(e){console.log(e)})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.keywordOnChange=function(e){a.setState({queryKeyword:e.target.value})},a.handleCloudAccountChange=function(e){a.setState({queryCloudAccount:e})},a.handleQuery=function(){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:1,current:1})},function(){a.refreshTableData()})},a.onCloseDrawer=function(){a.setState({drawerVisible:!1})},a.handleTimeTagChange=function(e){a.setState({timeTagValue:e.target.value}),a.refreshMonitorData(a.state.instanceId,e.target.value,a.state.metricTagValue)},a.handleMetricTagChange=function(e){switch(a.setState({metricTagValue:e.target.value}),e.target.value){case"ActiveConnection":case"MaxConnection":case"HeathyServerCount":case"UnhealthyServerCount":a.setState({chartFormat:"Count"});break;default:a.setState({chartFormat:""})}a.refreshMonitorData(a.state.instanceId,a.state.timeTagValue,e.target.value)},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.changePage=a.changePage.bind(Object(b.a)(a));var n=a.props.isSuperAdmin?200:100;return a.state={columns:[{title:"Id",dataIndex:"ID",key:"ID",className:"small_font",render:function(e){return l.a.createElement(kt,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8bid",dataIndex:"LoadBalancerId",key:"LoadBalancerId",className:"small_font",render:function(e){return l.a.createElement(kt,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u540d\u79f0",dataIndex:"LoadBalancerName",key:"LoadBalancerName",className:"small_font",width:200,render:function(e,t){return l.a.createElement(pe.a,{title:e},l.a.createElement(kt,{ellipsis:!0,style:{width:"100%"}},e))}},{title:"\u4e91\u8d26\u53f7",dataIndex:"CloudAccountName",key:"CloudAccountName",className:"small_font",render:function(e){return l.a.createElement(kt,{ellipsis:!0},e)}},{title:"\u670d\u52a1\u5730\u5740",dataIndex:"Address",key:"Address",className:"small_font",render:function(e){return l.a.createElement(Ct,{style:{marginBottom:0},copyable:!0},e)}},{title:"\u8ba1\u8d39\u65b9\u5f0f",dataIndex:"InternetChargeType",key:"InternetChargeType",className:"small_font",render:function(e){return e="4"===e?"\u6309\u6d41\u91cf\u8ba1\u8d39":"\u6309\u5e26\u5bbd\u8ba1\u8d39",l.a.createElement(kt,{ellipsis:!0},e)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"CreateTime",key:"CreateTime",className:"small_font",render:function(e){return l.a.createElement(kt,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u72b6\u6001",dataIndex:"LoadBalancerStatus",key:"LoadBalancerStatus",align:"center",className:"small_font",render:function(e){return"active"===e?l.a.createElement(he.a,{status:"processing"}):l.a.createElement(he.a,{status:"error"})}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:{operWidth:n},align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.openMonitorDrawer.bind(Object(b.a)(a),t)},"\u76d1\u63a7"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9?",onConfirm:a.slbDelete.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664")))}}],tableLoading:!1,tableData:[],chartXData:[],chartYData:[],pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},extraInfoModalVisible:!1,drawerVisible:!1,drawerPlacement:"left",cloudAccountList:[],slbId:0,instanceId:"",timeTagValue:"1h",metricTagValue:"ActiveConnection",chartFormat:"Count",currentServerDetail:{},queryKeyword:"",queryCloudAccount:"0",queryManageUser:"0",queryDefineGroup:"",selectedRowKeys:[],idsList:[],updateMode:"single"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData(),this.loadCloudAccountsData()}},{key:"loadCloudAccountsData",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"userDefineEdit",value:function(e){this.userDefineInfoFormRef.props.form.setFieldsValue({userRemark:e.UserRemark,userDefineGroup:e.UserDefineGroup}),this.setState({slbId:e.ID,userDefineInfoModalVisible:!0})}},{key:"slbDelete",value:function(e){var t,a=this;(t=e.ID,V("cloud/slb",{id:t})).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e;e=this.state.cloudAccountList.map(function(e){return l.a.createElement(Dt,{key:e.id,value:e.id},e.accountName)});var t={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return l.a.createElement(It,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u4e91\u8d44\u6e90","\u8d1f\u8f7d\u5747\u8861","\u8d1f\u8f7d\u5747\u8861\u5217\u8868"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:6,className:"col-span"},l.a.createElement(x.a,{style:{width:"100%"},placeholder:"\u8f93\u5165\u5b9e\u4f8bid\\\u540d\u79f0\\\u670d\u52a1\u5730\u5740\u67e5\u8be2",value:this.state.queryKeyword,onChange:this.keywordOnChange})),l.a.createElement(te.a,{span:4,className:"col-span"},l.a.createElement(ye.a,{defaultValue:this.state.queryCloudAccount,style:{width:"100%"},onChange:this.handleCloudAccountChange},l.a.createElement(Dt,{value:"0"},"\u6240\u6709\u4e91\u8d26\u53f7"),e)),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},type:"primary",icon:"search",onClick:this.handleQuery},"\u67e5 \u8be2"))),l.a.createElement("div",null,l.a.createElement(se.a,{title:"\u5b9e\u4f8b\u8be6\u60c5\u53ca\u76d1\u63a7\u6570\u636e",placement:this.state.drawerPlacement,closable:!0,destroyOnClose:!0,onClose:this.onCloseDrawer,visible:this.state.drawerVisible,width:950},l.a.createElement(ve.a,{defaultActiveKey:"1",tabPosition:"left",style:{marginLeft:-30}},l.a.createElement(Ot,{tab:"\u76d1\u63a7\u8be6\u60c5",key:"1"},l.a.createElement(ce.a,{tip:"\u56fe\u8868\u751f\u6210\u4e2d...",spinning:this.state.chartLoading},l.a.createElement(ee.a,{style:{marginBottom:"10px"}},l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u65f6\u95f4\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:15},l.a.createElement(ue.a.Group,{value:this.state.timeTagValue,onChange:this.handleTimeTagChange},l.a.createElement(ue.a.Button,{value:"1h"},"1\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"6h"},"6\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"12h"},"12\u5c0f\u65f6"),l.a.createElement(ue.a.Button,{value:"1d"},"1 \u5929"),l.a.createElement(ue.a.Button,{value:"3d"},"3 \u5929"),l.a.createElement(ue.a.Button,{value:"7d"},"7 \u5929"),l.a.createElement(ue.a.Button,{value:"14d"},"14 \u5929")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:3,style:{lineHeight:"30px"}},"\u76d1\u63a7\u7ef4\u5ea6\uff1a"),l.a.createElement(te.a,{span:16},l.a.createElement(ue.a.Group,{value:this.state.metricTagValue,onChange:this.handleMetricTagChange},l.a.createElement(ue.a.Button,{value:"ActiveConnection"},"\u7aef\u53e3\u5f53\u524d\u6d3b\u8dc3\u8fde\u63a5\u6570"),l.a.createElement(ue.a.Button,{value:"MaxConnection"},"\u7aef\u53e3\u5f53\u524d\u5e76\u53d1\u8fde\u63a5\u6570"),l.a.createElement(ue.a.Button,{value:"HeathyServerCount"},"\u540e\u7aef\u5065\u5eb7ECS\u5b9e\u4f8b\u4e2a\u6570"),l.a.createElement(ue.a.Button,{value:"UnhealthyServerCount"},"\u540e\u7aef\u5f02\u5e38ECS\u5b9e\u4f8b\u4e2a\u6570")))),l.a.createElement(ee.a,null,l.a.createElement(te.a,null,l.a.createElement("div",{id:"ecsMonitorChart",style:{height:500}}))))),l.a.createElement(Ot,{tab:"\u4fe1\u606f\u8be6\u60c5",key:"2"},l.a.createElement(ce.a,{tip:"\u6570\u636e\u83b7\u53d6\u4e2d...",spinning:this.state.serverDetailLoading},l.a.createElement(oe.a,{title:"\u57fa\u672c\u4fe1\u606f",bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8bID"},this.state.currentServerDetail.LoadBalancerId),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u540d\u79f0"},this.state.currentServerDetail.LoadBalancerName),l.a.createElement(oe.a.Item,{label:"\u5b9e\u4f8b\u72b6\u6001"},this.state.currentServerDetail.LoadBalancerStatus),l.a.createElement(oe.a.Item,{label:"\u670d\u52a1\u5730\u5740"},this.state.currentServerDetail.Address),l.a.createElement(oe.a.Item,{label:"\u8ba1\u8d39\u65b9\u5f0f"},this.state.currentServerDetail.InternetChargeType),l.a.createElement(oe.a.Item,{label:"\u4ed8\u8d39\u7c7b\u578b"},this.state.currentServerDetail.PayType),l.a.createElement(oe.a.Item,{label:"IP\u7248\u672c"},this.state.currentServerDetail.AddressIPVersion),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.currentServerDetail.CreateTime)))))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small",rowSelection:t})))}}]),t}(r.Component),wt=Ee.a.Text,jt=Ee.a.Paragraph,Tt=g.a.Content,_t=ye.a.Option,Mt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).confirm=function(e){a.handleDeleteAccountInfo(e)},a.showAddAccountModal=function(){a.props.form.resetFields(),a.setState({current_data_id:null,add_new_account_visible:!0})},a.handleAddAccountSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||(null!=a.state.current_data_id?(t.id=a.state.current_data_id,Me(t).then(function(e){0===e.code&&(a.setState({add_new_account_visible:!1}),O.a.success("\u66f4\u65b0\u6210\u529f\uff01")),a.refreshTableData(),a.props.form.resetFields()}).catch(function(e){console.log(e)})):_e(t).then(function(e){0===e.code&&(a.setState({add_new_account_visible:!1}),a.props.form.resetFields(),O.a.success("\u65b0\u589e\u6210\u529f\uff01")),a.refreshTableData()}).catch(function(e){console.log(e)}))})},a.handleAddAccountCancel=function(e){a.props.form.resetFields(),a.setState({add_new_account_visible:!1})},a.handleEditAccountInfo=function(e){a.props.form.setFieldsValue({id:e.id,accountType:e.accountType,accountName:e.accountName,accountPwd:e.accountPwd,accountKey:e.accountKey,accountSecret:e.accountSecret,accountRegion:e.accountRegion,bankAccount:e.bankAccountId}),a.setState({current_data_id:e.id,add_new_account_visible:!0})},a.handleDeleteAccountInfo=function(e){Le({id:e.id}).then(function(e){0===e.code&&O.a.success("\u5220\u9664\u6210\u529f\uff01"),a.refreshTableData()}).catch(function(e){console.log(e)})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e})},function(){a.refreshTableData()})},a.refreshTableData=function(){a.setState({tableLoading:!0}),Te(a.state.pagination.page,a.state.pagination.pageSize).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.accounts,r=[],l=0;l<n.length;l++)r.push({id:n[l].id,key:n[l].id,accountType:n[l].accountType,accountName:n[l].accountName,accountPwd:n[l].accountPwd,accountKey:n[l].accountKey,accountSecret:n[l].accountSecret,accountRegion:n[l].accountRegion,bankAccountId:n[l].bankAccountId});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.state={columns:[{title:"\u4e91\u7c7b\u578b",dataIndex:"accountType",key:"accountType",className:"small_font",render:function(e){return l.a.createElement(wt,{ellipsis:!0},e)}},{title:"\u8d26\u53f7\u540d\u79f0",dataIndex:"accountName",key:"accountName",className:"small_font",render:function(e){return l.a.createElement(wt,{ellipsis:!0},e)}},{title:"\u8d26\u53f7\u5bc6\u7801",dataIndex:"accountPwd",key:"accountPwd",className:"small_font",render:function(e){return l.a.createElement(wt,{ellipsis:!0},e)}},{title:"\u8bbf\u95eekey",dataIndex:"accountKey",key:"accountKey",className:"small_font",render:function(e){return l.a.createElement(jt,{style:{marginBottom:0},copyable:!0},e)}},{title:"\u8bbf\u95eesecret",dataIndex:"accountSecret",key:"accountSecret",className:"small_font",render:function(e){return l.a.createElement(jt,{style:{marginBottom:0},copyable:!0},e)}},{title:"\u6240\u5c5e\u533a\u57df",dataIndex:"accountRegion",key:"accountRegion",className:"small_font",render:function(e){return l.a.createElement(wt,{ellipsis:!0},e)}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:160,align:"center",className:"small_font",render:function(e,t){var n;return n=a.props.isSuperAdmin?l.a.createElement(r.Fragment,null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.handleEditAccountInfo.bind(Object(b.a)(a),t)},"\u7f16\u8f91"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9?",onConfirm:a.confirm.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664"))):l.a.createElement("span",null,"\u65e0\u64cd\u4f5c\u6743\u9650"),l.a.createElement("div",null,n)}}],tableData:[],tableLoading:!1,add_new_account_visible:!1,current_data_id:null,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData()}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:7},wrapperCol:{span:14}};return l.a.createElement(Tt,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u4e91\u8d44\u6e90","\u4e91\u8d26\u53f7","\u8d26\u53f7\u5217\u8868"]}),this.props.isSuperAdmin?l.a.createElement("div",{style:{marginBottom:10}},l.a.createElement(Z.a,{type:"primary",onClick:this.showAddAccountModal},"\u65b0\u589e\u8d26\u53f7")):"",l.a.createElement(E.a,{title:"\u4e91\u8d26\u53f7\u4fe1\u606f\u8be6\u60c5",visible:this.state.add_new_account_visible,onOk:this.handleAddAccountSubmit,onCancel:this.handleAddAccountCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7\u7c7b\u578b"},t),e("accountType",{rules:[{required:!0,message:"\u8d26\u53f7\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a\uff01"}],initialValue:"\u963f\u91cc\u4e91"})(l.a.createElement(ye.a,{size:"default"},l.a.createElement(_t,{value:"\u963f\u91cc\u4e91"},"\u963f\u91cc\u4e91")))),l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7\u540d\u79f0"},t),e("accountName",{rules:[{required:!0,message:"\u8d26\u53f7\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7\u5bc6\u7801"},t),e("accountPwd",{rules:[{required:!0,message:"\u8d26\u53f7\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7key"},t),e("accountKey",{rules:[{required:!0,message:"\u8d26\u53f7key\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7secret"},t),e("accountSecret",{rules:[{required:!0,message:"\u8d26\u53f7secret\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u6240\u5c5e\u533a\u57df"},t),e("accountRegion",{rules:[{required:!0,message:"\u6240\u5c5e\u533a\u57df\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small"}))}}]),t}(r.Component),Lt=Mt=S.a.create({name:"cloudAccount"})(Mt),At=a(636),Nt=(a(104),a(59)),Rt=(a(1027),a(634)),Pt=(a(1030),a(458)),zt=(a(1033),a(368)),Vt=function(e){return R("daily_job/",e)},Bt=function(e){return z("daily_job/",e)},Ft=function(e){return z("daily_job/executorUser",e)},Yt=Pt.a.Step,qt=g.a.Content,Kt=ye.a.Option,Ht=x.a.TextArea,Jt=[{value:"\u65e5\u5e38\u5de5\u4f5c",label:"\u65e5\u5e38\u5de5\u4f5c",children:[{value:"\u534f\u52a9",label:"\u534f\u52a9"}]}],Ut={"":[{field:"task_content",text:"\u95ee\u9898\u63cf\u8ff0",type:"text",errorMessage:"\u8bf7\u8f93\u5165\u5177\u4f53\u95ee\u9898\u63cf\u8ff0",required:!0}],"\u65e5\u5e38\u5de5\u4f5c-\u534f\u52a9":[{field:"task_content",text:"\u5de5\u4f5c\u5185\u5bb9",type:"text",errorMessage:"\u8bf7\u8f93\u5165\u5177\u4f53\u5de5\u4f5c\u5185\u5bb9"},{field:"open_deploy_auto_config",text:"\u81ea\u5b9a\u4e49\u9879",type:"kvinput"}]},Gt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).addNewConfig=a.addNewConfig.bind(Object(b.a)(a)),a.state={configCount:0,configData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.onChange=this.props.onChange}},{key:"deleteConfigItem",value:function(e){var t=e.index,a=this.state.configData;a.splice(t,1),this.setState({configData:a}),this.onChange(this.state.configData)}},{key:"addNewConfig",value:function(){var e=this.state.configData;e.push({key:"",value:""}),this.setState(e)}},{key:"handleKeyChange",value:function(e,t){var a=e.index,n=this.state.configData;n[a].key=t.target.value,this.setState(n),this.onChange(this.state.configData)}},{key:"handleValueChange",value:function(e,t){var a=e.index,n=this.state.configData;n[a].value=t.target.value,this.setState(n),this.onChange(this.state.configData)}},{key:"render",value:function(){var e=this,t=this.state.configData.map(function(t,a){return l.a.createElement(ee.a,null,l.a.createElement(zt.a,{span:10,style:{marginRight:10}},l.a.createElement(x.a,{key:"k{index}",addonBefore:"\u952e",value:t.key,onChange:e.handleKeyChange.bind(e,{index:a})})),l.a.createElement(zt.a,{span:10,style:{marginRight:10}},l.a.createElement(x.a,{key:"v{index}",addonBefore:"\u503c",value:t.value,onChange:e.handleValueChange.bind(e,{index:a})})),l.a.createElement(zt.a,{span:2},l.a.createElement(Z.a,{type:"danger",icon:"minus-circle",shape:"circle",onClick:e.deleteConfigItem.bind(e,{index:a})})))});return l.a.createElement(r.Fragment,null,t,l.a.createElement(ee.a,null,l.a.createElement(zt.a,{span:5},l.a.createElement(Z.a,{type:"primary",icon:"plus-circle",onClick:this.addNewConfig},"\u6dfb\u52a0\u65b0\u9879"))))}}]),t}(r.Component),Qt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={deptData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:8},wrapperCol:{span:10}};return l.a.createElement(qt,{style:{height:"100%"}},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u5de5\u5355\u540d\u79f0"}),e("jobName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5de5\u5355\u4efb\u52a1\u540d\u79f0"}]})(l.a.createElement(x.a,{placeholder:"\u8bf7\u8f93\u5165\u5de5\u5355\u4efb\u52a1\u540d\u79f0"}))),l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u5de5\u5355\u7c7b\u578b"}),e("jobType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5de5\u5355\u7c7b\u578b"}]})(l.a.createElement(Rt.a,{placeholder:"\u8bf7\u9009\u62e9\u5de5\u5355\u7c7b\u578b",options:Jt}))),l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u8be5\u4efb\u52a1\u7d27\u6025\u7a0b\u5ea6",style:{textAlign:"left"}}),e("importantDegree",{initialValue:"\u666e\u901a",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4efb\u52a1\u7d27\u6025\u7a0b\u5ea6"}]})(l.a.createElement(ue.a.Group,{buttonStyle:"solid"},l.a.createElement(pe.a,{placement:"topLeft",title:"\u7b49\u5f85\u76f8\u5173\u4eba\u5458\u6839\u636e\u81ea\u8eab\u4efb\u52a1\u9879\u5b89\u6392\u65f6\u95f4\u5904\u7406"},l.a.createElement(ue.a.Button,{value:"\u666e\u901a"},"\u666e\u901a")),l.a.createElement(pe.a,{placement:"topLeft",title:"\u9700\u8981\u5728\u534a\u5c0f\u65f6\u5185\u5904\u7406\u5b8c\u6210"},l.a.createElement(ue.a.Button,{value:"\u7d27\u6025"},"\u7d27\u6025")),l.a.createElement(pe.a,{placement:"topLeft",title:"\u9700\u8981\u7acb\u5373\u5b89\u6392\u4eba\u5458\u5904\u7406"},l.a.createElement(ue.a.Button,{value:"\u975e\u5e38\u7d27\u6025"},"\u975e\u5e38\u7d27\u6025")))))))}}]),t}(r.Component);Qt=S.a.create({name:"JobBaseInfoForm"})(Qt);var Wt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).getFormInputContent=a.getFormInputContent.bind(Object(b.a)(a)),a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getFormInputContent",value:function(e){var t;switch(e.type){case"char":t=l.a.createElement(x.a,null);break;case"text":t=l.a.createElement(Ht,{rows:4});break;case"select":t=l.a.createElement(ye.a,{style:{width:120}},e.options.map(function(e,t){return l.a.createElement(Kt,{key:t,value:e},e)}));break;case"kvinput":t=l.a.createElement(Gt,{setFieldsValue:this.props.form.setFieldsValue});break;default:t=l.a.createElement(x.a,null)}return t}},{key:"render",value:function(){var e,t=this,a=this.props.form.getFieldDecorator,n={labelCol:{span:4},wrapperCol:{span:18}},r=Ut[this.props.jobType];return void 0===r&&(r=Ut[""]),e=r.map(function(e,r){return l.a.createElement(S.a.Item,Object.assign({key:r},n,{label:e.text,style:{textAlign:"left"}}),a(e.field,{rules:[{required:e.required,message:e.errorMessage}]})(t.getFormInputContent(e)))}),l.a.createElement(qt,{style:{height:"100%"}},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({},n,{label:"\u5173\u5065\u4fe1\u606f",required:!0}),l.a.createElement(Nt.a,{span:20,size:"small",title:"\u586b\u5199\u5b8c\u5584\u548c\u51c6\u786e\u53ef\u4ee5\u63d0\u9ad8\u5de5\u5355\u5904\u7406\u6548\u7387\u54e6",headStyle:{backgroundColor:"#e6f7ff",fontWeight:"350"}},e)),l.a.createElement(ee.a,{style:{marginBottom:10}},l.a.createElement(zt.a,{span:4}),l.a.createElement(zt.a,{span:18},l.a.createElement(X.a,{message:"\u4f60\u53ef\u4ee5\u5728\u5907\u6ce8\u4fe1\u606f\u4e2d\u586b\u5199\u6ce8\u610f\u4e8b\u9879\uff0c\u53ef\u4ee5\u907f\u514d\u6267\u884c\u8fc7\u7a0b\u4e2d\u51fa\u9519\u54e6",type:"info",closable:!0}))),l.a.createElement(S.a.Item,Object.assign({},n,{label:"\u5907\u6ce8\u4fe1\u606f"}),a("remark")(l.a.createElement(Ht,{rows:4})))))}}]),t}(r.Component);Wt=S.a.create({name:"JobConfigInfoForm"})(Wt);var Xt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).submitJobForm=a.submitJobForm.bind(Object(b.a)(a)),a.state={current:0,stepStatus:"wait",jobTypeStr:"",form1Data:null,form2Data:null,submitLoading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"next",value:function(){var e=this;0===this.state.current&&this.baseInfo.props.form.validateFields(function(t,a){if(t)e.setState({stepStatus:"error"});else{var n=e.state.current+1,r=Object.assign({},e.state.form1Data,a);e.setState({current:n,stepStatus:"process",jobTypeStr:a.jobType.join("-"),form1Data:r}),e.carousel.next()}})}},{key:"prev",value:function(){switch(this.state.current){case 2:this.setState({form3Data:null});break;case 1:this.setState({form2Data:null})}var e=this.state.current-1;this.setState({current:e}),this.carousel.prev()}},{key:"submitJobForm",value:function(){var e=this;this.configInfo.props.form.validateFields(function(t,a){if(t)e.setState({stepStatus:"error"});else{var n=Object.assign({},e.state.form2Data,a);e.setState({stepStatus:"finish",form2Data:n},function(){e.setState({submitLoading:!0});var t,a=Object(fe.a)({},e.state.form1Data,e.state.form2Data,{jobType:e.state.form1Data.jobType.join("-"),open_deploy_auto_config:JSON.stringify(e.state.form2Data.open_deploy_auto_config)});(t=a,P("daily_job/",t)).then(function(t){0===t.code?(e.setState({submitLoading:!1}),O.a.success(t.msg),e.props.history.push("/admin/task/jobs")):(e.setState({submitLoading:!1}),O.a.error(t.msg))}).catch(function(t){e.setState({submitLoading:!1}),O.a.error(t.toLocaleString())})})}})}},{key:"render",value:function(){var e=this,t=this.state.current;return l.a.createElement(qt,{style:{background:"#fff",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u5de5\u4f5c\u534f\u52a9","\u65e5\u5e38\u5de5\u5355"]}),l.a.createElement(Pt.a,{current:t,size:"small",style:{marginTop:20},status:this.state.stepStatus},l.a.createElement(Yt,{title:"\u4efb\u52a1\u57fa\u672c\u4fe1\u606f",icon:l.a.createElement(I.a,{type:"solution"})}),l.a.createElement(Yt,{title:"\u4efb\u52a1\u8be6\u60c5",icon:l.a.createElement(I.a,{type:"highlight"})})),l.a.createElement("div",{className:"steps-content",style:{textAlign:"center",padding:20}},l.a.createElement($.a,{ref:function(t){e.carousel=t},dots:!1,effect:"fade",adaptiveHeight:!0,style:{textAlign:"center"}},l.a.createElement(r.Fragment,{key:1},l.a.createElement(Qt,{wrappedComponentRef:function(t){e.baseInfo=t}})),l.a.createElement(r.Fragment,{key:2},l.a.createElement(Wt,{wrappedComponentRef:function(t){e.configInfo=t},jobType:this.state.jobTypeStr,loadConfigDataTemplateSpin:this.state.loadConfigDataTemplateSpin})))),l.a.createElement("div",{className:"steps-action",style:{textAlign:"center",marginTop:20}},t<1&&l.a.createElement(Z.a,{type:"primary",onClick:function(){return e.next()}},"\u4e0b\u4e00\u6b65"),1===t&&l.a.createElement(Z.a,{type:"primary",loading:this.state.submitLoading,onClick:this.submitJobForm},"\u63d0 \u4ea4"),t>0&&l.a.createElement(Z.a,{style:{marginLeft:8},onClick:function(){return e.prev()}},"\u4e0a\u4e00\u6b65")))}}]),t}(r.Component),Zt=(a(121),a(34)),$t=a(218),ea=a.n($t);function ta(){var e=localStorage.getItem("ops_token");if(void 0!==e&&null!==e&&""!==e)return ea()(e).userInfo.userId;window.location.href="/login"}xe.a.locale("zh-cn");var aa=x.a.TextArea,na=Ee.a.Text,ra=Ee.a.Paragraph,la=g.a.Content,ia="0001-01-01 00:00:00",sa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.handlerChangeExecutorCommit=function(){if(0!==a.state.changeToUserId){var e={jobId:a.state.jobChangeId,changeUserId:a.state.changeToUserId};Ft(e).then(function(e){0===e.code?(O.a.success(e.msg),a.setState({changeExecutorModalVisible:!1}),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}else O.a.error("\u8bf7\u9009\u62e9\u4efb\u52a1\u6267\u884c\u4eba")},a.handlerRefuseJobCommit=function(){0!==a.state.refuseId?""!==a.state.refuseReason?Bt({id:a.state.refuseId,refuseReason:a.state.refuseReason,action:"refuseJob"}).then(function(e){0===e.code?(a.setState({refuseJobModalVisible:!1}),O.a.success("\u64cd\u4f5c\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())}):O.a.error("\u5fc5\u987b\u586b\u5199\u62d2\u7edd\u539f\u56e0"):O.a.error("\u672a\u9009\u62e9\u62d2\u7edd\u5de5\u5355")},a.refreshTableData=function(){a.setState({tableLoading:!0});var e={page:a.state.pagination.page,size:a.state.pagination.pageSize,queryKeyword:a.state.queryKeyword,queryCreateTime:a.state.queryCreateTime};Vt(e).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.jobs,r=[],l=0;l<n.length;l++)r.push({key:n[l].id,id:n[l].id,job_name:n[l].job_name,job_type:n[l].job_type,important_degree:n[l].important_degree,creator_user_name:n[l].creator_user_name,executor_user_name:n[l].executor_user_name,status:n[l].status,create_time:n[l].create_time,accept_time:n[l].accept_time,end_time:n[l].end_time,approve_id:n[l].approve_id,approve_content:n[l].approve_content,refuse_reason:n[l].refuse_reason,isExecutorChangable:2===n[l].status&&n[l].executor_user_id===ta(),isGetEnable:1===n[l].status,isFinishEnable:2===n[l].status&&n[l].executor_user_id===ta(),isDeleteEnable:n[l].creator_user_id===ta()&&n[l].status<2,isRefuseEnable:1===n[l].status});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.keywordOnChange=function(e){a.setState({queryKeyword:e.target.value})},a.handleQuery=function(){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:1,current:1})},function(){a.refreshTableData()})},a.onDrawerClose=function(){a.setState({drawerVisible:!1})},a.onQueryDateChange=function(e){null==e?a.setState({queryCreateTime:null}):a.setState({queryCreateTime:e.format("YYYY-MM-DD")})},a.downloadFile=a.downloadFile.bind(Object(b.a)(a)),a.ChangeExecutorSelect=a.ChangeExecutorSelect.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.changeRefuseReason=a.changeRefuseReason.bind(Object(b.a)(a)),a.autoCreateJob=a.autoCreateJob.bind(Object(b.a)(a)),a.state={columns:[{title:"Id",dataIndex:"id",key:"id",className:"small_font",render:function(e){return l.a.createElement(na,{ellipsis:!0},e)}},{title:"\u7d27\u6025\u5ea6",dataIndex:"important_degree",key:"important_degree",className:"small_font",render:function(e){var t;switch(e){case"\u975e\u5e38\u7d27\u6025":t=l.a.createElement(Zt.a,{color:"#f50"},e);break;case"\u7d27\u6025":t=l.a.createElement(Zt.a,{color:"rgb(255, 147, 137)"},e);break;default:t=l.a.createElement(Zt.a,{color:"#108ee9"},e)}return t}},{title:"\u72b6\u6001",dataIndex:"status",key:"status",className:"small_font",render:function(e){var t=a.getStatusText(e);return l.a.createElement(na,{ellipsis:!0},t)}},{title:"\u4efb\u52a1\u540d",dataIndex:"job_name",key:"job_name",className:"small_font",render:function(e){return l.a.createElement(na,{ellipsis:!0},e)}},{title:"\u4efb\u52a1\u7c7b\u578b",dataIndex:"job_type",key:"job_type",className:"small_font",render:function(e){return l.a.createElement(na,{ellipsis:!0},e)}},{title:"\u521b\u5efa\u4eba",dataIndex:"creator_user_name",key:"creator_user_name",className:"small_font",render:function(e){return l.a.createElement(na,{ellipsis:!0},e)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",key:"create_time",width:150,className:"small_font",render:function(e){return l.a.createElement(na,{ellipsis:!0},xe()(e).format("MM\u6708DD\u65e5HH:mm"))}},{title:"\u6267\u884c\u4eba",dataIndex:"executor_user_name",key:"executor_user_name",className:"small_font",render:function(e){return l.a.createElement(na,{ellipsis:!0},e)}},{title:"\u54cd\u5e94\u65f6\u95f4",dataIndex:"accept_time",key:"accept_time",width:150,className:"small_font",render:function(e){return e===ia?l.a.createElement(na,{ellipsis:!0},"-"):l.a.createElement(na,{ellipsis:!0},xe()(e).format("MM\u6708DD\u65e5HH:mm"))}},{title:"\u7ed3\u675f\u65f6\u95f4",dataIndex:"end_time",key:"end_time",width:150,className:"small_font",render:function(e){return e===ia?l.a.createElement(na,{ellipsis:!0},"-"):l.a.createElement(na,{ellipsis:!0},xe()(e).format("MM\u6708DD\u65e5HH:mm"))}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",align:"center",className:"small_font",render:function(e,t){return l.a.createElement(r.Fragment,null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.showJobDetail.bind(Object(b.a)(a),t)},"\u8be6\u60c5"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"info",size:"small",disabled:!t.isGetEnable,onClick:a.startJob.bind(Object(b.a)(a),t.id)},"\u9886\u53d6"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"info",size:"small",disabled:!t.isFinishEnable,onClick:a.finishJob.bind(Object(b.a)(a),t.id)},"\u5b8c\u6210"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"danger",size:"small",disabled:!t.isRefuseEnable,onClick:a.refuseJob.bind(Object(b.a)(a),t.id)},"\u62d2\u7edd"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"danger",size:"small",disabled:!t.isDeleteEnable,onClick:a.deleteJob.bind(Object(b.a)(a),t.id)},"\u5220\u9664"))}}],tableLoading:!1,drawerSpinning:!1,drawerVisible:!1,opsUsersList:[],changeExecutorModalVisible:!1,refuseJobModalVisible:!1,refuseId:0,refuseReason:"",changeToUserId:0,jobChangeId:0,tableData:[],pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},job_file:"",queryKeyword:"",currentJob:"",currentJobDetail:"",isGetEnable:!0,isFinishEnable:!0,isDeleteEnable:!0,queryCreateTime:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData()}},{key:"showJobDetail",value:function(e){var t,a=this;this.setState({drawerVisible:!0,drawerSpinning:!0,currentJob:e}),(t=e.id,R("daily_job/info/"+t)).then(function(e){0===e.code?a.setState(Object(fe.a)({},e.data,{currentJobDetail:e.data}),function(){}):O.a.error(e.msg),a.setState({drawerSpinning:!1})}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"startJob",value:function(e){var t=this;Bt({id:e,action:"getJob"}).then(function(e){if(0===e.code){var a=Object.assign({},t.state.currentJob,{isGetEnable:!1});O.a.success("\u9886\u53d6\u6210\u529f"),t.setState({currentJob:a}),t.refreshTableData()}else O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"changeExecutor",value:function(e){this.setState({changeExecutorModalVisible:!0,jobChangeId:e})}},{key:"ChangeExecutorSelect",value:function(e){this.setState({changeToUserId:e})}},{key:"changeRefuseReason",value:function(e){this.setState({refuseReason:e.target.value})}},{key:"finishJob",value:function(e){var t=this;Bt({id:e,action:"finishJob"}).then(function(e){0===e.code?(O.a.success("\u6210\u529f\u5b8c\u6210\uff0c\u7ee7\u7eed\u52aa\u529b"),t.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"refuseJob",value:function(e){this.setState({refuseJobModalVisible:!0,refuseId:e})}},{key:"deleteJob",value:function(e){var t=this;Bt({id:e,action:"deleteJob"}).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),t.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"downloadFile",value:function(){window.open(M+"fileDownload?objectName="+encodeURIComponent(this.state.job_file),"_blank")}},{key:"autoCreateJob",value:function(){localStorage.setItem("job_template",JSON.stringify(this.state.currentJobDetail)),this.props.history.push({pathname:"/admin/task/deploy_project"})}},{key:"getStatusText",value:function(e){var t;switch(e){case 1:t=l.a.createElement(Zt.a,{color:"volcano"},"\u5f85\u9886\u53d6");break;case 2:t=l.a.createElement(Zt.a,{color:"geekblue"},"\u5904\u7406\u4e2d");break;case 3:t=l.a.createElement(Zt.a,{color:"green"},"\u5df2\u5b8c\u6210");break;case 0:t=l.a.createElement(Zt.a,{color:"magenta"},"\u5df2\u62d2\u7edd");break;default:t=l.a.createElement(Zt.a,{color:"lime"},"\u5df2\u5220\u9664")}return t}},{key:"render",value:function(){var e,t=this;if(this.state.status>0&&this.state.status<3){var a=xe()(this.state.create_time),n=xe()(xe()().format("YYYY-MM-DD HH:mm:ss")),i=xe.a.duration(n-a,"ms");e=this.state.creator_user_name+" \u5df2\u7b49\u5f85 "+i.humanize()}else{var s=xe()(this.state.create_time),o=xe()(this.state.end_time);e="\u5de5\u5355\u7528\u65f6: "+xe.a.duration(o-s,"ms").humanize()}var c=l.a.createElement(oe.a.Item,{label:"\u65e0\u914d\u7f6e"},"\u7528\u6237\u672a\u8bbe\u7f6e");void 0!==this.state.open_deploy_auto_config&&""!==this.state.open_deploy_auto_config&&(c=JSON.parse(this.state.open_deploy_auto_config).map(function(e,t){return l.a.createElement(oe.a.Item,{key:t,label:e.key},l.a.createElement(ra,{style:{marginBottom:0,width:"300px"},ellipsis:!0,copyable:""!==e.value},e.value))}));var u="";0===this.state.status&&(u=l.a.createElement(X.a,{style:{marginTop:10},message:l.a.createElement(r.Fragment,null,"\u62d2\u7edd\u539f\u56e0\uff1a",this.state.refuse_reason),type:"error"}));var d=l.a.createElement("div",null,l.a.createElement("span",{style:{marginRight:"20px"}},"\u5de5\u5355\u8be6\u60c5"));return l.a.createElement(la,{stmayle:{background:"#fff",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u5de5\u4f5c\u534f\u52a9","\u5de5\u5355\u5217\u8868"]}),l.a.createElement("div",{style:{marginBottom:20}},l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:8,className:"col-span"},l.a.createElement(x.a,{placeholder:"\u8f93\u5165\u5de5\u5355\u540d\u79f0\u3001\u521b\u5efa\u4eba\u3001\u6267\u884c\u4eba\u67e5\u8be2",value:this.state.queryKeyword,onChange:this.keywordOnChange})),l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ge.a,{style:{width:"100%"},defaultValue:this.state.queryCreateTime,placeholder:"\u521b\u5efa\u65f6\u95f4",onChange:this.onQueryDateChange})),l.a.createElement(te.a,{span:3},l.a.createElement(Z.a,{type:"primary",icon:"search",onClick:this.handleQuery},"\u67e5 \u8be2")))),l.a.createElement(E.a,{title:"\u4f60\u6b63\u5728\u62d2\u7edd\u4ed6\u4eba\u5de5\u5355\uff0c\u8bf7\u8c28\u614e\u64cd\u4f5c\uff01",visible:this.state.refuseJobModalVisible,onOk:this.handlerRefuseJobCommit,onCancel:function(){t.setState({refuseJobModalVisible:!1})},style:{textAlign:"center"}},l.a.createElement(X.a,{type:"warning",message:"\u8bf7\u8be6\u7ec6\u586b\u5199\u4f60\u7684\u62d2\u7edd\u7406\u7531\uff0c\u5c06\u53cd\u9988\u7ed9\u5de5\u5355\u521b\u5efa\u8005\u5e76\u7559\u5b58\uff01",style:{marginBottom:10}}),l.a.createElement(aa,{rows:4,placeholder:"\u586b\u5199\u8be6\u7ec6\u62d2\u7edd\u539f\u56e0\uff0c\u4ee5\u4fbf\u5bf9\u65b9\u540e\u7eed\u5b8c\u5584",onChange:this.changeRefuseReason})),l.a.createElement(se.a,{title:d,placement:"left",closable:!0,onClose:this.onDrawerClose,visible:this.state.drawerVisible,width:800},l.a.createElement(ce.a,{tip:"\u6570\u636e\u52a0\u8f7d\u4e2d...",spinning:this.state.drawerSpinning},l.a.createElement(ee.a,{style:{marginBottom:10}},l.a.createElement(te.a,{style:{fontSize:15}},l.a.createElement(X.a,{message:l.a.createElement(r.Fragment,null,this.getStatusText(this.state.status),this.state.job_name),type:"info"}),u)),l.a.createElement(ee.a,{style:{marginBottom:10}},l.a.createElement(te.a,null,l.a.createElement(X.a,{message:e,type:"warning",showIcon:!0}))),l.a.createElement(ee.a,{style:{marginTop:"10px"}},l.a.createElement(Nt.a,{size:"small",title:"\u5de5\u5355\u57fa\u672c\u4fe1\u606f",style:{marginBottom:10}},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u4efb\u52a1\u7c7b\u578b"},this.state.job_type),l.a.createElement(oe.a.Item,{label:"\u7d27\u6025\u5ea6"},this.state.important_degree),l.a.createElement(oe.a.Item,{label:"\u53d1\u8d77\u65f6\u95f4"},this.state.create_time)))),l.a.createElement(ee.a,{style:{marginTop:"10px"}},l.a.createElement(Nt.a,{size:"small",title:"\u666e\u901a\u914d\u7f6e\u4fe1\u606f",style:{marginBottom:10}},l.a.createElement(oe.a,{bordered:!0,size:"small",column:1,style:{marginTop:"10px"}},l.a.createElement(oe.a.Item,{label:"\u4efb\u52a1\u5185\u5bb9"},l.a.createElement(ra,{style:{marginBottom:0},ellipsis:!0,copyable:""!==this.state.task_content},this.state.task_content)))),l.a.createElement(Nt.a,{size:"small",title:"\u81ea\u5b9a\u4e49\u4fe1\u606f"},l.a.createElement(oe.a,{bordered:!0,size:"small",column:1,style:{marginTop:"10px"}},c))),l.a.createElement(ee.a,{style:{textAlign:"center",marginTop:20}},l.a.createElement(te.a,{span:7}),l.a.createElement(te.a,{span:4},l.a.createElement(Z.a,{type:"primary",disabled:!this.state.currentJob.isGetEnable,onClick:this.startJob.bind(this,this.state.currentJob.id)},"\u4e00\u952e\u9886\u53d6")),l.a.createElement(te.a,{offset:1}),l.a.createElement(te.a,{span:4},l.a.createElement(Z.a,{type:"danger",disabled:!this.state.currentJob.isFinishEnable,onClick:this.finishJob.bind(this,this.state.currentJob.id)},"\u6211\u5df2\u5b8c\u6210")),l.a.createElement(te.a,{span:7})),l.a.createElement(ee.a,{style:{minHeight:30}}))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small"}))}}]),t}(r.Component),oa=At.Layout.Content,ca=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement(oa,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(p.a,null,l.a.createElement(f.a,{path:"/admin/task/deploy_project",component:Xt}),l.a.createElement(f.a,{path:"/admin/task/jobs",component:sa})))}}]),t}(r.Component),ua=g.a.Content,da=Ee.a.Text,ma={overFlow:"hidden",textOverflow:"ellipsis",display:"-webkit-box"},ha=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:7},wrapperCol:{span:14}};return l.a.createElement(E.a,{title:"\u65b0\u589e\u7528\u6237",destroyOnClose:!0,visible:this.props.userModalVisible,onOk:this.props.handleAddUserSubmit,onCancel:this.props.handleAddUserCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",centered:!0,width:600},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({label:"\u90ae\u7bb1"},t),e("email",{rules:[{required:!0,message:"\u6ce8\u518c\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u7528\u6237\u540d"},t),e("username",{rules:[{required:!0,message:"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u521d\u59cb\u5bc6\u7801"},t),e("password",{rules:[{required:!0,message:"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u804c\u4f4d"},t),e("position",{rules:[{required:!0,message:"\u804c\u4f4d\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]})(l.a.createElement(x.a,null)))))}}]),t}(r.Component);ha=S.a.create({name:"UserModal"})(ha);var pa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.refreshTableData=function(){a.setState({tableLoading:!0}),B(a.state.pagination.page,a.state.pagination.pageSize).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.users,r=[],l=0;l<n.length;l++)r.push({ID:n[l].ID,username:n[l].username,email:n[l].email,position:n[l].position,active:n[l].active});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.handleAdd=a.handleAdd.bind(Object(b.a)(a)),a.handleAddUserSubmit=a.handleAddUserSubmit.bind(Object(b.a)(a)),a.handleAddUserCancel=a.handleAddUserCancel.bind(Object(b.a)(a)),a.state={columns:[{title:"ID",dataIndex:"ID",key:"ID",className:"small_font",render:function(e){return l.a.createElement(da,{ellipsis:!0},e)}},{title:"\u7528\u6237\u540d",dataIndex:"username",key:"username",className:"small_font",render:function(e){return l.a.createElement(da,{ellipsis:!0},e)}},{title:"\u90ae\u7bb1",dataIndex:"email",key:"email",className:"small_font "+{columnStyle:ma},render:function(e){return l.a.createElement(da,{ellipsis:!0},e)}},{title:"\u804c\u4f4d",dataIndex:"position",key:"position",className:"small_font "+{columnStyle:ma},render:function(e){return l.a.createElement(da,{ellipsis:!0},e)}},{title:"\u72b6\u6001",dataIndex:"active",key:"active",className:"small_font "+{columnStyle:ma},width:100,render:function(e){return!0===e?l.a.createElement(da,{ellipsis:!0},l.a.createElement(Zt.a,{color:"geekblue"},"\u6b63\u5e38")):l.a.createElement(da,{ellipsis:!0},l.a.createElement(Zt.a,{color:"red"},"\u7981\u7528"))}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:140,align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"primary",size:"small",onClick:a.updateUserActiveStatus.bind(Object(b.a)(a),t.email,!0)},"\u542f\u7528"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"danger",size:"small",onClick:a.updateUserActiveStatus.bind(Object(b.a)(a),t.email,!1)},"\u7981\u7528"))}}],tableData:[],tableLoading:!1,add_new_account_visible:!1,current_data_id:null,current_user:{},detailDrawerVisible:!1,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},userModalVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData()}},{key:"handleAdd",value:function(){this.setState({userModalVisible:!0})}},{key:"handleAddUserSubmit",value:function(){var e=this;this.addUserFormRef.props.form.validateFields(function(t,a){var n;t||(n=Object(fe.a)({},a),P("user/create",n)).then(function(t){0===t.code?(e.setState({userModalVisible:!1}),e.refreshTableData()):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleAddUserCancel",value:function(){this.setState({userModalVisible:!1})}},{key:"updateUserActiveStatus",value:function(e,t){var a,n=this;(a={email:e,active:t},z("user/active",a)).then(function(e){0===e.code?(O.a.success("\u64cd\u4f5c\u6210\u529f\uff01"),n.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e=this;return l.a.createElement(ua,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u6743\u9650\u7ba1\u7406","\u7528\u6237\u7ba1\u7406","\u7528\u6237\u5217\u8868"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},icon:"plus-circle",onClick:this.handleAdd},"\u65b0 \u589e"))),l.a.createElement(ha,{wrappedComponentRef:function(t){return e.addUserFormRef=t},userModalVisible:this.state.userModalVisible,handleAddUserSubmit:this.handleAddUserSubmit,handleAddUserCancel:this.handleAddUserCancel}),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",size:"small"}))}}]),t}(r.Component),fa=pa=S.a.create({name:"userManager"})(pa),ga=(a(1357),a(167)),ba=function(e){return V("roles/deleteRole",e)},ya=function(e){return V("roles/authLink",e)},Ea=function(e,t){return R("roles/list",{page:e,size:t})},va=function(e,t){return R("roles/resources",{roleId:e,resourceType:t})},Sa=function(e,t){return R("permissions/list",{page:e,size:t})},ka=g.a.Content,Ca=E.a.confirm,Ia=ve.a.TabPane,Da={overFlow:"hidden",textOverflow:"ellipsis",display:"-webkit-box"},Oa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:6},wrapperCol:{span:14}},a=this.props.roleActionType,n="\u65b0\u5efa\u89d2\u8272";return n="add"===a?"\u65b0\u5efa\u89d2\u8272":"\u7f16\u8f91\u89d2\u8272",l.a.createElement(r.Fragment,null,l.a.createElement(E.a,{title:n,visible:this.props.roleModalVisible,onOk:"add"===a?this.props.handleAddRole:this.props.handleEditRole,onCancel:this.props.handleCancelAddRole,centered:!0,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u89d2\u8272\u540d\u79f0"}),e("roleName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}]})(l.a.createElement(x.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))),l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u89d2\u8272\u63cf\u8ff0"}),e("description",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0"}]})(l.a.createElement(x.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0"}))))))}}]),t}(r.Component);Oa=S.a.create({name:"add_role_modal"})(Oa);var xa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).filterOption=function(e,t){return t.username.indexOf(e)>-1},a.state={roleId:0,inGroupData:[],allGroupData:[],transferLodding:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.roleId;this.loadRoleUsersData(e)}},{key:"loadRoleUsersData",value:function(e){var t=this;this.setState({roleId:e,transferLodding:!0}),function(e){return R("roles/users",{roleId:e})}(e).then(function(e){if(0===e.code){var a=[],n=[];e.data.all.forEach(function(e){n.push({key:String(e.ID),id:String(e.ID),username:e.username,position:e.position})}),e.data.in.forEach(function(e){a.push(String(e.ID))}),t.setState({inGroupData:a,allGroupData:n,transferLodding:!1})}else O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleTransferChange",value:function(e,t,a){this.setState({inGroupData:e})}},{key:"handleConfirmUserManager",value:function(){var e,t=this;this.setState({transferLodding:!0}),(e={roleId:parseInt(this.state.roleId),userIdList:this.state.inGroupData},P("roles/users",e)).then(function(e){0===e.code?(t.setState({transferLodding:!1}),t.props.hideModal(),O.a.success("\u64cd\u4f5c\u6210\u529f")):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){return l.a.createElement(E.a,{title:"\u7ba1\u7406\u7528\u6237\u89d2\u8272 - "+this.props.currentRoleName,destroyOnClose:"true",visible:this.props.userManagerModalVisible,onOk:this.handleConfirmUserManager.bind(this),onCancel:this.props.handleCancelUserManager,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",centered:!0,width:680,style:{textAlign:"center"}},l.a.createElement(ce.a,{spinning:this.state.transferLodding},l.a.createElement(ga.a,{dataSource:this.state.allGroupData,showSearch:!0,locale:{itemUnit:"\u4eba",itemsUnit:"\u4eba",searchPlaceholder:"\u4f7f\u7528\u59d3\u540d\u641c\u7d22"},filterOption:this.filterOption,targetKeys:this.state.inGroupData,onChange:this.handleTransferChange.bind(this),render:function(e){return e.username+"-"+e.position},listStyle:{width:250,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]})))}}]),t}(r.Component),wa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).ecsFilterOption=function(e,t){return t.instance_name.indexOf(e)>-1||t.ip.indexOf(e)>-1},a.rdsFilterOption=function(e,t){return t.db_instance_description.indexOf(e)>-1||t.db_instance_id.indexOf(e)>-1},a.kvFilterOption=function(e,t){return t.instance_name.indexOf(e)>-1||t.connection_domain.indexOf(e)>-1},a.slbFilterOption=function(e,t){return t.load_balance_name.indexOf(e)>-1||t.address.indexOf(e)>-1},a.otherResFilterOption=function(e,t){return t.instance_name.indexOf(e)>-1||t.address.indexOf(e)>-1},a.handleTabClick=function(e){},a.handleConfirmRoleResourceManager=a.handleConfirmRoleResourceManager.bind(Object(b.a)(a)),a.state={roleId:0,tabSpinning:!1,ecsInGroupData:[],ecsAllGroupData:[],rdsInGroupData:[],rdsAllGroupData:[],kvInGroupData:[],kvAllGroupData:[],slbInGroupData:[],slbAllGroupData:[],otherAllGroupData:[],otherInGroupData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.roleId;this.setState({roleId:e}),this.loadRoleEcsData(e),this.loadRoleRdsData(e),this.loadRoleKvData(e),this.loadRoleSlbData(e),this.loadRoleOtherResData(e)}},{key:"loadRoleEcsData",value:function(e){var t=this;this.setState({ecsTransferLodding:!0});var a=[],n=[];va(e,"ecs").then(function(e){0===e.code?(e.data.all.forEach(function(e){a.push({key:String(e.ID),id:String(e.ID),instance_name:e.InstanceName,ip:e.InnerIpAddress+" "+e.PublicIpAddress})}),e.data.in.forEach(function(e){n.push(String(e.ID))}),t.setState({ecsAllGroupData:a,ecsInGroupData:n,ecsTransferLodding:!1})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"loadRoleRdsData",value:function(e){var t=this;this.setState({rdsTransferLodding:!0});var a=[],n=[];va(e,"rds").then(function(e){0===e.code?(e.data.all.forEach(function(e){a.push({key:String(e.ID),id:String(e.ID),db_instance_description:e.DBInstanceDescription,db_instance_id:e.DBInstanceId})}),e.data.in.forEach(function(e){n.push(String(e.ID))}),t.setState({rdsAllGroupData:a,rdsInGroupData:n,rdsTransferLodding:!1})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"loadRoleKvData",value:function(e){var t=this;this.setState({kvTransferLodding:!0});var a=[],n=[];va(e,"kv").then(function(e){0===e.code?(e.data.all.forEach(function(e){a.push({key:String(e.ID),id:String(e.ID),instance_name:e.InstanceName,connection_domain:e.ConnectionDomain})}),e.data.in.forEach(function(e){n.push(String(e.ID))}),t.setState({kvAllGroupData:a,kvInGroupData:n,kvTransferLodding:!1})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"loadRoleSlbData",value:function(e){var t=this;this.setState({slbTransferLodding:!0});var a=[],n=[];va(e,"slb").then(function(e){0===e.code?(e.data.all.forEach(function(e){a.push({key:String(e.ID),id:String(e.ID),load_balance_name:e.LoadBalancerName,address:e.Address})}),e.data.in.forEach(function(e){n.push(String(e.ID))}),t.setState({slbAllGroupData:a,slbInGroupData:n,slbTransferLodding:!1})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"loadRoleOtherResData",value:function(e){var t=this;this.setState({otherResTransferLodding:!0});var a=[],n=[];va(e,"other").then(function(e){0===e.code?(e.data.all.forEach(function(e){a.push({key:String(e.ID),id:String(e.ID),instance_name:e.InstanceName,res_type:e.ResType})}),e.data.in.forEach(function(e){n.push(String(e.ID))}),t.setState({otherAllGroupData:a,otherInGroupData:n,otherResTransferLodding:!1})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleResTransferChange",value:function(e,t){switch(e){case"ecs":this.setState({ecsInGroupData:t});break;case"rds":this.setState({rdsInGroupData:t});break;case"kv":this.setState({kvInGroupData:t});break;case"slb":this.setState({slbInGroupData:t});break;case"other":this.setState({otherInGroupData:t})}}},{key:"handleConfirmRoleResourceManager",value:function(){var e,t=this;this.setState({tabSpinning:!0}),(e={roleId:parseInt(this.state.roleId),ecsIdList:this.state.ecsInGroupData,rdsIdList:this.state.rdsInGroupData,kvIdList:this.state.kvInGroupData,slbIdList:this.state.slbInGroupData,otherIdList:this.state.otherInGroupData},P("roles/resources",e)).then(function(e){0===e.code?(t.setState({tabSpinning:!1}),t.props.hideModal(),O.a.success("\u64cd\u4f5c\u6210\u529f")):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){return l.a.createElement(E.a,{title:"\u7ba1\u7406\u89d2\u8272\u7ec4\u5173\u8054\u8d44\u6e90 - "+this.props.currentRoleName,destroyOnClose:"true",visible:this.props.resourceManagerModalVisible,onOk:this.handleConfirmRoleResourceManager,onCancel:this.props.handleCancelResourceManager,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",centered:!0,width:1e3,style:{textAlign:"center"}},l.a.createElement(ce.a,{spinning:this.state.tabSpinning,tip:"\u8bf7\u6c42\u5904\u7406\u4e2d..."},l.a.createElement(ve.a,{defaultActiveKey:"ecs",tabPosition:"left",onTabClick:this.handleTabClick.bind(this)},l.a.createElement(Ia,{tab:"\u4e91\u670d\u52a1\u5668",key:"ecs"},l.a.createElement(ce.a,{spinning:this.state.ecsTransferLodding},l.a.createElement(ga.a,{showSearch:!0,locale:{itemUnit:"\u53f0",itemsUnit:"\u53f0",searchPlaceholder:"\u4f7f\u7528ip\u6216\u673a\u5668\u540d\u79f0\u641c\u7d22"},filterOption:this.ecsFilterOption,dataSource:this.state.ecsAllGroupData,targetKeys:this.state.ecsInGroupData,onChange:this.handleResTransferChange.bind(this,"ecs"),render:function(e){return e.ip+" "+e.instance_name},listStyle:{width:350,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]}))),l.a.createElement(Ia,{tab:"\u4e91\u6570\u636e\u5e93",key:"rds"},l.a.createElement(ce.a,{spinning:this.state.rdsTransferLodding},l.a.createElement(ga.a,{showSearch:!0,locale:{itemUnit:"\u53f0",itemsUnit:"\u53f0",searchPlaceholder:"\u4f7f\u7528\u8fde\u63a5\u4e32\u6216\u540d\u79f0\u641c\u7d22"},filterOption:this.rdsFilterOption,dataSource:this.state.rdsAllGroupData,targetKeys:this.state.rdsInGroupData,onChange:this.handleResTransferChange.bind(this,"rds"),render:function(e){return e.db_instance_description+" "+e.db_instance_id},listStyle:{width:350,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]}))),l.a.createElement(Ia,{tab:"KVStore",key:"kv"},l.a.createElement(ce.a,{spinning:this.state.kvTransferLodding},l.a.createElement(ga.a,{showSearch:!0,locale:{itemUnit:"\u53f0",itemsUnit:"\u53f0",searchPlaceholder:"\u4f7f\u7528\u8fde\u63a5\u4e32\u6216\u540d\u79f0\u641c\u7d22"},filterOption:this.kvFilterOption,dataSource:this.state.kvAllGroupData,targetKeys:this.state.kvInGroupData,onChange:this.handleResTransferChange.bind(this,"kv"),render:function(e){return e.instance_name+" "+e.connection_domain},listStyle:{width:350,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]}))),l.a.createElement(Ia,{tab:"SLB",key:"slb"},l.a.createElement(ce.a,{spinning:this.state.slbTransferLodding},l.a.createElement(ga.a,{showSearch:!0,locale:{itemUnit:"\u4e2a",itemsUnit:"\u4e2a",searchPlaceholder:"\u4f7f\u7528ip\u6216\u540d\u79f0\u641c\u7d22"},filterOption:this.slbFilterOption,dataSource:this.state.slbAllGroupData,targetKeys:this.state.slbInGroupData,onChange:this.handleResTransferChange.bind(this,"slb"),render:function(e){return e.load_balance_name+" "+e.address},listStyle:{width:350,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]}))),l.a.createElement(Ia,{tab:"\u5176\u5b83\u8d44\u6e90",key:"other"},l.a.createElement(ce.a,{spinning:this.state.otherResTransferLodding},l.a.createElement(ga.a,{showSearch:!0,locale:{itemUnit:"\u4e2a",itemsUnit:"\u4e2a",searchPlaceholder:"\u4f7f\u7528\u5b9e\u4f8b\u540d\u79f0\u641c\u7d22"},filterOption:this.otherResFilterOption,dataSource:this.state.otherAllGroupData,targetKeys:this.state.otherInGroupData,onChange:this.handleResTransferChange.bind(this,"other"),render:function(e){return e.res_type+" "+e.instance_name},listStyle:{width:350,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]}))))))}}]),t}(r.Component),ja=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).filterOption=function(e,t){return t.name.indexOf(e)>-1||t.url_path.indexOf(e)>-1},a.state={roleId:0,inGroupData:[],allGroupData:[],transferLodding:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.roleId;this.loadRoleAuthLinksData(e)}},{key:"loadRoleAuthLinksData",value:function(e){var t=this;this.setState({roleId:e,transferLodding:!0}),function(e){return R("roles/authLink",{roleId:e})}(e).then(function(e){if(0===e.code){var a=[],n=[];e.data.all.forEach(function(e){n.push({key:String(e.Id),id:String(e.Id),name:e.name,url_path:e.urlPath})}),e.data.in.forEach(function(e){a.push(String(e.Id))}),t.setState({inGroupData:a,allGroupData:n,transferLodding:!1})}else O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleTransferChange",value:function(e,t,a){this.setState({inGroupData:e})}},{key:"handleConfirmUserManager",value:function(){var e,t=this;this.setState({transferLodding:!0}),(e={roleId:parseInt(this.state.roleId),authLinkIdList:this.state.inGroupData},P("roles/authLinks",e)).then(function(e){0===e.code?(t.setState({transferLodding:!1}),t.props.hideModal(),O.a.success("\u64cd\u4f5c\u6210\u529f")):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){return l.a.createElement(E.a,{title:"\u7ba1\u7406\u89d2\u8272\u5bf9\u5e94\u6743\u9650 - "+this.props.currentRoleName,destroyOnClose:"true",visible:this.props.authLinkManagerModalVisible,onOk:this.handleConfirmUserManager.bind(this),onCancel:this.props.handleCancelAuthLinkManager,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",centered:!0,width:680,style:{textAlign:"center"}},l.a.createElement(ce.a,{spinning:this.state.transferLodding},l.a.createElement(ga.a,{dataSource:this.state.allGroupData,showSearch:!0,locale:{itemUnit:"\u6761",itemsUnit:"\u6761",searchPlaceholder:"\u4f7f\u7528\u540d\u79f0\u6216\u8def\u5f84\u641c\u7d22"},filterOption:this.filterOption,targetKeys:this.state.inGroupData,onChange:this.handleTransferChange.bind(this),render:function(e){return e.name+" "+e.url_path},listStyle:{width:250,height:"60vh",textAlign:"left"},operations:["\u52a0\u5165\u89d2\u8272\u7ec4","\u79fb\u51fa\u89d2\u8272\u7ec4"]})))}}]),t}(r.Component),Ta=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).managerUser=function(e){a.setState({roleId:e.Id,userManagerModalVisible:!0,currentRoleName:e.name})},a.confirmDeleteRole=function(e){var t=Object(b.a)(a);Ca({title:"\u5371\u9669\u64cd\u4f5c\u63d0\u793a",content:"\u5220\u9664\u8be5\u89d2\u8272\u7ec4\u65f6\u8be5\u89d2\u8272\u7ec4\u548c\u4e0e\u4e4b\u7ed1\u5b9a\u7684\u6240\u6709\u7528\u6237\u7684\u5173\u7cfb\u3001\u6240\u6709\u8d44\u6e90\u7684\u5173\u7cfb\u548c\u6743\u9650\u94fe\u63a5\u7684\u5173\u7cfb\u4e5f\u4f1a\u88ab\u5220\u9664\uff0c\u8bf7\u8c28\u614e\u64cd\u4f5c\uff01",okText:"\u786e\u8ba4\u5220\u9664",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){ba({id:e.Id}).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),t.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})},onCancel:function(){}})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.managerResource=function(e){a.setState(function(){return{roleId:e.Id,resourceManagerModalVisible:!0,currentRoleName:e.name}})},a.managerAuthLink=function(e){a.setState(function(){return{roleId:e.Id,authLinkManagerModalVisible:!0,currentRoleName:e.name}})},a.refreshTableData=function(){a.setState({tableLoading:!0}),Ea(a.state.pagination.page,a.state.pagination.pageSize).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.roles,r=[],l=0;l<n.length;l++)r.push({key:n[l].Id,Id:n[l].Id,name:n[l].name,description:n[l].description});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.handleAddRole=a.handleAddRole.bind(Object(b.a)(a)),a.handleEditRole=a.handleEditRole.bind(Object(b.a)(a)),a.handleCancelAddRole=a.handleCancelAddRole.bind(Object(b.a)(a)),a.createRole=a.createRole.bind(Object(b.a)(a)),a.roleEdit=a.roleEdit.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.state={columns:[{title:"ID",dataIndex:"Id",key:"Id",width:30,className:"small_font"},{title:"\u89d2\u8272\u540d",dataIndex:"name",key:"name",width:160,className:"small_font"},{title:"\u89d2\u8272\u63cf\u8ff0",dataIndex:"description",key:"description",className:"small_font "+{columnStyle:Da},width:160},{},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:430,align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{size:"small",onClick:a.managerUser.bind(Object(b.a)(a),t)},"\u7ba1\u7406\u7528\u6237"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{size:"small",onClick:a.managerAuthLink.bind(Object(b.a)(a),t)},"\u7ba1\u7406\u6743\u9650"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{size:"small",onClick:a.managerResource.bind(Object(b.a)(a),t)},"\u7ba1\u7406\u8d44\u6e90"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"info",size:"small",onClick:a.roleEdit.bind(Object(b.a)(a),t)},"\u7f16\u8f91"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"danger",size:"small",onClick:a.confirmDeleteRole.bind(Object(b.a)(a),t)},"\u5220\u9664"))}}],tableData:[],tableLoading:!1,roleModalVisible:!1,roleActionType:"add",editRoleId:0,userManagerModalVisible:!1,resourceManagerModalVisible:!1,authLinkManagerModalVisible:!1,current_data_id:null,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"createRole",value:function(){this.setState(function(){return{roleActionType:"add",roleModalVisible:!0}})}},{key:"roleEdit",value:function(e){this.roleModal.setFieldsValue({roleName:e.name,description:e.description}),this.setState(function(){return{roleActionType:"update",roleModalVisible:!0,editRoleId:e.Id}})}},{key:"handleAddRole",value:function(){var e=this,t=this.roleModal;t.validateFields(function(a,n){var r;a||(r=n,P("roles/addRole",r)).then(function(a){0===a.code?(O.a.success("\u521b\u5efa\u6210\u529f"),e.setState({roleModalVisible:!1}),t.resetFields(),e.refreshTableData()):(t.setFields({roleName:{errors:[new Error(a.msg)]}}),O.a.error(a.msg))}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleEditRole",value:function(){var e=this,t=this.roleModal;t.validateFields(function(a,n){var r;a||(r=Object(fe.a)({},n,{id:e.state.editRoleId}),z("roles/updateRole",r)).then(function(a){0===a.code?(O.a.success("\u4fee\u6539\u6210\u529f"),e.setState({roleModalVisible:!1}),t.resetFields(),e.refreshTableData()):(t.setFields({roleName:{errors:[new Error(a.msg)]}}),O.a.error(a.msg))}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handleCancelAddRole",value:function(){this.roleModal.resetFields(),this.setState(function(){return{roleModalVisible:!1,userManagerModalVisible:!1,resourceManagerModalVisible:!1,authLinkManagerModalVisible:!1}})}},{key:"componentDidMount",value:function(){this.refreshTableData()}},{key:"render",value:function(){var e=this;return l.a.createElement(ka,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u6743\u9650\u7ba1\u7406","\u89d2\u8272\u7ba1\u7406","\u89d2\u8272\u5217\u8868"]}),l.a.createElement("div",{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(ee.a,null,l.a.createElement(te.a,null,l.a.createElement(Z.a,{type:"primary",onClick:this.createRole},"\u65b0\u5efa\u89d2\u8272")))),l.a.createElement(Oa,{ref:function(t){e.roleModal=t},roleModalVisible:this.state.roleModalVisible,roleActionType:this.state.roleActionType,handleAddRole:this.handleAddRole,handleEditRole:this.handleEditRole,handleCancelAddRole:this.handleCancelAddRole}),this.state.userManagerModalVisible?l.a.createElement(xa,{roleId:this.state.roleId,userManagerModalVisible:this.state.userManagerModalVisible,currentRoleName:this.state.currentRoleName,hideModal:function(){e.setState({userManagerModalVisible:!1})},handleCancelUserManager:this.handleCancelAddRole.bind(this)}):"",this.state.resourceManagerModalVisible?l.a.createElement(wa,{roleId:this.state.roleId,resourceManagerModalVisible:this.state.resourceManagerModalVisible,currentRoleName:this.state.currentRoleName,hideModal:function(){e.setState({resourceManagerModalVisible:!1})},handleCancelResourceManager:this.handleCancelAddRole.bind(this)}):"",this.state.authLinkManagerModalVisible?l.a.createElement(ja,{roleId:this.state.roleId,authLinkManagerModalVisible:this.state.authLinkManagerModalVisible,currentRoleName:this.state.currentRoleName,hideModal:function(){e.setState({authLinkManagerModalVisible:!1})},handleCancelAuthLinkManager:this.handleCancelAddRole.bind(this)}):"",l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",size:"small"}))}}]),t}(r.Component),_a=Ta=S.a.create({name:"rolesManager"})(Ta),Ma=g.a.Content,La={overFlow:"hidden",textOverflow:"ellipsis",display:"-webkit-box"},Aa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleAddAuthLink=a.handleAddAuthLink.bind(Object(b.a)(a)),a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleAddAuthLink",value:function(){var e=this,t=this.props,a=t.form,n=t.hideModal;a.validateFields(function(t,r){var l;t||(l=r,P("roles/authLink",l)).then(function(t){0===t.code?(O.a.success("\u521b\u5efa\u6210\u529f"),n(),e.props.refreshTableData()):(a.setFields({name:{errors:[new Error(t.msg)]}}),O.a.error(t.msg))}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:6},wrapperCol:{span:14}};return l.a.createElement(r.Fragment,null,l.a.createElement(E.a,{title:"\u65b0\u5efa\u6743\u9650\u94fe\u63a5",destroyOnClose:"true",visible:this.props.authLinkModalVisible,onOk:this.handleAddAuthLink,onCancel:this.props.handleCancelAddAuthLink,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(S.a,{ref:!0},l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u6743\u9650\u540d\u79f0"}),e("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8def\u5f84\u6743\u9650\u540d\u79f0"}]})(l.a.createElement(x.a,{placeholder:"\u8bf7\u8f93\u5165\u8def\u5f84\u6743\u9650\u540d\u79f0"}))),l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u6743\u9650\u63cf\u8ff0"}),e("description",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6743\u9650\u63cf\u8ff0"}]})(l.a.createElement(x.a,{placeholder:"\u8bf7\u8f93\u5165\u6743\u9650\u63cf\u8ff0"}))),l.a.createElement(S.a.Item,Object.assign({},t,{label:"\u6743\u9650URI\u8def\u5f84"}),e("path",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6743\u9650URI\u8def\u5f84"}]})(l.a.createElement(x.a,{placeholder:"\u8bf7\u8f93\u5165\u6743\u9650URI\u8def\u5f84"}))))))}}]),t}(r.Component);Aa=S.a.create({name:"add_auth_link"})(Aa);var Na=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).confirmDeleteAuthLink=function(e){ya({id:e.Id}).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})},a.changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.refreshTableData=function(){a.setState({tableLoading:!0}),Sa(a.state.pagination.page,a.state.pagination.pageSize).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.permissions,r=[],l=0;l<n.length;l++)r.push({Id:n[l].Id,name:n[l].name,description:n[l].description,urlPath:n[l].urlPath});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.refreshTableData=a.refreshTableData.bind(Object(b.a)(a)),a.createAuthLink=a.createAuthLink.bind(Object(b.a)(a)),a.handleCancelAddAuthLink=a.handleCancelAddAuthLink.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.state={columns:[{title:"ID",dataIndex:"Id",key:"Id",width:60,className:"small_font"},{title:"\u6743\u9650\u540d\u79f0",dataIndex:"name",key:"name",width:200,className:"small_font"},{title:"\u6743\u9650\u63cf\u8ff0",dataIndex:"description",key:"description",className:"small_font "+{columnStyle:La},width:260},{title:"\u6743\u9650\u8def\u5f84",dataIndex:"urlPath",key:"urlPath",className:"small_font "+{columnStyle:La},width:360},{},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:60,align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9\u5417?",onConfirm:a.confirmDeleteAuthLink.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664")))}}],tableData:[],tableLoading:!1,authLinkModalVisible:!1,current_data_id:null,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData()}},{key:"createAuthLink",value:function(){this.setState({authLinkModalVisible:!0})}},{key:"handleCancelAddAuthLink",value:function(){this.setState({authLinkModalVisible:!1})}},{key:"render",value:function(){var e=this;return l.a.createElement(Ma,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u6743\u9650\u7ba1\u7406","\u94fe\u63a5\u6743\u9650","\u6743\u9650\u94fe\u63a5\u5217\u8868"]}),l.a.createElement("div",{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(ee.a,null,l.a.createElement(te.a,null,l.a.createElement(Z.a,{type:"primary",onClick:this.createAuthLink},"\u65b0\u5efa\u6743\u9650\u94fe\u63a5")))),l.a.createElement(Aa,{authLinkModalVisible:this.state.authLinkModalVisible,refreshTableData:this.refreshTableData,hideModal:function(){e.setState({authLinkModalVisible:!1})},handleCancelAddAuthLink:this.handleCancelAddAuthLink}),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",size:"small"}))}}]),t}(r.Component),Ra=Na=S.a.create({name:"permissionsManager"})(Na),Pa=g.a.Content,za=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).compareToFirstPassword=function(e,t,n){var r=a.props.form;t&&t!==r.getFieldValue("password")?n("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4!"):n()},a.updatePassword=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var a={password:t.password,confirm_password:t.confirm_password};F(a).then(function(e){0===e.code&&O.a.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f!")}).catch(function(e){console.log(e)})}})},a.setState({}),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:2},wrapperCol:{span:6}};return l.a.createElement(Pa,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(S.a,{onSubmit:this.updatePassword},l.a.createElement(S.a.Item,Object.assign({label:"\u65b0\u5bc6\u7801",hasFeedback:!0},t),e("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u786e\u8ba4\u5bc6\u7801",hasFeedback:!0},t),e("confirm_password",{rules:[{required:!0,message:"\u8bf7\u786e\u8ba4\u65b0\u5bc6\u7801"},{validator:this.compareToFirstPassword}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({},t,{style:{textAlign:"center"}}),l.a.createElement(Z.a,{type:"primary",htmlType:"submit"},"\u786e \u8ba4"))))}}]),t}(r.Component),Va=za=S.a.create({name:"passwordManagerForm"})(za),Ba=(a(1360),a(241)),Fa=a(82),Ya=g.a.Content,qa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).syncAliyunEcs=a.syncAliyunEcs.bind(Object(b.a)(a)),a.syncAliyunRds=a.syncAliyunRds.bind(Object(b.a)(a)),a.syncAliyunKv=a.syncAliyunKv.bind(Object(b.a)(a)),a.syncAliyunSlb=a.syncAliyunSlb.bind(Object(b.a)(a)),a.state={syncEcsLoading:!1,syncRdsLoading:!1,syncKvLoading:!1,syncSlbLoading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.syncAliyunStatisData()}},{key:"syncAliyunStatisData",value:function(){var e=this;R("/data/syncAliyunStatisData").then(function(t){0===t.code?e.setState({ecsCount:t.data.ecsCount,rdsCount:t.data.rdsCount,kvCount:t.data.kvCount,slbCount:t.data.slbCount}):O.a.error("\u83b7\u53d6\u9489\u9489\u7edf\u8ba1\u6570\u636e\u5f02\u5e38")}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"syncAliyunEcs",value:function(){var e,t=this;this.setState(Object(Fa.a)({},"syncEcsLoading",!0)),R("/data/syncAliyunEcs",e,9e4).then(function(e){0===e.code?(O.a.success("\u540c\u6b65\u6570\u636e\u6210\u529f"),t.setState(Object(Fa.a)({},"syncEcsLoading",!1)),t.syncAliyunStatisData()):(O.a.error(e.msg),t.setState(Object(Fa.a)({},"syncEcsLoading",!1)))}).catch(function(e){O.a.error(e.toLocaleString()),t.setState(Object(Fa.a)({},"syncEcsLoading",!1))})}},{key:"syncAliyunRds",value:function(){var e,t=this;this.setState(Object(Fa.a)({},"syncRdsLoading",!0)),R("/data/syncAliyunRds",e,9e4).then(function(e){0===e.code?(O.a.success("\u540c\u6b65\u6570\u636e\u6210\u529f"),t.setState(Object(Fa.a)({},"syncRdsLoading",!1)),t.syncAliyunStatisData()):(O.a.error(e.msg),t.setState(Object(Fa.a)({},"syncRdsLoading",!1)))}).catch(function(e){O.a.error(e.toLocaleString()),t.setState(Object(Fa.a)({},"syncRdsLoading",!1))})}},{key:"syncAliyunKv",value:function(){var e=this;this.setState(Object(Fa.a)({},"syncKvLoading",!0)),R("/data/syncAliyunKv",{},9e4).then(function(t){0===t.code?(O.a.success("\u540c\u6b65\u6570\u636e\u6210\u529f"),e.setState(Object(Fa.a)({},"syncKvLoading",!1)),e.syncAliyunStatisData()):(O.a.error(t.msg),e.setState(Object(Fa.a)({},"syncKvLoading",!1)))}).catch(function(t){O.a.error(t.toLocaleString()),e.setState(Object(Fa.a)({},"syncKvLoading",!1))})}},{key:"syncAliyunSlb",value:function(){var e=this;this.setState(Object(Fa.a)({},"syncSlbLoading",!0)),R("/data/syncAliyunSlb",{},9e4).then(function(t){0===t.code?(O.a.success("\u540c\u6b65\u6570\u636e\u6210\u529f"),e.setState(Object(Fa.a)({},"syncSlbLoading",!1)),e.syncAliyunStatisData()):(O.a.error(t.msg),e.setState(Object(Fa.a)({},"syncSlbLoading",!1)))}).catch(function(t){O.a.error(t.toLocaleString()),e.setState(Object(Fa.a)({},"syncSlbLoading",!1))})}},{key:"render",value:function(){return l.a.createElement(Ya,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u6570\u636e\u7ba1\u7406","\u963f\u91cc\u4e91\u6570\u636e"]}),l.a.createElement("div",{style:{marginBottom:20}},l.a.createElement(Nt.a,{size:"small",title:"\u5e73\u53f0\u6570\u636e\u603b\u89c8"},l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:5},l.a.createElement(Ba.a,{title:"ECS\u603b\u6570",value:this.state.ecsCount,precision:0}),l.a.createElement(Z.a,{style:{marginTop:16},type:"primary",loading:this.state.syncEcsLoading,onClick:this.syncAliyunEcs},"\u540c\u6b65\u5e73\u53f0\u6570\u636e")),l.a.createElement(te.a,{span:5},l.a.createElement(Ba.a,{title:"RDS\u603b\u6570",value:this.state.rdsCount,precision:0}),l.a.createElement(Z.a,{style:{marginTop:16},type:"primary",loading:this.state.syncRdsLoading,onClick:this.syncAliyunRds},"\u540c\u6b65\u5e73\u53f0\u6570\u636e")),l.a.createElement(te.a,{span:5},l.a.createElement(Ba.a,{title:"Redis\u603b\u6570",value:this.state.kvCount,precision:0}),l.a.createElement(Z.a,{style:{marginTop:16},type:"primary",loading:this.state.syncKvLoading,onClick:this.syncAliyunKv},"\u540c\u6b65\u5e73\u53f0\u6570\u636e")),l.a.createElement(te.a,{span:5},l.a.createElement(Ba.a,{title:"SLB\u603b\u6570",value:this.state.slbCount,precision:0}),l.a.createElement(Z.a,{style:{marginTop:16},type:"primary",loading:this.state.syncSlbLoading,onClick:this.syncAliyunSlb},"\u540c\u6b65\u5e73\u53f0\u6570\u636e"))))))}}]),t}(r.Component),Ka=ye.a.Option,Ha=Ee.a.Text,Ja=Ee.a.Paragraph,Ua=g.a.Content,Ga=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).switchChange=a.switchChange.bind(Object(b.a)(a)),a.state={sitesData:[],renewSwitch:!0,cloudAccountList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadCloudAccountData()}},{key:"loadCloudAccountData",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"switchChange",value:function(e){this.setState({renewSwitch:e})}},{key:"render",value:function(){var e,t=this.props.form.getFieldDecorator,a={labelCol:{span:6},wrapperCol:{span:17}};e=this.state.cloudAccountList.map(function(e){return l.a.createElement(Ka,{key:e.id,value:e.id},e.accountName)});var n="\u65b0\u589e";return"update"===this.props.actionType&&(n="\u7f16\u8f91"),l.a.createElement(E.a,{title:n+" - \u8d44\u6e90\u4fe1\u606f",destroyOnClose:!0,visible:this.props.server_info_modal_visible,onOk:this.props.handlePostServerInfoSubmit,onCancel:this.props.handlePostServerInfoCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",centered:!0,width:1e3},l.a.createElement(S.a,null,l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"\u8d44\u6e90\u7c7b\u578b"},a),t("resType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d44\u6e90\u7c7b\u578b"}]})(l.a.createElement(ye.a,null,l.a.createElement(Ka,{value:"MongoDB"},"MongoDB"),l.a.createElement(Ka,{value:"MaxCompute"},"MaxCompute"),l.a.createElement(Ka,{value:"SSL"},"SSL"),l.a.createElement(Ka,{value:"\u5e26\u5bbd"},"\u5e26\u5bbd"),l.a.createElement(Ka,{value:"\u540e\u4ed8\u8d39"},"\u540e\u4ed8\u8d39"),l.a.createElement(Ka,{value:"\u5f39\u6027IP"},"\u5f39\u6027IP"),l.a.createElement(Ka,{value:"Memcached"},"Memcached"),l.a.createElement(Ka,{value:"Kafka"},"Kafka"),l.a.createElement(Ka,{value:"NAS"},"NAS"),l.a.createElement(Ka,{value:"PolarDB"},"PolarDB"),l.a.createElement(Ka,{value:"HBase"},"HBase"))))),l.a.createElement(te.a,{span:11},l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8bID"},a),t("instanceId",{rules:[{}]})(l.a.createElement(x.a,null))))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"\u5b9e\u4f8b\u540d\u79f0"},a),t("instanceName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b9e\u4f8b\u540d\u79f0"}]})(l.a.createElement(x.a,null)))),l.a.createElement(te.a,{span:11},l.a.createElement(S.a.Item,Object.assign({label:"\u8fde\u63a5\u5730\u5740"},a),t("connections",{rules:[{}]})(l.a.createElement(x.a,null))))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"\u533a\u57df"},a),t("region",{rules:[{}]})(l.a.createElement(x.a,null)))),l.a.createElement(te.a,{span:11},l.a.createElement(S.a.Item,Object.assign({label:"Engine"},a),t("engine",{rules:[{}]})(l.a.createElement(x.a,null))))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"CPU"},a),t("cpu",{rules:[{}]})(l.a.createElement(x.a,null)))),l.a.createElement(te.a,{span:11},l.a.createElement(S.a.Item,Object.assign({label:"\u78c1\u76d8"},a),t("disk",{rules:[{}]})(l.a.createElement(x.a,null))))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"\u5185\u5b58"},a),t("memory",{rules:[{}]})(l.a.createElement(x.a,null)))),l.a.createElement(te.a,{span:11},l.a.createElement(S.a.Item,Object.assign({label:"\u5e26\u5bbd"},a),t("bandwidth",{rules:[{}]})(l.a.createElement(x.a,null))))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"\u521b\u5efa\u65f6\u95f4"},a),t("createTime",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u521b\u5efa\u65f6\u95f4"}]})(l.a.createElement(ge.a,{format:"YYYY-MM-DD",style:{width:"100%"}})))),l.a.createElement(te.a,{span:11},l.a.createElement(S.a.Item,Object.assign({label:"\u8fc7\u671f\u65f6\u95f4"},a),t("expiredTime",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8fc7\u671f\u65f6\u95f4"}]})(l.a.createElement(ge.a,{format:"YYYY-MM-DD",style:{width:"100%"}}))))),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:11,offset:1},l.a.createElement(S.a.Item,Object.assign({label:"\u4e91\u8d26\u53f7"},a),t("cloudAccountId",{})(l.a.createElement(ye.a,null,e)))))))}}]),t}(r.Component);Ga=S.a.create({name:"OtherInfoModal"})(Ga);var Qa,Wa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.refreshTableData=function(){a.setState({tableLoading:!0});var e={page:a.state.pagination.page,size:a.state.pagination.pageSize,queryKeyword:a.state.queryKeyword,queryResType:a.state.queryResType,queryExpiredTime:null===a.state.queryExpiredTime?null:a.state.queryExpiredTime.format("YYYY-MM-DD HH:mm:ss"),queryCloudAccount:a.state.queryCloudAccount};Ke(e).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:Object(fe.a)({},t)});for(var n=e.data.otherRes,r=[],l=0;l<n.length;l++)r.push({key:n[l].ID,ID:n[l].ID,CloudAccountId:n[l].CloudAccountId,CloudAccountName:n[l].CloudAccountName,ResType:n[l].ResType,InstanceId:n[l].InstanceId,InstanceName:n[l].InstanceName,Connections:n[l].Connections,Region:n[l].Region,Engine:n[l].Engine,Cpu:n[l].Cpu,Bandwidth:n[l].Bandwidth,RenewStatus:n[l].RenewStatus,RenewSiteId:n[l].RenewSiteId,BankAccount:n[l].BankAccount,CreateTime:xe()(n[l].CreateTime).format("YYYY-MM-DD"),ExpiredTime:xe()(n[l].ExpiredTime).format("YYYY-MM-DD")});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){O.a.error(e)})},a.onExpiredDateChange=function(e){null==e?a.setState({queryExpiredTime:null}):a.setState({queryExpiredTime:e})},a.handleManageUserChange=function(e){a.setState({queryManageUser:e})},a.handleBatchUpdate=function(){var e=a.state.selectedRowKeys;0!==e.length?a.setState({extraInfoModalVisible:!0,updateMode:"batch",idsList:e}):O.a.warn("\u8bf7\u5148\u9009\u62e9\u6570\u636e")},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.keywordOnChange=a.keywordOnChange.bind(Object(b.a)(a)),a.handleQuery=a.handleQuery.bind(Object(b.a)(a)),a.handlePostOtherInfoSubmit=a.handlePostOtherInfoSubmit.bind(Object(b.a)(a)),a.handlePostOtherInfoCancel=a.handlePostOtherInfoCancel.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.changePage=a.changePage.bind(Object(b.a)(a)),a.handleAdd=a.handleAdd.bind(Object(b.a)(a)),a.handleResTypeChange=a.handleResTypeChange.bind(Object(b.a)(a)),a.handleCloudAccountChange=a.handleCloudAccountChange.bind(Object(b.a)(a)),a.state={columns:[{title:"Id",dataIndex:"ID",key:"ID",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u8d44\u6e90\u7c7b\u578b",dataIndex:"ResType",key:"ResType",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8b\u540d\u79f0",dataIndex:"InstanceName",key:"InstanceName",className:"small_font",render:function(e){return l.a.createElement(pe.a,{title:e},l.a.createElement(Ha,{ellipsis:!0},e))}},{title:"\u4e91\u8d26\u53f7",dataIndex:"CloudAccountName",key:"CloudAccountName",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u5b9e\u4f8bid",dataIndex:"InstanceId",key:"InstanceId",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u8bbf\u95ee\u5730\u5740",dataIndex:"Connections",key:"Connections",className:"small_font",render:function(e){return l.a.createElement(Ja,{style:{marginBottom:0},copyable:""!==e},e)}},{title:"Region",dataIndex:"Region",key:"Region",className:"small_font",render:function(e){return l.a.createElement(Ha,null,e)}},{title:"Engine",dataIndex:"Engine",key:"Engine",className:"small_font",render:function(e){return l.a.createElement(Ha,null,e)}},{title:"Cpu",dataIndex:"Cpu",key:"Cpu",className:"small_font",render:function(e){return l.a.createElement(Ha,null,e)}},{title:"\u5e26\u5bbd",dataIndex:"Bandwidth",key:"Bandwidth",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"CreateTime",key:"CreateTime",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u8fc7\u671f\u65f6\u95f4",dataIndex:"ExpiredTime",key:"ExpiredTime",className:"small_font",render:function(e){return l.a.createElement(Ha,{ellipsis:!0},e)}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",align:"center",className:"small_font",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"info",size:"small",onClick:a.serverEdit.bind(Object(b.a)(a),t)},"\u7f16\u8f91"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(de.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u9879\u5185\u5bb9?",onConfirm:a.serverDelete.bind(Object(b.a)(a),t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},l.a.createElement(Z.a,{type:"danger",size:"small"},"\u5220\u9664")))}}],tableLoading:!1,tableData:[],pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}},actionType:"add",editId:0,extraInfoModalVisible:!1,other_info_modal_visible:!1,queryExpiredTime:null,queryKeyword:"",queryCloudAccount:"0",queryManageUser:"0",cloudAccountList:[],queryResType:"\u6240\u6709",selectedRowKeys:[],idsList:[],updateMode:"single"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refreshTableData(),this.loadCloudAccountsData()}},{key:"loadCloudAccountsData",value:function(){var e=this;Te(1,100).then(function(t){0===t.code?e.setState({cloudAccountList:t.data.accounts}):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"handleAdd",value:function(){this.setState({other_info_modal_visible:!0,actionType:"add",editId:0})}},{key:"handleQuery",value:function(){var e=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1})},function(){e.refreshTableData()})}},{key:"keywordOnChange",value:function(e){this.setState({queryKeyword:e.target.value})}},{key:"handleResTypeChange",value:function(e){this.setState({queryResType:e})}},{key:"handleCloudAccountChange",value:function(e){this.setState({queryCloudAccount:e})}},{key:"serverEdit",value:function(e){var t=this;this.setState({other_info_modal_visible:!0,editId:e.ID,actionType:"update",updateMode:"single"},function(){t.otherInfoFormRef.props.form.setFieldsValue({cloudAccountId:0!==e.CloudAccountId?e.CloudAccountId:null,resType:e.ResType,instanceId:e.InstanceId,instanceName:e.InstanceName,connections:e.Connections,region:e.Region,engine:e.Engine,cpu:e.Cpu,bandwidth:e.Bandwidth,createTime:""!==e.CreateTime?xe()(e.CreateTime,"YYYY-MM-DD"):void 0,expiredTime:""!==e.ExpiredTime?xe()(e.ExpiredTime,"YYYY-MM-DD"):void 0})})}},{key:"serverDelete",value:function(e){var t,a=this;(t=e.ID,V("cloud/other",{id:t})).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshTableData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handlePostOtherInfoSubmit",value:function(){var e=this;this.otherInfoFormRef.props.form.validateFields(function(t,a){var n;t||(n=Object(fe.a)({},a,{id:e.state.editId,createTime:a.createTime.format("YYYY-MM-DD"),expiredTime:void 0===a.expiredTime?void 0:a.expiredTime.format("YYYY-MM-DD")}),P("cloud/other",n)).then(function(t){0===t.code?("add"===e.state.actionType?O.a.success("\u6dfb\u52a0\u6210\u529f\uff0c\u8bf7\u5230\u6743\u9650\u7ba1\u7406\u4e2d\u589e\u52a0\u8bbf\u95ee\u6743\u9650\uff01"):O.a.success("\u7f16\u8f91\u6210\u529f"),e.setState({other_info_modal_visible:!1}),e.refreshTableData()):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"handlePostOtherInfoCancel",value:function(){this.setState({other_info_modal_visible:!1})}},{key:"handleExtraInfoOk",value:function(e){var t=this,a="";a="single"===this.state.updateMode?String(this.state.editId):this.state.idsList.join(","),function(e){return z("cloud/other",e)}(Object(fe.a)({},e,{id:a})).then(function(e){0===e.code?(O.a.success("\u4fee\u6539\u6210\u529f"),t.setState({extraInfoModalVisible:!1,selectedRowKeys:[]})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleExtraInfoCancel",value:function(e){this.setState({extraInfoModalVisible:!1})}},{key:"render",value:function(){var e=this,t={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return l.a.createElement(Ua,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u4e91\u8d44\u6e90","\u5176\u5b83\u8d44\u6e90","\u5176\u5b83\u8d44\u6e90\u6c47\u603b\u5217\u8868"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:4,className:"col-span"},l.a.createElement(ge.a,{style:{width:"100%"},defaultValue:this.state.queryExpiredTime,placeholder:"\u5230\u671f\u622a\u6b62\u65f6\u95f4",onChange:this.onExpiredDateChange})),l.a.createElement(te.a,{span:4,className:"col-span"},l.a.createElement(x.a,{placeholder:"\u8f93\u5165\u5b9e\u4f8bid/\u540d\u79f0/\u5730\u5740\u67e5\u8be2",value:this.state.queryKeyword,onChange:this.keywordOnChange})),l.a.createElement(te.a,{span:3,className:"col-span"},l.a.createElement(ye.a,{defaultValue:this.state.queryResType,style:{width:"100%"},onChange:this.handleResTypeChange},l.a.createElement(Ka,{value:"\u6240\u6709"},"\u6240\u6709"),l.a.createElement(Ka,{value:"MongoDB"},"MongoDB"),l.a.createElement(Ka,{value:"MaxCompute"},"MaxCompute"),l.a.createElement(Ka,{value:"SSL"},"SSL"),l.a.createElement(Ka,{value:"\u5e26\u5bbd"},"\u5e26\u5bbd"),l.a.createElement(Ka,{value:"\u540e\u4ed8\u8d39"},"\u540e\u4ed8\u8d39"),l.a.createElement(Ka,{value:"\u5f39\u6027IP"},"\u5f39\u6027IP"),l.a.createElement(Ka,{value:"Memcached"},"Memcached"),l.a.createElement(Ka,{value:"Kafka"},"Kafka"),l.a.createElement(Ka,{value:"NAS"},"NAS"),l.a.createElement(Ka,{value:"PolarDB"},"PolarDB"),l.a.createElement(Ka,{value:"HBase"},"HBase"))),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},type:"primary",icon:"search",onClick:this.handleQuery},"\u67e5 \u8be2")),l.a.createElement(te.a,{span:2,className:"col-span"},l.a.createElement(Z.a,{style:{width:"100%"},icon:"plus-circle",onClick:this.handleAdd},"\u65b0 \u589e"))),l.a.createElement(Qe,{wrappedComponentRef:function(t){return e.extraInfoFormRef=t},visible:this.state.extraInfoModalVisible,handleOk:this.handleExtraInfoOk,handleCancel:this.handleExtraInfoCancel}),l.a.createElement(Ga,{wrappedComponentRef:function(t){return e.otherInfoFormRef=t},server_info_modal_visible:this.state.other_info_modal_visible,actionType:this.state.actionType,handlePostServerInfoSubmit:this.handlePostOtherInfoSubmit,handlePostServerInfoCancel:this.handlePostOtherInfoCancel}),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",bordered:!0,size:"small",rowSelection:t}))}}]),t}(r.Component),Xa=(a(1363),a(642)),Za=function(e){return z("settings/value",e)},$a=g.a.Content,en=ge.a.RangePicker,tn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onChangeAllowRenewConfirm=a.onChangeAllowRenewConfirm.bind(Object(b.a)(a)),a.dateOnChange=a.dateOnChange.bind(Object(b.a)(a)),a.handleSetExpireDateSubmit=a.handleSetExpireDateSubmit.bind(Object(b.a)(a)),a.handleSetExpireDateCancel=a.handleSetExpireDateCancel.bind(Object(b.a)(a)),a.state={expireSettingModalVisible:!1,isOpenRenewConfirm:!1,expireStartDate:null,expireEndDate:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.loadAllowRenewConfirmStatus()}},{key:"loadAllowRenewConfirmStatus",value:function(){var e,t=this;(e={key_name:"open_renew_confirm"},R("settings/value",e)).then(function(e){0===e.code?t.setState({isOpenRenewConfirm:"true"===e.data.value}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"onChangeAllowRenewConfirm",value:function(e){this.setState({isOpenRenewConfirm:e}),!0===e?this.setState({expireSettingModalVisible:!0}):Za({key_name:"open_renew_confirm",value:e.toLocaleString()}).then(function(e){0===e.code?O.a.success("\u8bbe\u7f6e\u6210\u529f"):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"dateOnChange",value:function(e,t){this.setState({expireStartDate:t[0],expireEndDate:t[1]})}},{key:"handleSetExpireDateSubmit",value:function(){var e=this;Za({key_name:"open_renew_confirm",value:this.state.isOpenRenewConfirm.toLocaleString()}).then(function(e){0===e.code?O.a.success("\u8bbe\u7f6e\u6210\u529f"):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())}),Za({key_name:"expire_start_date",value:this.state.expireStartDate}).then(function(e){0!==e.code&&O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())}),Za({key_name:"expire_end_date",value:this.state.expireEndDate}).then(function(t){0!==t.code?O.a.error(t.msg):e.setState({expireSettingModalVisible:!1})}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleSetExpireDateCancel",value:function(){this.setState({expireSettingModalVisible:!1})}},{key:"render",value:function(){return l.a.createElement($a,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(E.a,{title:"\u8bbe\u7f6e\u8fc7\u671f\u786e\u8ba4\u65f6\u95f4\u533a\u95f4",destroyOnClose:!0,visible:this.state.expireSettingModalVisible,onOk:this.handleSetExpireDateSubmit,onCancel:this.handleSetExpireDateCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",width:700},l.a.createElement(X.a,{message:"\u8d1f\u8d23\u4eba\u53ea\u53ef\u786e\u8ba4\u8be5\u65f6\u95f4\u6bb5\u5185\u8fc7\u671f\u7684\u8d44\u6e90",banner:!0}),l.a.createElement(ee.a,{style:{marginTop:30,marginBottom:30}},l.a.createElement(te.a,{span:4}),l.a.createElement(te.a,{span:3,style:{textAlign:"right"}},l.a.createElement("label",{style:{fontSize:14,lineHeight:"32px",marginRight:10,fontWeight:500}},"\u8fc7\u671f\u65f6\u95f4: ")),l.a.createElement(te.a,{span:13},l.a.createElement(en,{style:{width:"100%"},onChange:this.dateOnChange,format:"YYYY-MM-DD"})),l.a.createElement(te.a,{span:4}))),l.a.createElement(Nt.a,{style:{width:200,textAlign:"center"}},l.a.createElement(Xa.a,{checked:this.state.isOpenRenewConfirm,onChange:this.onChangeAllowRenewConfirm}),l.a.createElement("p",{style:{paddingTop:20,fontWeight:500}},"\u662f\u5426\u5f00\u542f\u7eed\u8d39\u786e\u8ba4\u7a97\u53e3")))}}]),t}(r.Component),an=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){localStorage.removeItem("ops_token"),localStorage.removeItem("token_info"),window.location.href="/login"}},{key:"render",value:function(){return l.a.createElement("div",null,"\u6ce8\u9500\u4e2d...")}}]),t}(r.Component),nn=function(e,t){return R("user/feedback",{page:e,size:t})},rn=g.a.Content,ln={overFlow:"hidden",textOverflow:"ellipsis",display:"-webkit-box"},sn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).changePage=function(e){a.setState({pagination:Object(fe.a)({},a.state.pagination,{page:e,current:e})},function(){a.refreshTableData()})},a.refreshTableData=function(){a.setState({tableLoading:!0}),nn(a.state.pagination.page,a.state.pagination.pageSize).then(function(e){var t=a.state.pagination;t.total=parseInt(e.data.total),t.page=parseInt(e.data.page),t.showTotal(parseInt(e.data.total)),a.setState({pagination:t});for(var n=e.data.feedbacks,r=[],l=0;l<n.length;l++)r.push({id:n[l].id,createTime:n[l].createTime,username:n[l].username,content:n[l].content,score:n[l].score});a.setState({tableData:r,tableLoading:!1})}).catch(function(e){console.log(e)})},a.refreshTableData=a.refreshTableData.bind(Object(b.a)(a)),a.onShowSizeChange=a.onShowSizeChange.bind(Object(b.a)(a)),a.state={columns:[{title:"ID",dataIndex:"id",key:"id",width:30,className:"small_font"},{title:"\u7528\u6237",dataIndex:"username",key:"username",className:"small_font"},{title:"\u5185\u5bb9",dataIndex:"content",key:"content",className:"small_font "+{columnStyle:ln}},{title:"\u8bc4\u5206",dataIndex:"score",key:"score",className:"small_font "+{columnStyle:ln}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",className:"small_font "+{columnStyle:ln}}],tableData:[],tableLoading:!1,authLinkModalVisible:!1,current_data_id:null,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","30","100"],onShowSizeChange:a.onShowSizeChange,showQuickJumper:!1,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},pageSize:10,page:1,total:0,onChange:function(e){return a.changePage(e)}}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onShowSizeChange",value:function(e,t){var a=this;this.setState({pagination:Object(fe.a)({},this.state.pagination,{page:1,current:1,pageSize:t})},function(){a.refreshTableData()})}},{key:"componentDidMount",value:function(){this.refreshTableData()}},{key:"render",value:function(){return l.a.createElement(rn,{style:{background:"#fff",padding:20,margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["\u7cfb\u7edf\u7ba1\u7406","\u7528\u6237\u53cd\u9988"]}),l.a.createElement("div",{style:{marginBottom:20}},l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:3},l.a.createElement(Z.a,{type:"primary",onClick:this.refreshTableData},"\u5237 \u65b0")))),l.a.createElement(ie.a,{columns:this.state.columns,dataSource:this.state.tableData,scroll:{x:"max-content"},pagination:this.state.pagination,loading:this.state.tableLoading,rowClassName:"fixedHeight",size:"small"}))}}]),t}(r.Component),on=sn=S.a.create({name:"UserFeedbackManager"})(sn),cn=g.a.Content,un=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).jumpJobDetail=a.jumpJobDetail.bind(Object(b.a)(a)),a.state={jobs:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadJenkinsAllJobs()}},{key:"loadJenkinsAllJobs",value:function(){var e,t=this;R("jenkins/jobs",e).then(function(e){0===e.code?t.setState({jobs:e.data}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"jumpJobDetail",value:function(e){this.props.history.push({pathname:"/admin/cicd/job_detail",state:{jobName:e}})}},{key:"render",value:function(){var e=this;return l.a.createElement(cn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["CI & CD","\u4efb\u52a1\u5217\u8868"]}),l.a.createElement(ee.a,null,l.a.createElement(Nt.a,{title:"\u5f53\u524d\u4efb\u52a1",size:"small"},this.state.jobs.map(function(t,a){return l.a.createElement(Nt.a.Grid,{key:a,style:{width:"25%",textAlign:"center"}},l.a.createElement(Z.a,{type:"link",onClick:e.jumpJobDetail.bind(e,t.name)},t.name))}))))}}]),t}(r.Component),dn=(a(440),a(134)),mn=g.a.Content,hn=Ee.a.Text,pn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onDrawerClose=a.onDrawerClose.bind(Object(b.a)(a)),a.startBuildJob=a.startBuildJob.bind(Object(b.a)(a)),a.refreshJobInfo=a.refreshJobInfo.bind(Object(b.a)(a)),a.disableJob=a.disableJob.bind(Object(b.a)(a)),a.enableJob=a.enableJob.bind(Object(b.a)(a)),a.loadJenkinsJobBuildList=a.loadJenkinsJobBuildList.bind(Object(b.a)(a)),a.state={buildInfo:[],buildConsoleLog:"",logLoading:!1,jobBuilding:!1,refreshInfoLoading:!1,buildLog:[],start:0,timer:null,progressLoading:"none",nextBuildNumber:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadJenkinsJobBuildList({name:this.props.location.state.jobName}),this.setState({buildName:this.props.location.state.jobName})}},{key:"loadJenkinsJobBuildList",value:function(e){var t=this;this.setState({refreshInfoLoading:!0}),function(e){return R("jenkins/jobBuildList",e)}(e).then(function(e){if(0===e.code){var a=[];void 0!==e.data.buildLog&&null!==e.data.buildLog&&(a=e.data.buildLog),t.setState({buildInfo:e.data,buildLog:a,nextBuildNumber:parseInt(e.data.nextBuildNumber)})}else O.a.error(e.msg);t.setState({refreshInfoLoading:!1})}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"refreshJobInfo",value:function(){this.loadJenkinsJobBuildList({name:this.props.location.state.jobName})}},{key:"onDrawerClose",value:function(){this.setState({drawerVisible:!1,progressLoading:"none",buildConsoleLog:"",start:0}),clearTimeout(this.timer),this.timer=null,this.refreshJobInfo()}},{key:"showBuildConsoleLog",value:function(e){var t,a=this;this.setState({drawerVisible:!0,logLoading:!0,jobBuilding:!0}),(t={name:this.state.buildName,buildId:e,start:parseInt(this.state.start)},R("jenkins/jobBuildLog",t)).then(function(t){0===t.code?(a.setState({buildConsoleLog:a.state.buildConsoleLog+t.data.content,logLoading:!1,jobBuilding:!1,start:t.data.start}),"true"===t.data.hasMore?(a.setState({progressLoading:"inline-block"}),a.timer=setTimeout(function(){a.showBuildConsoleLog(e)},2e3)):(a.setState({progressLoading:"none"}),clearTimeout(a.timer),a.timer=null,a.refreshJobInfo())):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"startBuildJob",value:function(){var e,t=this;this.setState({jobBuilding:!0}),(e={name:this.state.buildName},P("jenkins/jobBuild",e)).then(function(e){0===e.code?setTimeout(function(){t.setState({jobBuilding:!1}),t.refreshJobInfo()},4e3):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"disableJob",value:function(){var e,t=this;(e={name:this.state.buildName},P("jenkins/disableJob",e)).then(function(e){0===e.code?(O.a.success("\u7981\u7528\u6210\u529f"),t.refreshJobInfo()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"enableJob",value:function(){var e,t=this;(e={name:this.state.buildName},P("jenkins/enableJob",e)).then(function(e){0===e.code?(O.a.success("\u542f\u7528\u6210\u529f"),t.refreshJobInfo()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e=this,t=l.a.createElement("div",null,"\u6784\u5efa\u65e5\u5fd7",l.a.createElement(I.a,{type:"loading",style:{marginLeft:"20px",display:this.state.progressLoading}})),a=!0,n=l.a.createElement(Z.a,{size:"small",onClick:this.disableJob,style:{marginLeft:"20px"}},"\u7981 \u7528");return!1===this.state.buildInfo.buildable&&(a=!1,n=l.a.createElement(Z.a,{size:"small",onClick:this.enableJob,style:{marginLeft:"20px"}},"\u542f \u7528")),l.a.createElement(mn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["CI & CD","\u4efb\u52a1\u8be6\u60c5"]}),l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(te.a,{span:2},l.a.createElement(Z.a,{type:"primary",onClick:this.refreshJobInfo},"\u5237 \u65b0"))),l.a.createElement(ce.a,{spinning:this.state.refreshInfoLoading},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u4efb\u52a1\u540d"},this.state.buildInfo.displayName),l.a.createElement(oe.a.Item,{label:"\u4efb\u52a1\u63cf\u8ff0"},this.state.buildInfo.description),l.a.createElement(oe.a.Item,{label:"\u4efb\u52a1\u64cd\u4f5c"},l.a.createElement(Z.a,{size:"small",disabled:!a,loading:this.state.jobBuilding,onClick:this.startBuildJob},"\u6784\u5efa"),n))),l.a.createElement(se.a,{title:t,placement:"left",closable:!1,onClose:this.onDrawerClose,visible:this.state.drawerVisible,width:700},l.a.createElement(ce.a,{spinning:this.state.logLoading},l.a.createElement(hn,{style:{whiteSpace:"pre"}},this.state.buildConsoleLog))),l.a.createElement(dn.a,{header:l.a.createElement("div",null,"\u8fd15\u6b21\u6784\u5efa\u72b6\u6001"),footer:null,bordered:!0,dataSource:this.state.buildLog,style:{marginTop:"10px",width:"50%"},renderItem:function(t){var a=JSON.parse(t),n=l.a.createElement(Zt.a,{color:"#2db7f5"},"\u6784\u5efa\u4e2d");void 0!==a.result&&null!==a.result&&(n="SUCCESS"===a.result?l.a.createElement(Zt.a,{color:"#108ee9"},"\u6210 \u529f"):"FAILURE"===a.result?l.a.createElement(Zt.a,{color:"#f50"},"\u5931 \u8d25"):"ABORTED"===a.result?l.a.createElement(Zt.a,{color:"#f50"},"\u4e2d \u6b62"):l.a.createElement(Zt.a,{color:"magenta"},a.result));var r=l.a.createElement(hn,{type:"secondary"},xe()(a.timestamp).format("MM-DD HH:mm:ss")),i=l.a.createElement("div",{style:{display:"inline-block",float:"right"}},l.a.createElement(Z.a,{type:"link",size:"small",onClick:e.showBuildConsoleLog.bind(e,a.id)},"\u6784\u5efa\u65e5\u5fd7"));return l.a.createElement(dn.a.Item,null,n," - ",a.fullDisplayName," - ",r,i)}}))}}]),t}(r.Component),fn=g.a.Content,gn=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement(fn,{style:{background:"#fff",padding:0,margin:0,height:"100%"}},l.a.createElement(p.a,null,l.a.createElement(f.a,{path:"/admin/cicd/jobs",component:un}),l.a.createElement(f.a,{path:"/admin/cicd/job_detail",component:pn})))}}]),t}(r.Component),bn=(a(1368),a(462)),yn=function(e){return R("/kubernetes/metrics/nodes",e)},En=a(332),vn=(a(1372),{rc:"apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: redis-rc\nspec:\n  replicas: 1\n  selector:\n    app: redis\n  template:\n    metadata:\n      name: redis\n      labels:\n        app: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis\n        ports:\n        - containerPort: 6379",rs:"apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: redis-rs\n  labels:\n    app: redis\nspec:\n  replicas: 1\n  selector:\n    app: redis\n  template:\n    metadata:\n      labels:\n        app: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis\n        ports:\n        - containerPort: 6379",deployment:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:latest\n        ports:\n        - containerPort: 80",statefull_rs:'kind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx # has to match .spec.template.metadata.labels\n  serviceName: "nginx"\n  replicas: 3 # by default is 1\n  template:\n    metadata:\n      labels:\n        app: nginx # has to match .spec.selector.matchLabels\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: nginx\n        image: k8s.gcr.io/nginx-slim:0.8\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n  volumeClaimTemplates:\n  - metadata:\n      name: www\n    spec:\n      accessModes: [ "ReadWriteOnce" ]\n      storageClassName: "my-storage-class"\n      resources:\n        requests:\n          storage: 1Gi',daemon_set:"apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: fluentd-elasticsearch\n  namespace: kube-system\n  labels:\n    k8s-app: fluentd-logging\nspec:\n  selector:\n    matchLabels:\n      name: fluentd-elasticsearch\n  template:\n    metadata:\n      labels:\n        name: fluentd-elasticsearch\n    spec:\n      tolerations:\n      - key: node-role.kubernetes.io/master\n        effect: NoSchedule\n      containers:\n      - name: fluentd-elasticsearch\n        image: gcr.io/fluentd-elasticsearch/fluentd:v2.5.1\n        resources:\n          limits:\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        volumeMounts:\n        - name: varlog\n          mountPath: /var/log\n        - name: varlibdockercontainers\n          mountPath: /var/lib/docker/containers\n          readOnly: true\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - name: varlog\n        hostPath:\n          path: /var/log\n      - name: varlibdockercontainers\n        hostPath:\n          path: /var/lib/docker/containers",service:"apiVersion: v1\nkind: Service\nmetadata:\n  name: redis\nspec:\n  type: NodePort\n  ports:\n   - port: 6379\n     nodePort: 30003\n  selector:\n    app: redis",config_map:"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: example-config\ndata:\n  example.property.1: hello",secret_map:'apiVersion: v1\nkind: Secret\nmetadata:\n  name: example-config\ntype: Opaque\nstringData:\n  example.property.1: "test"'}),Sn=g.a.Content,kn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={rcDetail:a.props.location.state},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[];for(var t in this.state.rcDetail.data.metadata.labels)e.push(l.a.createElement("div",{key:t},l.a.createElement(Zt.a,{color:"geekblue"},t+":"+this.state.rcDetail.data.metadata.labels[t])));var a=[];for(var n in this.state.rcDetail.data.spec.selector)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+this.state.rcDetail.data.spec.selector[n])));for(var r=[],i=this.state.rcDetail.data.spec.template.spec.containers,s=0;s<i.length;s++)r.push(l.a.createElement("div",{key:s},l.a.createElement(Zt.a,{color:"geekblue"},i[s].image)));return l.a.createElement(Sn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Nt.a,{size:"small",title:"Replication Controller \u8be6\u60c5",style:{width:"100%"}},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u540d\u79f0"},this.state.rcDetail.data.metadata.name),l.a.createElement(oe.a.Item,{label:"\u547d\u540d\u7a7a\u95f4"},this.state.rcDetail.data.metadata.namespace),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.rcDetail.data.metadata.creationTimestamp),l.a.createElement(oe.a.Item,{label:"\u6807\u7b7e"},e),l.a.createElement(oe.a.Item,{label:"\u9009\u62e9\u5668"},a),l.a.createElement(oe.a.Item,{label:"\u955c\u50cf"},r),l.a.createElement(oe.a.Item,{label:"\u526f\u672c\u6570"},this.state.rcDetail.data.status.replicas),l.a.createElement(oe.a.Item,{label:"\u8fd0\u884c\u4e2d"},this.state.rcDetail.data.status.readyReplicas))))}}]),t}(r.Component),Cn=g.a.Content,In=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={serviceDetail:a.props.location.state},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[];for(var t in this.state.serviceDetail.data.metadata.labels)e.push(l.a.createElement("div",{key:t},l.a.createElement(Zt.a,{color:"geekblue"},t+":"+this.state.serviceDetail.data.metadata.labels[t])));var a=[];for(var n in this.state.serviceDetail.data.spec.selector)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+this.state.serviceDetail.data.spec.selector[n])));for(var r=[],i=this.state.serviceDetail.data.spec.ports,s=0;s<i.length;s++){var o="";i[s].hasOwnProperty("port")&&(o+=i[s].port+"(port) "),i[s].hasOwnProperty("targetPort")&&(o+=i[s].targetPort+"(targetPort) "),i[s].hasOwnProperty("nodePort")&&(o+=i[s].nodePort+"(nodePort) "),r.push(l.a.createElement(Zt.a,{color:"geekblue"},i[s].protocol+": "+o))}return l.a.createElement(Cn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Nt.a,{size:"small",title:"Service \u8be6\u60c5",style:{width:"100%"}},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u540d\u79f0"},this.state.serviceDetail.data.metadata.name),l.a.createElement(oe.a.Item,{label:"\u547d\u540d\u7a7a\u95f4"},this.state.serviceDetail.data.metadata.namespace),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.serviceDetail.data.metadata.creationTimestamp),l.a.createElement(oe.a.Item,{label:"\u6807\u7b7e"},e),l.a.createElement(oe.a.Item,{label:"clusterIP"},this.state.serviceDetail.data.spec.clusterIP),l.a.createElement(oe.a.Item,{label:"\u7c7b\u578b"},this.state.serviceDetail.data.spec.type),l.a.createElement(oe.a.Item,{label:"sessionAffinity"},this.state.serviceDetail.data.spec.sessionAffinity),l.a.createElement(oe.a.Item,{label:"\u7aef\u53e3"},r),l.a.createElement(oe.a.Item,{label:"\u9009\u62e9\u6807\u7b7e"},a))))}}]),t}(r.Component),Dn=a(185),On=a.n(Dn),xn=Ee.a.Text,wn=g.a.Content,jn=ve.a.TabPane,Tn=On()(function(e){e.col("timestamp",{alias:"\u65f6\u95f4"}),e.col("value",{alias:"\u5185\u5b58(M)"}),e.line().position("timestamp*value").size(2),e.render()}),_n=On()(function(e){e.col("timestamp",{alias:"\u65f6\u95f4"}),e.col("value",{alias:"CPU(%)"}),e.line().position("timestamp*value").size(2),e.render()}),Mn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).loadPodLog=a.loadPodLog.bind(Object(b.a)(a)),a.handleCancelLogModal=a.handleCancelLogModal.bind(Object(b.a)(a)),a.openWebTerminal=a.openWebTerminal.bind(Object(b.a)(a)),a.state={serviceDetail:a.props.location.state,memoryChartData:[],cpuChartData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"loadPodLog",value:function(e){"Running"===this.state.serviceDetail.data.status.phase?this.props.history.push({pathname:"/admin/k8s_cluster/manage/container_log",state:{namespace:this.state.serviceDetail.data.metadata.namespace,podName:this.state.serviceDetail.data.metadata.name,containerName:e}}):O.a.error("\u5f53\u524dpod\u672a\u8fd0\u884c\uff0c\u65e0\u6cd5\u67e5\u770b\u65e5\u5fd7\uff01")}},{key:"handleCancelLogModal",value:function(){this.setState({logModalVisible:!1,logLoading:!1})}},{key:"openWebTerminal",value:function(e){"Running"===this.state.serviceDetail.data.status.phase?this.props.history.push({pathname:"/admin/k8s_cluster/manage/container_terminal",state:{namespace:this.state.serviceDetail.data.metadata.namespace,podName:this.state.serviceDetail.data.metadata.name,containerName:e}}):O.a.error("\u5f53\u524dpod\u672a\u8fd0\u884c\uff0c\u65e0\u6cd5\u4f7f\u7528\u7ec8\u7aef\uff01")}},{key:"tabChange",value:function(e){var t=this;if("Pod\u76d1\u63a7"===e){var a='sum(rate(container_cpu_usage_seconds_total{pod="'+this.state.serviceDetail.data.metadata.name+'", container!="POD", container!=""}[5m])) / (sum(container_spec_cpu_quota{image!=""}/100000) ) * 100 ';yn({query:encodeURIComponent(a)}).then(function(e){if(0===e.code){for(var a=JSON.parse(e.data).data.result[0].values,n=[],r=0;r<a.length;r++)n.push({timestamp:xe()(1e3*a[r][0]).format("HH:mm:ss"),value:parseFloat(a[r][1])});t.setState({cpuChartData:n})}else O.a.error(e.msg)});var n='container_memory_usage_bytes{pod="'+this.state.serviceDetail.data.metadata.name+'", container!="POD", container!=""}';yn({query:encodeURIComponent(n)}).then(function(e){if(0===e.code){for(var a=JSON.parse(e.data).data.result[0].values,n=[],r=0;r<a.length;r++)n.push({timestamp:xe()(1e3*a[r][0]).format("HH:mm:ss"),value:parseInt(a[r][1])/1024/1024});t.setState({memoryChartData:n})}else O.a.error(e.msg)})}}},{key:"render",value:function(){var e=this,t=[];for(var a in this.state.serviceDetail.data.metadata.labels)t.push(l.a.createElement("div",{key:a},l.a.createElement(Zt.a,{color:"geekblue"},a+":"+this.state.serviceDetail.data.metadata.labels[a])));var n=this.state.serviceDetail.data.spec.containers.map(function(t){var a=[];if(t.hasOwnProperty("ports"))for(var n=0;n<t.ports.length;n++)a.push(l.a.createElement(Zt.a,{color:"geekblue"},t.ports[n].containerPort+"("+t.ports[n].protocol+")"));return l.a.createElement(ee.a,{style:{borderBottom:"1px solid #e8e8e8"}},l.a.createElement(te.a,null,l.a.createElement(dn.a,{itemLayout:"horizontal"},l.a.createElement(dn.a.Item,null,l.a.createElement(dn.a.Item.Meta,{avatar:l.a.createElement(et,null),title:l.a.createElement(xn,{type:"secondary"},"\u5bb9\u5668\u540d\uff1a",t.name," \xa0\xa0",l.a.createElement(Z.a,{type:"link",onClick:e.loadPodLog.bind(e,t.name)},"\u67e5\u770b\u65e5\u5fd7"),l.a.createElement(Z.a,{type:"link",onClick:e.openWebTerminal.bind(e,t.name)},"\u6267\u884c\u547d\u4ee4")),description:l.a.createElement(xn,{type:"secondary"},"\u955c\u50cf\uff1a",t.image," \xa0\xa0 \u7aef\u53e3: ",a)})))))});return l.a.createElement(wn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(ve.a,{defaultActiveKey:"Pod\u8be6\u60c5",onChange:this.tabChange.bind(this)},l.a.createElement(jn,{tab:"Pod\u8be6\u60c5",key:"Pod\u8be6\u60c5"},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"Pod\u540d\u79f0"},this.state.serviceDetail.data.metadata.name),l.a.createElement(oe.a.Item,{label:"\u547d\u540d\u7a7a\u95f4"},this.state.serviceDetail.data.metadata.namespace),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.serviceDetail.data.metadata.creationTimestamp),l.a.createElement(oe.a.Item,{label:"\u6807\u7b7e"},t),l.a.createElement(oe.a.Item,{label:"\u72b6\u6001"},this.state.serviceDetail.data.status.phase),l.a.createElement(oe.a.Item,{label:"Host IP"},this.state.serviceDetail.data.status.hostIP),l.a.createElement(oe.a.Item,{label:"Pod IP"},this.state.serviceDetail.data.status.podIP)),l.a.createElement(Nt.a,{size:"small",title:"\u5bb9\u5668\u5217\u8868",style:{width:"100%",marginTop:"10px"}},n)),l.a.createElement(jn,{tab:"Pod\u76d1\u63a7",key:"Pod\u76d1\u63a7"},l.a.createElement(Tn,{data:this.state.memoryChartData,height:300,forceFit:!0}),l.a.createElement(_n,{data:this.state.cpuChartData,height:300,forceFit:!0}))))}}]),t}(r.Component),Ln=a(643),An=a(644),Nn=(a(1377),a(645)),Rn=g.a.Content,Pn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).goBack=a.goBack.bind(Object(b.a)(a)),a.rws=new Nn.a(L+"kubernetes/container_terminal"),a.terminal=new Ln.Terminal({rows:36,fontSize:14,cursorBlink:!0,cursorStyle:"block",bellStyle:"sound",theme:"Console"}),a.terminal.prompt=function(){a.terminal.write("\r\n$ ")},a.state={containerDetail:a.props.location.state,connectionStatus:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.terminal.open(document.getElementById("terminal")),this.terminal.writeln("Welcome to use FuLu Web Terminal."),this.terminal.prompt(),this.initWsConnection(),Qa=new An.AttachAddon(this.rws),this.terminal.loadAddon(Qa),this.terminal.focus()}},{key:"componentWillUnmount",value:function(){this.rws.send(JSON.stringify({action:"connection_close",clusterId:localStorage.getItem("clusterId"),namespace:this.state.containerDetail.namespace,podName:this.state.containerDetail.podName,containerName:this.state.containerDetail.containerName})),this.rws.close(),this.terminal.dispose()}},{key:"initWsConnection",value:function(){var e=this;this.rws.addEventListener("open",function(){e.rws.send(JSON.stringify({action:"init_connection",clusterId:localStorage.getItem("clusterId"),namespace:e.state.containerDetail.namespace,podName:e.state.containerDetail.podName,containerName:e.state.containerDetail.containerName})),e.setState({connectionStatus:1})}),this.rws.addEventListener("close",function(){e.setState({connectionStatus:0})}),this.rws.addEventListener("error",function(){e.setState({connectionStatus:0})})}},{key:"goBack",value:function(){this.rws.send(JSON.stringify({action:"connection_close",clusterId:localStorage.getItem("clusterId"),namespace:this.state.containerDetail.namespace,podName:this.state.containerDetail.podName,containerName:this.state.containerDetail.containerName})),this.rws.close(),this.props.history.goBack()}},{key:"render",value:function(){var e=l.a.createElement(X.a,{message:"\u8fdc\u7a0b\u8fde\u63a5\u672a\u5efa\u7acb",type:"error",showIcon:!0});return 1===this.state.connectionStatus&&(e=l.a.createElement(X.a,{message:"\u8fdc\u7a0b\u8fde\u63a5\u6210\u529f",type:"success",showIcon:!0})),l.a.createElement(Rn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Z.a,{type:"link",onClick:this.goBack},l.a.createElement(I.a,{type:"left"}),"\u8fd4\u56de\u4e0a\u7ea7"),e,l.a.createElement(Nt.a,{size:"small",title:"\u865a\u62df\u7ec8\u7aef",style:{width:"100%"},bodyStyle:{padding:0}},l.a.createElement("div",{id:"terminal",style:{width:"100%"}})))}}]),t}(r.Component),zn=g.a.Content,Vn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).goBack=a.goBack.bind(Object(b.a)(a)),a.syncLogs=a.syncLogs.bind(Object(b.a)(a)),a.state={logLoading:!1,containerInfo:a.props.location.state},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.syncLogs()}},{key:"goBack",value:function(){var e=this;this.setState({logContent:""},function(){e.props.history.goBack()})}},{key:"syncLogs",value:function(){var e,t=this;this.setState({logLoading:!0}),(e={namespace:this.state.containerInfo.namespace,podName:this.state.containerInfo.podName,containerName:this.state.containerInfo.containerName},R("/kubernetes/pod/log",e)).then(function(e){0===e.code?t.setState({logContent:e.data,logLoading:!1},function(){t.scrollToBottom()}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"scrollToBottom",value:function(){var e=document.getElementById("logPanel");e.scrollTop=e.scrollHeight}},{key:"render",value:function(){return l.a.createElement(zn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(ee.a,{style:{padding:"0px 0px 10px 0px"}},l.a.createElement(Z.a,{type:"link",onClick:this.goBack},l.a.createElement(I.a,{type:"left"}),"\u8fd4\u56de\u4e0a\u7ea7"),l.a.createElement(Z.a,{type:"link",icon:"reload",onClick:this.syncLogs,style:{float:"right"}},"\u5237 \u65b0")),l.a.createElement(ce.a,{spinning:this.state.logLoading},l.a.createElement("div",{style:{height:"85vh"}},l.a.createElement("div",{id:"logPanel",style:{whiteSpace:"pre-line",backgroundColor:"rgb(19, 19, 19)",color:"#fff",fontSize:"14px",lineHeight:"20px",height:"100%",padding:"10px",overflow:"scroll"}},this.state.logContent))))}}]),t}(r.Component),Bn=g.a.Content,Fn=Ee.a.Text,Yn=ve.a.TabPane,qn=On()(function(e){e.col("timestamp",{alias:"\u65f6\u95f4"}),e.col("value",{alias:"\u5185\u5b58\u4f7f\u7528(M)"}),e.line().position("timestamp*value").size(2),e.render()}),Kn=On()(function(e){e.col("timestamp",{alias:"\u65f6\u95f4"}),e.col("value",{alias:"CPU(%)"}),e.line().position("timestamp*value").size(2),e.render()}),Hn=On()(function(e){e.col("timestamp",{alias:"\u65f6\u95f4"}),e.col("value",{alias:"\u78c1\u76d8(%)"}),e.line().position("timestamp*value").size(2),e.render()}),Jn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={nodeDetail:a.props.location.state,memoryChartData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"tabChange",value:function(e){var t=this;"Node\u76d1\u63a7"===e&&(yn({query:"node_memory_MemTotal_bytes-node_memory_MemAvailable_bytes"}).then(function(e){if(0===e.code){for(var a=JSON.parse(e.data).data.result[0].values,n=[],r=0;r<a.length;r++)n.push({timestamp:xe()(1e3*a[r][0]).format("HH:mm:ss"),value:parseInt(a[r][1])/1024/1024});t.setState({memoryChartData:n})}else O.a.error(e.msg)}),yn({query:encodeURIComponent('100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)')}).then(function(e){if(0===e.code){for(var a=JSON.parse(e.data).data.result[0].values,n=[],r=0;r<a.length;r++)n.push({timestamp:xe()(1e3*a[r][0]).format("HH:mm:ss"),value:parseFloat(a[r][1])});t.setState({cpuChartData:n})}else O.a.error(e.msg)}),yn({query:encodeURIComponent("100 - (node_filesystem_avail_bytes/node_filesystem_size_bytes * 100)")}).then(function(e){if(0===e.code){for(var a=JSON.parse(e.data).data.result[0].values,n=[],r=0;r<a.length;r++)n.push({timestamp:xe()(1e3*a[r][0]).format("HH:mm:ss"),value:parseFloat(a[r][1])});t.setState({diskChartData:n})}else O.a.error(e.msg)}))}},{key:"render",value:function(){var e=[];for(var t in this.state.nodeDetail.data.metadata.labels)e.push(l.a.createElement("div",{key:t},l.a.createElement(Zt.a,{color:"geekblue"},t+":"+this.state.nodeDetail.data.metadata.labels[t])));var a=[];for(var n in this.state.nodeDetail.data.metadata.annotations)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+this.state.nodeDetail.data.metadata.annotations[n])));for(var r=[],i=this.state.nodeDetail.data.status.addresses,s=0;s<i.length;s++)r.push(l.a.createElement(Fn,null,i[s].type+":  "+i[s].address)),r.push(l.a.createElement("br",null));return l.a.createElement(Bn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(ve.a,{defaultActiveKey:"Node\u4fe1\u606f",onChange:this.tabChange.bind(this)},l.a.createElement(Yn,{tab:"Node\u4fe1\u606f",key:"Node\u4fe1\u606f"},l.a.createElement(oe.a,{bordered:!0,size:"small",column:1},l.a.createElement(oe.a.Item,{label:"\u540d\u79f0"},this.state.nodeDetail.data.metadata.name),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.nodeDetail.data.metadata.creationTimestamp),l.a.createElement(oe.a.Item,{label:"\u6807\u7b7e"},e),l.a.createElement(oe.a.Item,{label:"\u6ce8\u89e3"},a),l.a.createElement(oe.a.Item,{label:"\u5730\u5740"},r),l.a.createElement(oe.a.Item,{label:"kubelet\u7aef\u53e3"},this.state.nodeDetail.data.status.daemonEndpoints.kubeletEndpoint.Port),l.a.createElement(oe.a.Item,{label:"\u5bb9\u5668\u7248\u672c"},this.state.nodeDetail.data.status.nodeInfo.containerRuntimeVersion),l.a.createElement(oe.a.Item,{label:"kubelet\u7248\u672c"},this.state.nodeDetail.data.status.nodeInfo.kubeletVersion),l.a.createElement(oe.a.Item,{label:"kubeProxy\u7248\u672c"},this.state.nodeDetail.data.status.nodeInfo.kubeProxyVersion),l.a.createElement(oe.a.Item,{label:"\u7cfb\u7edf"},this.state.nodeDetail.data.status.nodeInfo.operatingSystem),l.a.createElement(oe.a.Item,{label:"\u67b6\u6784"},this.state.nodeDetail.data.status.nodeInfo.architecture))),l.a.createElement(Yn,{tab:"Node\u76d1\u63a7",key:"Node\u76d1\u63a7"},l.a.createElement(qn,{data:this.state.memoryChartData,height:300,forceFit:!0}),l.a.createElement(Kn,{data:this.state.cpuChartData,height:300,forceFit:!0}),l.a.createElement(Hn,{data:this.state.diskChartData,height:300,forceFit:!0}))))}}]),t}(r.Component),Un=g.a.Content,Gn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={rsDetail:a.props.location.state},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[];for(var t in this.state.rsDetail.data.metadata.labels)e.push(l.a.createElement("div",{key:t},l.a.createElement(Zt.a,{color:"geekblue"},t+":"+this.state.rsDetail.data.metadata.labels[t])));var a=[];for(var n in this.state.rsDetail.data.metadata.annotations)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+this.state.rsDetail.data.metadata.annotations[n])));var r=[];for(var i in this.state.rsDetail.data.spec.selector.matchLabels)r.push(l.a.createElement("div",{key:i},l.a.createElement(Zt.a,{color:"geekblue"},i+":"+this.state.rsDetail.data.spec.selector.matchLabels[i])));for(var s=[],o=this.state.rsDetail.data.spec.template.spec.containers,c=0;c<o.length;c++)s.push(l.a.createElement("div",{key:c},l.a.createElement(Zt.a,{color:"geekblue"},o[c].image)));return l.a.createElement(Un,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Nt.a,{size:"small",title:"ReplicaSet \u8be6\u60c5",style:{width:"100%"}},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u540d\u79f0"},this.state.rsDetail.data.metadata.name),l.a.createElement(oe.a.Item,{label:"\u547d\u540d\u7a7a\u95f4"},this.state.rsDetail.data.metadata.namespace),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.rsDetail.data.metadata.creationTimestamp),l.a.createElement(oe.a.Item,{label:"\u6807\u7b7e"},e),l.a.createElement(oe.a.Item,{label:"\u6ce8\u89e3"},a),l.a.createElement(oe.a.Item,{label:"\u9009\u62e9\u5668"},r),l.a.createElement(oe.a.Item,{label:"\u955c\u50cf"},s),l.a.createElement(oe.a.Item,{label:"\u526f\u672c\u6570"},this.state.rsDetail.data.status.replicas),l.a.createElement(oe.a.Item,{label:"\u8fd0\u884c\u4e2d"},this.state.rsDetail.data.status.readyReplicas))))}}]),t}(r.Component),Qn=g.a.Content,Wn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={rsDetail:a.props.location.state},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[];for(var t in this.state.rsDetail.data.metadata.labels)e.push(l.a.createElement("div",{key:t},l.a.createElement(Zt.a,{color:"geekblue"},t+":"+this.state.rsDetail.data.metadata.labels[t])));var a=[];for(var n in this.state.rsDetail.data.metadata.annotations)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+this.state.rsDetail.data.metadata.annotations[n])));var r=[];for(var i in this.state.rsDetail.data.spec.selector.matchLabels)r.push(l.a.createElement("div",{key:i},l.a.createElement(Zt.a,{color:"geekblue"},i+":"+this.state.rsDetail.data.spec.selector.matchLabels[i])));for(var s=[],o=this.state.rsDetail.data.spec.template.spec.containers,c=0;c<o.length;c++)s.push(l.a.createElement("div",{key:c},l.a.createElement(Zt.a,{color:"geekblue"},o[c].image)));return l.a.createElement(Qn,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Nt.a,{size:"small",title:"Deployment \u8be6\u60c5",style:{width:"100%"}},l.a.createElement(oe.a,{bordered:!0,size:"small",column:2},l.a.createElement(oe.a.Item,{label:"\u540d\u79f0"},this.state.rsDetail.data.metadata.name),l.a.createElement(oe.a.Item,{label:"\u547d\u540d\u7a7a\u95f4"},this.state.rsDetail.data.metadata.namespace),l.a.createElement(oe.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.state.rsDetail.data.metadata.creationTimestamp),l.a.createElement(oe.a.Item,{label:"\u6807\u7b7e"},e),l.a.createElement(oe.a.Item,{label:"\u6ce8\u89e3"},a),l.a.createElement(oe.a.Item,{label:"\u9009\u62e9\u5668"},r),l.a.createElement(oe.a.Item,{label:"\u955c\u50cf"},s),l.a.createElement(oe.a.Item,{label:"\u526f\u672c\u6570"},this.state.rsDetail.data.status.replicas),l.a.createElement(oe.a.Item,{label:"\u8fd0\u884c\u4e2d"},this.state.rsDetail.data.status.readyReplicas))))}}]),t}(r.Component),Xn=a(646),Zn=a.n(Xn),$n=ve.a.TabPane,er=g.a.Content,tr=ye.a.Option,ar=bn.a.Panel,nr=E.a.confirm,rr={background:"#f7f7f7",borderRadius:4,marginBottom:24,border:0,overflow:"hidden"},lr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).showLoading=function(){a.setState({refreshDataLoading:!0}),setTimeout(function(){a.setState({refreshDataLoading:!1})},800)},a.getColumnSearchProps=function(e){return{filterDropdown:function(e){var t=e.setSelectedKeys,n=e.selectedKeys,r=e.confirm,i=e.clearFilters;return l.a.createElement("div",{style:{padding:8}},l.a.createElement(x.a,{ref:function(e){a.searchInput=e},value:n[0],onChange:function(e){return t(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(n,r)},style:{width:188,marginBottom:8,display:"block"}}),l.a.createElement(Z.a,{type:"primary",onClick:function(){return a.handleSearch(n,r)},icon:"search",size:"small",style:{width:90,marginRight:8}},"\u67e5\u627e"),l.a.createElement(Z.a,{onClick:function(){return a.handleReset(i)},size:"small",style:{width:90}},"\u91cd\u7f6e"))},filterIcon:function(e){return l.a.createElement(I.a,{type:"search",style:{color:e?"#1890ff":"#40a9ff"}})},onFilter:function(t,a){return console.log(e,a),a.metadata[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){return a.searchInput.select()})},render:function(e){return l.a.createElement(Zn.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:e.toString()})}}},a.handleSearch=function(e,t){t(),a.setState({searchText:e[0]})},a.handleReset=function(e){e(),a.setState({searchText:""})},a.refreshNamespaceResources=a.refreshNamespaceResources.bind(Object(b.a)(a)),a.selectChange=a.selectChange.bind(Object(b.a)(a)),a.yarmCreateK8sResource=a.yarmCreateK8sResource.bind(Object(b.a)(a)),a.handleOk=a.handleOk.bind(Object(b.a)(a)),a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.selectTemplateChange=a.selectTemplateChange.bind(Object(b.a)(a)),a.onDrawerClose=a.onDrawerClose.bind(Object(b.a)(a)),a.handleYamlDetailCancel=a.handleYamlDetailCancel.bind(Object(b.a)(a)),a.handleScaleCancel=a.handleScaleCancel.bind(Object(b.a)(a)),a.handleScaleCommit=a.handleScaleCommit.bind(Object(b.a)(a)),a.onInputNumberChange=a.onInputNumberChange.bind(Object(b.a)(a)),a.handleConfigCancel=a.handleConfigCancel.bind(Object(b.a)(a)),a.state={nodeColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){return l.a.createElement(Z.a,{type:"link",onClick:a.showDetail.bind(Object(b.a)(a),"node",t)},e)}}),{title:"\u6807\u7b7e",key:"labels",render:function(e,t){var a=[];for(var n in t.metadata.labels)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+t.metadata.labels[n])));return a}},{title:"\u5df2\u5c31\u7eea",key:"ready",render:function(e,t){for(var a=t.status.conditions,n=l.a.createElement(Zt.a,{color:"#f50"},"False"),r=0;r<a.length;r++)if("Ready"===a[r].type){"False"!==a[r].status&&(n=l.a.createElement(Zt.a,{color:"#87d068"},"True"));break}return n}},{title:"\u78c1\u76d8\u538b\u529b",key:"disk",render:function(e,t){for(var a=t.status.conditions,n=l.a.createElement(Zt.a,{color:"#87d068"},"\u65e0\u538b\u529b"),r=0;r<a.length;r++)if("DiskPressure"===a[r].type){"False"!==a[r].status&&(n=l.a.createElement(Zt.a,{color:"#f50"},"\u6709\u538b\u529b"));break}return n}},{title:"\u5185\u5b58\u538b\u529b",key:"memory",render:function(e,t){for(var a=t.status.conditions,n=l.a.createElement(Zt.a,{color:"#87d068"},"\u65e0\u538b\u529b"),r=0;r<a.length;r++)if("MemoryPressure"===a[r].type){"False"!==a[r].status&&(n=l.a.createElement(Zt.a,{color:"#f50"},"\u6709\u538b\u529b"));break}return n}},{title:"PID\u538b\u529b",key:"pid",render:function(e,t){for(var a=t.status.conditions,n=l.a.createElement(Zt.a,{color:"#87d068"},"\u65e0\u538b\u529b"),r=0;r<a.length;r++)if("PIDPressure"===a[r].type){"False"!==a[r].status&&(n=l.a.createElement(Zt.a,{color:"#f50"},"\u6709\u538b\u529b"));break}return n}},{title:"\u521b\u5efa\u65f6\u95f4",key:"create_time",render:function(e,t){return xe()(t.metadata.creationTimestamp).format("YYYY-MM-DD")}}],rcColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){var n=l.a.createElement(Ze,null);return(void 0===t.status.readyReplicas||t.status.readyReplicas<t.status.replicas)&&(n=l.a.createElement($e,null)),l.a.createElement("div",null,l.a.createElement("span",{style:{position:"relative",top:"5px"}},n),l.a.createElement(Z.a,{type:"link",onClick:a.showDetail.bind(Object(b.a)(a),"rc",t)},e))}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u6807\u7b7e",key:"labels",render:function(e,t){var a=[];for(var n in t.metadata.labels)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+t.metadata.labels[n])));return a}},{title:"\u5bb9\u5668\u7ec4",key:"replicas",render:function(e,t){var a=" - ";return t.status.hasOwnProperty("readyReplicas")&&(a=t.status.readyReplicas),a+" / "+t.status.replicas}},{title:"\u521b\u5efa\u65f6\u95f4",key:"create_time",render:function(e,t){return xe()(t.metadata.creationTimestamp).format("YYYY-MM-DD")}},{title:"\u955c\u50cf",key:"image",render:function(e,t){for(var a=t.spec.template.spec.containers,n=[],r=0;r<a.length;r++)n.push(l.a.createElement("div",{key:r},l.a.createElement(Zt.a,{color:"geekblue"},a[r].image)));return n}},{title:"\u64cd\u4f5c",key:"action",fixed:"right",render:function(e,t){var n=l.a.createElement(D.a,null,l.a.createElement(D.a.Item,{key:"0"},l.a.createElement("a",{rel:"noopener noreferrer",href:"#",onClick:a.autoScaleHandler.bind(Object(b.a)(a),"rc",t)},"\u4f38\u7f29")),l.a.createElement(D.a.Item,{key:"1"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.deleteHandler.bind(Object(b.a)(a),"rc",t)},"\u5220\u9664")),l.a.createElement(D.a.Item,{key:"2"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.showYamlHandler.bind(Object(b.a)(a),"rc",t)},"\u67e5\u770byaml\u6587\u4ef6")));return l.a.createElement(C.a,{overlay:n,trigger:["click"]},l.a.createElement("a",{className:"ant-dropdown-link",href:"#"},"\u8d44\u6e90\u64cd\u4f5c ",l.a.createElement(I.a,{type:"down"})))}}],rsColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){var n=l.a.createElement(Ze,null);return(void 0===t.status.readyReplicas||t.status.readyReplicas<t.status.replicas)&&(n=l.a.createElement($e,null)),l.a.createElement("div",null,l.a.createElement("span",{style:{position:"relative",top:"5px"}},n),l.a.createElement(Z.a,{type:"link",onClick:a.showDetail.bind(Object(b.a)(a),"rs",t)},e))}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u6807\u7b7e",key:"labels",render:function(e,t){var a=[];for(var n in t.metadata.labels)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+t.metadata.labels[n])));return a}},{title:"\u5bb9\u5668\u7ec4",key:"replicas",render:function(e,t){var a=" - ";return t.status.hasOwnProperty("readyReplicas")&&(a=t.status.readyReplicas),a+" / "+t.status.replicas}},{title:"\u521b\u5efa\u65f6\u95f4",key:"create_time",render:function(e,t){return xe()(t.metadata.creationTimestamp).format("YYYY-MM-DD")}},{title:"\u955c\u50cf",key:"image",render:function(e,t){for(var a=t.spec.template.spec.containers,n=[],r=0;r<a.length;r++)n.push(l.a.createElement("div",{key:r},l.a.createElement(Zt.a,{color:"geekblue"},a[r].image)));return n}},{title:"\u64cd\u4f5c",key:"action",fixed:"right",render:function(e,t){var n=l.a.createElement(D.a,null,l.a.createElement(D.a.Item,{key:"0"},l.a.createElement("a",{rel:"noopener noreferrer",href:"#",onClick:a.autoScaleHandler.bind(Object(b.a)(a),"rs",t)},"\u4f38\u7f29")),l.a.createElement(D.a.Item,{key:"1"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.deleteHandler.bind(Object(b.a)(a),"rs",t)},"\u5220\u9664")),l.a.createElement(D.a.Item,{key:"2"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.showYamlHandler.bind(Object(b.a)(a),"rs",t)},"\u67e5\u770byaml\u6587\u4ef6")));return l.a.createElement(C.a,{overlay:n,trigger:["click"]},l.a.createElement("a",{className:"ant-dropdown-link",href:"#"},"\u8d44\u6e90\u64cd\u4f5c ",l.a.createElement(I.a,{type:"down"})))}}],serviceColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){return l.a.createElement(Z.a,{type:"link",onClick:a.showDetail.bind(Object(b.a)(a),"service",t)},e)}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u6807\u7b7e",key:"labels",render:function(e,t){var a=[];for(var n in t.metadata.labels)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+t.metadata.labels[n])));return a}},{title:"\u96c6\u7fa4IP",key:"replicas",render:function(e,t){return t.spec.clusterIP}},{title:"\u5185\u90e8\u7aef\u70b9",key:"image",render:function(e,t){for(var a=t.spec.ports,n=[],r=0;r<a.length;r++)n.push(l.a.createElement("div",{key:r},l.a.createElement(Zt.a,{color:"geekblue"},t.metadata.name+"."+t.metadata.namespace+":"+a[r].port+" "+a[r].protocol)));return n}},{title:"\u521b\u5efa\u65f6\u95f4",key:"create_time",render:function(e,t){return xe()(t.metadata.creationTimestamp).format("YYYY-MM-DD")}},{title:"\u64cd\u4f5c",key:"action",fixed:"right",render:function(e,t){var n=l.a.createElement(D.a,null,l.a.createElement(D.a.Item,{key:"0"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.deleteHandler.bind(Object(b.a)(a),"service",t)},"\u5220\u9664")),l.a.createElement(D.a.Item,{key:"1"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.showYamlHandler.bind(Object(b.a)(a),"service",t)},"\u67e5\u770byaml\u6587\u4ef6")));return l.a.createElement(C.a,{overlay:n,trigger:["click"]},l.a.createElement("a",{className:"ant-dropdown-link",href:"#"},"\u8d44\u6e90\u64cd\u4f5c ",l.a.createElement(I.a,{type:"down"})))}}],deploymentColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){var n=l.a.createElement(Ze,null);return(void 0===t.status.readyReplicas||t.status.readyReplicas<t.status.replicas)&&(n=l.a.createElement($e,null)),l.a.createElement("div",null,l.a.createElement("span",{style:{position:"relative",top:"5px"}},n),l.a.createElement(Z.a,{type:"link",onClick:a.showDetail.bind(Object(b.a)(a),"deployment",t)},e))}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u6807\u7b7e",key:"labels",render:function(e,t){var a=[];for(var n in t.metadata.labels)a.push(l.a.createElement("div",{key:n},l.a.createElement(Zt.a,{color:"geekblue"},n+":"+t.metadata.labels[n])));return a}},{title:"\u5bb9\u5668\u7ec4",key:"replicas",render:function(e,t){var a=" - ";return t.status.hasOwnProperty("readyReplicas")&&(a=t.status.readyReplicas),a+" / "+t.status.replicas}},{title:"\u521b\u5efa\u65f6\u95f4",key:"create_time",render:function(e,t){return xe()(t.metadata.creationTimestamp).format("YYYY-MM-DD")}},{title:"\u955c\u50cf",key:"image",render:function(e,t){for(var a=t.spec.template.spec.containers,n=[],r=0;r<a.length;r++)n.push(l.a.createElement("div",{key:r},l.a.createElement(Zt.a,{color:"geekblue"},a[r].image)));return n}},{title:"\u64cd\u4f5c",key:"action",fixed:"right",render:function(e,t){var n=l.a.createElement(D.a,null,l.a.createElement(D.a.Item,{key:"0"},l.a.createElement("a",{rel:"noopener noreferrer",href:"#",onClick:a.autoScaleHandler.bind(Object(b.a)(a),"deployment",t)},"\u4f38\u7f29")),l.a.createElement(D.a.Item,{key:"1"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.deleteHandler.bind(Object(b.a)(a),"deployment",t)},"\u5220\u9664")),l.a.createElement(D.a.Item,{key:"2"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.showYamlHandler.bind(Object(b.a)(a),"deployment",t)},"\u67e5\u770byaml\u6587\u4ef6")));return l.a.createElement(C.a,{overlay:n,trigger:["click"]},l.a.createElement("a",{className:"ant-dropdown-link",href:"#"},"\u8d44\u6e90\u64cd\u4f5c ",l.a.createElement(I.a,{type:"down"})))}}],podColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){return l.a.createElement(Z.a,{type:"link",onClick:a.showDetail.bind(Object(b.a)(a),"pod",t)},e)}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u8282\u70b9",key:"labels",dataIndex:"spec.nodeName"},{title:"\u72b6\u6001",key:"status",dataIndex:"status.phase",render:function(e){var t=l.a.createElement(Zt.a,{color:"#87d068"},e);return"Failed"===e&&(t=l.a.createElement(Zt.a,{color:"#f50"},e)),"Pending"===e&&(t=l.a.createElement(Zt.a,{color:"#108ee9"},e)),t}},{title:"\u91cd\u542f\u6b21\u6570",key:"count",render:function(e,t){if("Failed"===t.status.phase)return"0";for(var a=t.status.containerStatuses,n=[],r=0;r<a.length;r++)n.push(l.a.createElement("div",{key:r},l.a.createElement(Zt.a,{color:"geekblue"},a[r].name+" - "+a[r].restartCount)));return n}},{title:"\u521b\u5efa\u65f6\u95f4",key:"create_time",render:function(e,t){return xe()(t.metadata.creationTimestamp).format("YYYY-MM-DD")}},{title:"\u64cd\u4f5c",key:"action",fixed:"right",render:function(e,t){var n=l.a.createElement(D.a,null,l.a.createElement(D.a.Item,{key:"1"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.deleteHandler.bind(Object(b.a)(a),"pod",t)},"\u5220\u9664")),l.a.createElement(D.a.Item,{key:"2"},l.a.createElement("a",{rel:"noopener noreferrer",onClick:a.showYamlHandler.bind(Object(b.a)(a),"pod",t)},"\u67e5\u770byaml\u6587\u4ef6")));return l.a.createElement(C.a,{overlay:n,trigger:["click"]},l.a.createElement("a",{className:"ant-dropdown-link",href:"#"},"\u8d44\u6e90\u64cd\u4f5c ",l.a.createElement(I.a,{type:"down"})))}}],configDictColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e,t){return e}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"metadata.creationTimestamp",key:"creationTimestamp"},{title:"\u6570\u636e\u503c",key:"data",fixed:"right",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"link",onClick:a.showDictValue.bind(Object(b.a)(a),t)},"\u67e5\u770b"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"link",onClick:a.deleteDictValue.bind(Object(b.a)(a),"config_map",t)},"\u5220\u9664"))}}],secretDictColumns:[Object(fe.a)({title:"\u540d\u79f0",dataIndex:"metadata.name",key:"name"},a.getColumnSearchProps("name"),{render:function(e){return e}}),{title:"\u547d\u540d\u7a7a\u95f4",dataIndex:"metadata.namespace",key:"namespace"},{title:"\u7c7b\u578b",dataIndex:"type",key:"type"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"metadata.creationTimestamp",key:"creationTimestamp"},{title:"\u6570\u636e\u503c",key:"data",fixed:"right",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(Z.a,{type:"link",onClick:a.showDictValue.bind(Object(b.a)(a),t)},"\u67e5\u770b"),l.a.createElement(me.a,{type:"vertical"}),l.a.createElement(Z.a,{type:"link",onClick:a.deleteDictValue.bind(Object(b.a)(a),"secret",t)},"\u5220\u9664"))}}],namespaceList:[],replicationControllerList:[],deploymentList:[],replicaSetList:[],serviceList:[],podList:[],nodeList:[],configDictList:[],secretDictList:[],dictConfigValue:{},refreshDataLoading:!1,detailDrawerVisible:!1,yamlModalVisible:!1,scaleModalVisible:!1,configModalVisible:!1,yamlDetail:"",currentNamespace:"default",yamlCode:"",replicaCount:0,scaleResType:"",scaleResData:{spec:{replicas:0}}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getK8sNamespaces(),this.refreshNamespaceResources(),this.getK8sNodes()}},{key:"selectChange",value:function(e){var t=this;this.setState({currentNamespace:e},function(){t.refreshNamespaceResources()})}},{key:"getK8sNamespaces",value:function(){var e,t=this;R("/kubernetes/namespaces",e).then(function(e){0===e.code?t.setState({namespaceList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getK8sNodes",value:function(){var e,t=this;R("/kubernetes/nodes",e).then(function(e){0===e.code?t.setState({nodeList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"refreshNamespaceResources",value:function(){this.getNamespaceDeployments(),this.getNamespaceReplicationControllers(),this.getNamespaceReplicaSets(),this.getNamespaceServices(),this.getNamespacePods(),this.getNamespaceConfigDict(),this.getNamespaceSecretDict(),this.showLoading()}},{key:"getNamespaceDeployments",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/deployments",e)).then(function(e){0===e.code?t.setState({deploymentList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getNamespaceReplicationControllers",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/replication_controllers",e)).then(function(e){0===e.code?t.setState({replicationControllerList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getNamespaceReplicaSets",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/replica_sets",e)).then(function(e){0===e.code?t.setState({replicaSetList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getNamespaceServices",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/services",e)).then(function(e){0===e.code?t.setState({serviceList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getNamespacePods",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/pods",e)).then(function(e){0===e.code?t.setState({podList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getNamespaceConfigDict",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/config_dict",e)).then(function(e){0===e.code?t.setState({configDictList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"getNamespaceSecretDict",value:function(){var e,t=this;(e={namespace:this.state.currentNamespace},R("/kubernetes/secret_dict",e)).then(function(e){0===e.code?t.setState({secretDictList:e.data.items}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"showDictValue",value:function(e){this.setState({configModalVisible:!0,dictConfigValue:e.data})}},{key:"deleteDictValue",value:function(e,t){var a=this;switch(e){case"config_map":(function(e){return V("/kubernetes/config_map",e)})({namespace:this.state.currentNamespace,resName:t.metadata.name}).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshNamespaceResources()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())});break;case"secret":(function(e){return V("/kubernetes/secret",e)})({namespace:this.state.currentNamespace,resName:t.metadata.name}).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.refreshNamespaceResources()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())});break;default:O.a.warn("\u4e0d\u652f\u6301\u7684\u7c7b\u578b")}}},{key:"handleConfigCancel",value:function(){this.setState({configModalVisible:!1})}},{key:"yarmCreateK8sResource",value:function(){this.setState({createModalVisible:!0})}},{key:"handleOk",value:function(){var e,t=this;""!==this.state.yamlCode.trim()?(e={namespace:this.state.currentNamespace,yamlContent:this.state.yamlCode},P("/kubernetes/yaml_resource",e)).then(function(e){0===e.code?(t.setState({createModalVisible:!1}),O.a.success("\u63d0\u4ea4\u6210\u529f\uff0c\u8bf7\u5230\u5bf9\u5e94\u8d44\u6e90\u680f\u67e5\u770b\u8be6\u60c5"),t.refreshNamespaceResources()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())}):O.a.warn("\u9700\u8981\u586b\u5199\u6587\u4ef6\u5185\u5bb9\uff01")}},{key:"handleCancel",value:function(){this.setState({createModalVisible:!1})}},{key:"selectTemplateChange",value:function(e){this.setState({yamlCode:vn[e]})}},{key:"showDetail",value:function(e,t){switch(this.setState({detailDrawerVisible:!0}),e){case"node":this.props.history.push({pathname:"/admin/k8s_cluster/manage/node_detail",state:{data:t}});break;case"rc":this.props.history.push({pathname:"/admin/k8s_cluster/manage/rc_detail",state:{data:t}});break;case"rs":this.props.history.push({pathname:"/admin/k8s_cluster/manage/rs_detail",state:{data:t}});break;case"deployment":this.props.history.push({pathname:"/admin/k8s_cluster/manage/deployment_detail",state:{data:t}});break;case"service":this.props.history.push({pathname:"/admin/k8s_cluster/manage/service_detail",state:{data:t}});break;case"pod":this.props.history.push({pathname:"/admin/k8s_cluster/manage/pod_detail",state:{data:t}});break;default:O.a.error("\u4e0d\u652f\u6301\u7684\u7c7b\u578b\uff1a"+e)}}},{key:"onDrawerClose",value:function(){this.setState({detailDrawerVisible:!1})}},{key:"autoScaleHandler",value:function(e,t){this.setState({scaleModalVisible:!0,scaleResType:e,scaleResData:t})}},{key:"deleteHandler",value:function(e,t){var a=this;nr({title:"\u64cd\u4f5c\u8b66\u544a?",content:"\u786e\u5b9a\u5220\u9664\u8be5 kubenetes \u8d44\u6e90\u5417\uff1f",icon:l.a.createElement(I.a,{type:"warning"}),onOk:function(){(function(e){return V("/kubernetes/resource",e)})({namespace:t.metadata.namespace,resType:e,resName:t.metadata.name}).then(function(e){0===e.code?(O.a.success("\u5220\u9664\u6210\u529f"),a.showLoading()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})},onCancel:function(){console.log("Cancel")}})}},{key:"showYamlHandler",value:function(e,t){var a,n=this;this.setState({yamlModalVisible:!0}),(a={namespace:t.metadata.namespace,resType:e,resName:t.metadata.name},R("/kubernetes/yaml",a)).then(function(e){0===e.code?n.setState({yamlDetail:e.data}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"handleYamlDetailCancel",value:function(){this.setState({yamlModalVisible:!1})}},{key:"handleScaleCancel",value:function(){this.setState({scaleModalVisible:!1})}},{key:"handleScaleCommit",value:function(){var e,t=this;(e={namespace:this.state.scaleResData.metadata.namespace,resType:this.state.scaleResType,resName:this.state.scaleResData.metadata.name,replicaCount:this.state.replicaCount},z("/kubernetes/scale",e)).then(function(e){if(0===e.code)switch(t.setState({scaleModalVisible:!1}),O.a.success("\u63d0\u4ea4\u6210\u529f"),t.showLoading(),t.state.scaleResType){case"rc":t.getNamespaceReplicationControllers()}else O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"onInputNumberChange",value:function(e){this.setState({replicaCount:e})}},{key:"render",value:function(){var e=this,t="\u65b0\u5efa\u8d44\u6e90 - "+this.state.currentNamespace,a=l.a.createElement("div",null,"\u586b\u5165 YAML \u6587\u4ef6\u5185\u5bb9\uff0c\u5c06\u6307\u5b9a\u8d44\u6e90\u90e8\u7f72\u5230\u5f53\u524d\u6240\u9009\u547d\u540d\u7a7a\u95f4\u3002",l.a.createElement(pe.a,{title:l.a.createElement("div",null,"\u66f4\u591a\u914d\u7f6e\u4fe1\u606f\u8bf7\u67e5\u770b: ",l.a.createElement("a",{href:"https://kubernetes.io/docs/home/",target:"_blank"},"\u5b98\u65b9\u6587\u6863"))},l.a.createElement(I.a,{type:"question-circle"}))),n=[];for(var r in this.state.dictConfigValue)n.push(l.a.createElement(ar,{header:r,key:r,style:rr},l.a.createElement(En.Controlled,{value:this.state.dictConfigValue[r]})));return l.a.createElement(er,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["Kubernetes","\u96c6\u7fa4\u7ba1\u7406"]}),l.a.createElement(ee.a,null,l.a.createElement("span",{style:{lineHeight:"30px",fontWeight:"500",marginRight:"20px"}},"\u547d\u540d\u7a7a\u95f4: "),l.a.createElement(ye.a,{defaultValue:"default",style:{width:"200px",marginRight:"20px"},onChange:this.selectChange},this.state.namespaceList.map(function(e,t){var a=!1;return"Active"!==e.status.phase&&(a=!0),l.a.createElement(tr,{key:t,value:e.metadata.name,disabled:a},e.metadata.name)})),l.a.createElement(Z.a,{onClick:this.refreshNamespaceResources,style:{marginRight:"20px"}},"\u5237 \u65b0"),l.a.createElement(Z.a,{type:"primary",onClick:this.yarmCreateK8sResource},"\u65b0 \u5efa")),l.a.createElement(E.a,{title:t,destroyOnClose:!0,visible:this.state.createModalVisible,onOk:this.handleOk,onCancel:this.handleCancel,width:700,centered:!0},l.a.createElement(X.a,{message:a,banner:!0,style:{marginBottom:"10px",marginTop:"-20px"}}),l.a.createElement(ee.a,{style:{marginBottom:"10px"}},l.a.createElement(te.a,{span:4},l.a.createElement("span",{style:{lineHeight:"30px",fontWeight:"500"}},"\u9009\u62e9\u8d44\u6e90\u6a21\u677f: ")),l.a.createElement(te.a,{span:6,style:{marginRight:"20px"}},l.a.createElement(ye.a,{defaultValue:"",style:{width:"100%"},onChange:this.selectTemplateChange},l.a.createElement(tr,{key:"0",value:""},"\u65e0"),l.a.createElement(tr,{key:"1",value:"deployment"},"\u90e8 \u7f72"),l.a.createElement(tr,{key:"2",value:"rc"},"\u526f\u672c\u63a7\u5236\u5668"),l.a.createElement(tr,{key:"3",value:"rs"},"\u526f\u672c\u96c6"),l.a.createElement(tr,{key:"4",value:"statefull_rs"},"\u6709\u72b6\u6001\u526f\u672c\u96c6"),l.a.createElement(tr,{key:"5",value:"service"},"\u670d \u52a1"),l.a.createElement(tr,{key:"6",value:"daemon_set"},"\u5b88\u62a4\u8fdb\u7a0b\u96c6"),l.a.createElement(tr,{key:"7",value:"config_map"},"\u914d\u7f6e\u5b57\u5178"),l.a.createElement(tr,{key:"8",value:"secret_map"},"\u4fdd\u5bc6\u5b57\u5178")))),l.a.createElement(En.Controlled,{value:this.state.yamlCode,options:{mode:"xml",theme:"material"},onBeforeChange:function(t,a,n){e.setState({yamlCode:n})}})),l.a.createElement(E.a,{title:"YAML\u8be6\u60c5",destroyOnClose:!0,visible:this.state.yamlModalVisible,onCancel:this.handleYamlDetailCancel,width:700,centered:!0,footer:[l.a.createElement(Z.a,{onClick:this.handleYamlDetailCancel},"\u53d6\u6d88")]},l.a.createElement(En.Controlled,{value:this.state.yamlDetail,options:{mode:"xml",theme:"material"},onBeforeChange:function(t,a,n){e.setState({yamlDetail:n})}})),l.a.createElement(E.a,{title:"\u81ea\u52a8\u4f38\u7f29",destroyOnClose:!0,visible:this.state.scaleModalVisible,onCancel:this.handleScaleCancel,width:400,centered:!0,bodyStyle:{textAlign:"center"},footer:[l.a.createElement(Z.a,{onClick:this.handleScaleCancel},"\u53d6\u6d88"),l.a.createElement(Z.a,{type:"primary",onClick:this.handleScaleCommit},"\u786e\u5b9a")]},l.a.createElement(be.a,{min:0,defaultValue:this.state.scaleResData.spec.replicas,onChange:this.onInputNumberChange,style:{width:"70%"}})),l.a.createElement(E.a,{title:"\u914d\u7f6e\u5b57\u5178\u503c",destroyOnClose:!0,visible:this.state.configModalVisible,onCancel:this.handleConfigCancel,width:600,footer:[]},l.a.createElement(bn.a,{bordered:!1},n)),l.a.createElement(se.a,{placement:"left",closable:!0,destroyOnClose:!0,onClose:this.onDrawerClose,visible:this.state.detailDrawerVisible,width:"70%"},l.a.createElement(p.a,null,l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/node_detail",component:Jn}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/rc_detail",component:kn}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/rs_detail",component:Gn}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/deployment_detail",component:Wn}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/service_detail",component:In}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/pod_detail",component:Mn}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/container_log",component:Vn}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage/container_terminal",component:Pn}))),l.a.createElement(ee.a,{style:{marginTop:"10px"}},l.a.createElement(Nt.a,{size:"small",title:"\u8d44\u6e90\u603b\u89c8",style:{width:"100%"}},l.a.createElement(ce.a,{spinning:this.state.refreshDataLoading},l.a.createElement(ve.a,{defaultActiveKey:"1",tabPosition:"left",style:{width:"100%"},tabBarStyle:{textAlign:"left"}},l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u8282\u70b9"),key:1},l.a.createElement(ie.a,{size:"small",columns:this.state.nodeColumns,dataSource:this.state.nodeList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u526f\u672c\u96c6"),key:2},l.a.createElement(ie.a,{size:"small",columns:this.state.rsColumns,dataSource:this.state.replicaSetList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u90e8\u7f72"),key:3},l.a.createElement(ie.a,{size:"small",columns:this.state.deploymentColumns,dataSource:this.state.deploymentList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u526f\u672c\u63a7\u5236\u5668"),key:4},l.a.createElement(ie.a,{size:"small",columns:this.state.rcColumns,dataSource:this.state.replicationControllerList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u670d\u52a1"),key:5},l.a.createElement(ie.a,{size:"small",columns:this.state.serviceColumns,dataSource:this.state.serviceList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u5bb9\u5668\u7ec4"),key:6},l.a.createElement(ie.a,{size:"small",columns:this.state.podColumns,dataSource:this.state.podList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u914d\u7f6e\u5b57\u5178"),key:7},l.a.createElement(ie.a,{size:"small",columns:this.state.configDictColumns,dataSource:this.state.configDictList,scroll:{x:"max-content"}})),l.a.createElement($n,{tab:l.a.createElement("div",{style:{fontSize:"13px",width:"80px",textAlign:"left"}},"\u4fdd\u5bc6\u5b57\u5178"),key:8},l.a.createElement(ie.a,{size:"small",columns:this.state.secretDictColumns,dataSource:this.state.secretDictList,scroll:{x:"max-content"}})))))))}}]),t}(r.Component),ir=(a(1397),a(648)),sr=(a(190),a(165)),or=g.a.Content,cr="",ur=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).addCluster=a.addCluster.bind(Object(b.a)(a)),a.handleClusterAddOk=a.handleClusterAddOk.bind(Object(b.a)(a)),a.handleClusterAddCancel=a.handleClusterAddCancel.bind(Object(b.a)(a)),a.handleSetPrometheusAddOk=a.handleSetPrometheusAddOk.bind(Object(b.a)(a)),a.handleSetPrometheusAddCancel=a.handleSetPrometheusAddCancel.bind(Object(b.a)(a)),a.loadClusterData=a.loadClusterData.bind(Object(b.a)(a)),a.state={addModelVisible:!1,setPrometheusModelVisible:!1,uploadProps:{action:M+"kubernetes/upload_cluster_kubeconfig",headers:{Authorization:N()},onChange:function(e){if("done"===e.file.status){var t=e.file.response;0===t.code?(cr=t.data,O.a.success("\u4e0a\u4f20\u6210\u529f")):O.a.error("\u4e0a\u4f20\u5931\u8d25: ",t.msg)}else"error"===e.file.status&&O.a.error("".concat(e.file.name," file upload failed."))}},clusterData:[],prometheusHost:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadClusterData()}},{key:"enterToCluster",value:function(e){var t=this;O.a.loading("\u96c6\u7fa4\u8fde\u63a5\u521d\u59cb\u5316\u4e2d\uff0c\u5373\u5c06\u8df3\u8f6c...",.6),localStorage.setItem("clusterId",e),setTimeout(function(){t.props.history.push({pathname:"/admin/k8s_cluster/manage"})},600)}},{key:"loadClusterData",value:function(){var e,t=this;R("/kubernetes/cluster",e).then(function(e){0===e.code?t.setState({clusterData:e.data.k8sData}):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"addCluster",value:function(){this.setState({addModelVisible:!0})}},{key:"setPrometheus",value:function(){this.setState({setPrometheusModelVisible:!0})}},{key:"handleClusterAddOk",value:function(){var e=this;""!==cr?this.props.form.validateFields(function(t,a){if(!t){var n=Object(fe.a)({},a,{kubeconfig_file_path:cr});(r=n,P("/kubernetes/cluster",r)).then(function(t){0===t.code?(O.a.success("\u6dfb\u52a0\u6210\u529f"),cr="",e.setState({addModelVisible:!1}),e.loadClusterData()):O.a.error(t.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}var r}):O.a.warn("kubeconfig\u6587\u4ef6\u5fc5\u987b\u8981\u4e0a\u4f20!")}},{key:"handleClusterAddCancel",value:function(){this.setState({addModelVisible:!1})}},{key:"handleSetPrometheusAddOk",value:function(){var e,t=this;if(""===this.state.prometheusHost.trim())O.a.warn("prometheus\u8bbf\u95ee\u5730\u5740\u5fc5\u987b\u586b\u5199");else{var a={host:"http://"+this.state.prometheusHost.trim()};(e=a,P("/kubernetes/metrics/prometheus",e)).then(function(e){0===e.code?(O.a.success("\u8bbe\u7f6e\u6210\u529f"),t.setState({setPrometheusModelVisible:!1})):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}}},{key:"handleSetPrometheusAddCancel",value:function(){this.setState({setPrometheusModelVisible:!1})}},{key:"hostChange",value:function(e){this.setState({prometheusHost:e.target.value})}},{key:"confirmDeleteCluster",value:function(e){var t,a=this;(t={id:e},V("/kubernetes/cluster",t)).then(function(e){0===e.code?(O.a.success("\u79fb\u9664\u6210\u529f"),a.loadClusterData()):O.a.error(e.msg)}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a={labelCol:{span:7},wrapperCol:{span:14}};return l.a.createElement(or,{style:{background:"#fff",padding:"5px 20px",margin:0,height:"100%"}},l.a.createElement(Ce,{pathData:["Kubernetes","\u96c6\u7fa4\u4fe1\u606f"]}),l.a.createElement(ee.a,null,l.a.createElement(te.a,{span:2},l.a.createElement(Z.a,{type:"primary",onClick:this.addCluster,style:{width:"100%"}},"\u65b0\u589e\u96c6\u7fa4")),l.a.createElement(te.a,{span:4,offset:1},l.a.createElement(Z.a,{onClick:this.setPrometheus.bind(this),style:{width:"100%"}},"\u8bbe\u7f6ePrometheus"))),l.a.createElement(ee.a,{style:{marginTop:"10px"}},0===this.state.clusterData.length?l.a.createElement(sr.a,{description:"\u6682\u672a\u6dfb\u52a0\u4efb\u4f55kubernetes\u96c6\u7fa4"}):l.a.createElement(dn.a,{grid:{gutter:16,column:4},dataSource:this.state.clusterData,renderItem:function(t){return l.a.createElement(dn.a.Item,null,l.a.createElement(Nt.a,{title:t.name,size:"small"},l.a.createElement("div",{style:{height:"50px",fontSize:"13px"}},t.description),l.a.createElement("div",{style:{marginTop:"10px"}},l.a.createElement(Z.a,{type:"link",size:"small",style:{float:"left"},onClick:e.enterToCluster.bind(e,t.clusterId)},"\u8fdb\u5165\u96c6\u7fa4"),l.a.createElement(de.a,{title:"\u786e\u5b9a\u79fb\u9664\u8be5\u96c6\u7fa4\u5417?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onConfirm:e.confirmDeleteCluster.bind(e,t.id)},l.a.createElement(Z.a,{type:"link",size:"small",style:{color:"red",float:"right"}},"\u5220\u9664\u96c6\u7fa4")))))}})),l.a.createElement(E.a,{title:"\u65b0\u589e\u96c6\u7fa4\u4fe1\u606f",destroyOnClose:!0,visible:this.state.addModelVisible,onOk:this.handleClusterAddOk,onCancel:this.handleClusterAddCancel},l.a.createElement(S.a,null,l.a.createElement(S.a.Item,Object.assign({label:"\u96c6\u7fa4\u540d\u79f0"},a),t("name",{rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b\u9879"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"\u96c6\u7fa4\u63cf\u8ff0"},a),t("description",{rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b\u9879"}]})(l.a.createElement(x.a,null))),l.a.createElement(S.a.Item,Object.assign({label:"KubeConfig\u6587\u4ef6"},a),t("kubeconfig_file_path",{rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b\u9879"}]})(l.a.createElement(ir.a,this.state.uploadProps,l.a.createElement(Z.a,null,l.a.createElement(I.a,{type:"upload"})," \u70b9\u51fb\u4e0a\u4f20")))))),l.a.createElement(E.a,{title:"\u8bbe\u7f6ePrometheus\u8bbf\u95ee\u5730\u5740",destroyOnClose:!0,visible:this.state.setPrometheusModelVisible,onOk:this.handleSetPrometheusAddOk,onCancel:this.handleSetPrometheusAddCancel},l.a.createElement(x.a,{addonBefore:"http://",defaultValue:this.state.prometheusHost,onChange:this.hostChange.bind(this)})))}}]),t}(r.Component),dr=ur=S.a.create({name:"ClusterManageContent"})(ur),mr=g.a.Content,hr=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement(mr,{style:{background:"#fff",padding:0,margin:0,height:"100%"}},l.a.createElement(p.a,null,l.a.createElement(f.a,{path:"/admin/k8s_cluster/info",component:dr}),l.a.createElement(f.a,{path:"/admin/k8s_cluster/manage",component:lr})))}}]),t}(r.Component),pr=g.a.Content,fr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isSuperAdmin:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this;R("user/tokenRefresh").then(function(t){if(0===t.code){localStorage.setItem("ops_token",t.data.token);var a=ea()(t.data.token);e.setState({isSuperAdmin:a.userInfo.isSuperAdmin})}}).catch(function(e){O.a.error(e.toLocaleString())})}},{key:"render",value:function(){var e=this;return l.a.createElement(pr,{style:{height:"100%",minWidth:"900px",overflow:"scroll"}},l.a.createElement(p.a,null,l.a.createElement(f.a,{exact:!0,path:"/admin",component:le}),l.a.createElement(f.a,{path:"/admin/cloud_resource/cloud_server",render:function(){return l.a.createElement(st,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/cloud_resource/cloud_rds",render:function(){return l.a.createElement(pt,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/cloud_resource/cloud_kv",render:function(){return l.a.createElement(St,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/cloud_resource/cloud_slb",render:function(){return l.a.createElement(xt,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/cloud_resource/cloud_account",render:function(){return l.a.createElement(Lt,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/cloud_resource/cloud_other",render:function(){return l.a.createElement(Wa,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/task",render:function(){return l.a.createElement(ca,{isSuperAdmin:e.state.isSuperAdmin})}}),l.a.createElement(f.a,{path:"/admin/cicd",render:function(){return l.a.createElement(gn,null)}}),l.a.createElement(f.a,{path:"/admin/k8s_cluster",render:function(){return l.a.createElement(hr,null)}}),l.a.createElement(f.a,{path:"/admin/data/syncAliyun",component:qa}),l.a.createElement(f.a,{path:"/admin/permission/users",component:fa}),l.a.createElement(f.a,{path:"/admin/permission/roles",component:_a}),l.a.createElement(f.a,{path:"/admin/permission/permissions",component:Ra}),l.a.createElement(f.a,{path:"/admin/permission/password",component:Va}),l.a.createElement(f.a,{path:"/admin/system/setting",component:tn}),l.a.createElement(f.a,{path:"/admin/system/user_feedback",component:on}),l.a.createElement(f.a,{path:"/admin/logout",component:an})))}}]),t}(r.Component),gr=a(647),br=(a(1385),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onExit=function(){a.setState(function(){return{stepsEnabled:!1}})},a.handleSiderMenu=a.handleSiderMenu.bind(Object(b.a)(a)),a.state={collapsed:!1,stepsEnabled:!1,initialStep:0,options:{prevLabel:"\u4e0a\u4e00\u6b65",nextLabel:"\u4e0b\u4e00\u6b65",skipLabel:"\u8df3\u8fc7",doneLabel:"\u7ed3\u675f",hintButtonLabel:"\u5f00\u59cb\u4f7f\u7528"},steps:[{element:".introStep2",intro:"\u7528\u6237\u53ef\u4ee5\u70b9\u51fb\u8fd9\u91cc\u8fdb\u884cbug&\u9700\u6c42\u7684\u53cd\u9988\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u5728\u7cfb\u7edf\u7ba1\u7406->\u7528\u6237\u53cd\u9988\u4e2d\u8fdb\u884c\u67e5\u770b\uff01"},{element:".introStep4",intro:"\u5728\u8fd9\u91cc\u8fdb\u5165\u5404\u7ec6\u5206\u529f\u80fd\u5217\u8868\uff0c\u5b8c\u6210\u76f8\u5e94\u7684\u64cd\u4f5c\uff1b\u7ba1\u7406\u5458\u53ef\u4ee5\u5728\u6743\u9650\u7ba1\u7406\u4e2d\u63a7\u5236\u7528\u6237\u8bbf\u95ee\u83dc\u5355\u7684\u6743\u9650\uff01"}]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){1===function(){var e=localStorage.getItem("ops_token");if(void 0!==e&&null!==e&&""!==e)return ea()(e).userInfo.show_intro;window.location.href="/login"}()&&this.setState({stepsEnabled:!0})}},{key:"handleSiderMenu",value:function(){this.setState({collapsed:!this.state.collapsed})}},{key:"render",value:function(){var e=this.state,t=e.stepsEnabled,a=e.steps,n=e.initialStep,r=e.options;return l.a.createElement(h.a,null,l.a.createElement(g.a,{style:{minHeight:"100vh"}},l.a.createElement(gr.Steps,{enabled:t,steps:a,initialStep:n,onExit:this.onExit,options:r}),l.a.createElement(G,{menuCollapsed:this.state.collapsed}),l.a.createElement(g.a,null,l.a.createElement(H,{menuCollapsed:this.state.collapsed,handleSiderMenu:this.handleSiderMenu}),l.a.createElement(f.a,{path:"/admin",component:fr}),l.a.createElement(W,null))))}}]),t}(r.Component)),yr=Object(y.a)(br),Er=(a(1387),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleEnterKey=function(e){13===e.nativeEvent.keyCode&&a.handleSubmit()},a.handleSubmit=a.handleSubmit.bind(Object(b.a)(a)),a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=new URLSearchParams(this.props.location.search).get("code");void 0!==e&&null!==e&&(401===(e=parseInt(e))&&O.a.error("token\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55!",4),403===e&&O.a.error("\u7528\u6237\u4e0d\u5b58\u5728\u6216\u88ab\u7981\u7528\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458!",4))}},{key:"handleSubmit",value:function(e){var t=this;this.props.form.validateFields(function(e,a){var n;e||(n=a,P("user/login",n)).then(function(e){0===e.code?(localStorage.setItem("ops_token",e.data.token),O.a.success("\u6b22\u8fce\u4f7f\u7528\u8fd0\u7ef4\u5e73\u53f0\uff01"),t.props.history.push("/admin")):(t.props.form.setFields({password:{value:"",errors:[new Error(e.msg)]}}),O.a.error(e.msg))}).catch(function(e){O.a.error(e.toLocaleString())})})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=l.a.createElement("div",null,l.a.createElement(S.a,{onSubmit:this.handleSubmit,className:"login-form"},l.a.createElement(S.a.Item,null,e("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u60a8\u7684\u6ce8\u518c\u90ae\u7bb1!"}]})(l.a.createElement(x.a,{size:"large",prefix:l.a.createElement(I.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u8d26\u53f7",onKeyPress:this.handleEnterKey}))),l.a.createElement(S.a.Item,null,e("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u60a8\u7684\u5bc6\u7801!"}]})(l.a.createElement(x.a,{size:"large",prefix:l.a.createElement(I.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u7528\u6237\u5bc6\u7801",onKeyPress:this.handleEnterKey}))),l.a.createElement(S.a.Item,null,l.a.createElement(Z.a,{type:"primary",block:!0,className:"login-form-button",size:"large",onClick:this.handleSubmit},"\u767b \u5f55"))));return l.a.createElement("div",null,l.a.createElement(ee.a,{style:{height:"25vh",paddingTop:"10vh"}},l.a.createElement(te.a,{span:9}),l.a.createElement(te.a,{span:6,style:{padding:"0px 30px"}},l.a.createElement("span",{className:"login-logo"}),l.a.createElement("span",{className:"login-logo-text"},"\u8fd0\u7ef4\u5e73\u53f0")),l.a.createElement(te.a,{span:9})),l.a.createElement(ee.a,{style:{height:"30vh"}},l.a.createElement(te.a,{span:9}),l.a.createElement(te.a,{span:6,style:{textAlign:"center"}},t),l.a.createElement(te.a,{span:9})),l.a.createElement(ee.a,{style:{height:"30vh"}}),l.a.createElement(ee.a,{style:{height:"15vh",textAlign:"center",paddingTop:50}},"\xa92019 Created by KevinYang"))}}]),t}(r.Component)),vr=Er=S.a.create({name:"normalogin"})(Er),Sr=(a(1389),a(333)),kr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).backToLogin=a.backToLogin.bind(Object(b.a)(a)),a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"backToLogin",value:function(){this.props.history.push("/admin")}},{key:"render",value:function(){return l.a.createElement(Sr.a,{status:"500",title:"\u5f02\u5e38\u63d0\u9192",subTitle:"\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u4e2d\u5fc3\u5904\u7406",style:{height:"100vh"},extra:l.a.createElement(Z.a,{type:"primary",onClick:this.backToLogin},"\u8fd4\u56de\u4e3b\u9875")})}}]),t}(r.Component),Cr=(r.Component,function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).backToLogin=a.backToLogin.bind(Object(b.a)(a)),a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"backToLogin",value:function(){this.props.history.push("/admin")}},{key:"render",value:function(){return l.a.createElement(Sr.a,{status:"404",title:"404",subTitle:"\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728",style:{height:"100vh"},extra:l.a.createElement(Z.a,{type:"primary",onClick:this.backToLogin},"\u8fd4\u56de\u4e3b\u9875")})}}]),t}(r.Component)),Ir=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{id:"router",style:{backgroundColor:"#f0f2f5"}},l.a.createElement(h.a,null,l.a.createElement(p.a,null,l.a.createElement(f.a,{path:"/",component:vr,exact:!0}),l.a.createElement(f.a,{path:"/admin",component:yr}),l.a.createElement(f.a,{path:"/login",component:vr}),l.a.createElement(f.a,{component:Cr}),l.a.createElement(f.a,{path:"/exception500",component:kr}))))}}]),t}(r.Component),Dr=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"App"},l.a.createElement(Ir,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Or=a(649);s.a.render(l.a.createElement(n.c,{locale:Or.a},l.a.createElement(Dr,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},285:function(e,t,a){},652:function(e,t,a){e.exports=a(1392)}},[[652,2,1]]]);
//# sourceMappingURL=main.6bf12c33.chunk.js.map